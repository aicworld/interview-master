{"version":3,"sources":["../../src/auth/AuthLogin.tsx","../../src/inputs/TextInput.tsx","../../src/inputs/InputStateHandler.tsx","../../src/NotificationCount.tsx","../../src/inputs/InputLabel.tsx","../../theme/palette.ts","../../src/auth/AuthTemplate.tsx","../../src/auth/ProviderButton.tsx","../../src/auth/Auth0.tsx","../../src/auth/Cognito.tsx","../../src/auth/Descope.tsx","../../src/auth/Okta.tsx","../../src/auth/AuthForgotPassword.tsx","../../src/auth/AuthResetPassword.tsx","../../src/auth/AuthVerifyEmail.tsx","../../theme/theme.tsx","../../src/buttons/GreyButton.tsx","../../src/buttons/RegularButton.tsx","../../src/buttons/AccentButton.tsx","../../hooks/useColors.tsx","../../hooks/useIsDarkMode.tsx","../../hooks/useUpload.tsx","../../utils/omit.ts","../../src/inputs/SliderInput.tsx","../../src/inputs/SwitchInput.tsx","../../src/inputs/TagsInput.tsx","../../src/inputs/selects/SelectInput.tsx","../../src/inputs/selects/MenuItem.tsx","../../src/inputs/FormInput.tsx","../../src/inputs/selects/SelectCategoryInput.tsx","../../src/buttons/Toggle.tsx","../../src/elements/Audio.tsx","../../src/elements/Avatar.tsx","../../src/Attachment.tsx","../../src/elements/File.tsx","../../src/elements/Image.tsx","../../src/elements/Frame.tsx","../../src/elements/PDF.tsx","../../src/elements/Plotly.tsx","../../src/ErrorBoundary.tsx","../../hooks/useFetch.tsx","../../src/Markdown.tsx","../../src/Code.tsx","../../src/ClipboardCopy.tsx","../../contexts/MessageContext.tsx","../../src/messages/components/ElementRef.tsx","../../src/InlineCode.tsx","../../src/elements/Text.tsx","../../src/elements/Video.tsx","../../src/elements/Element.tsx","../../src/elements/ElementSideView.tsx","../../src/elements/ElementView.tsx","../../src/elements/InlinedAudioList.tsx","../../src/elements/InlinedElements.tsx","../../src/elements/InlinedFileList.tsx","../../src/elements/ListWithSize.tsx","../../src/elements/InlinedImageList.tsx","../../src/elements/InlinedPDFList.tsx","../../src/elements/InlinedPlotlyList.tsx","../../src/elements/InlinedTextList.tsx","../../src/elements/InlinedVideoList.tsx","../../src/messages/MessageContainer.tsx","../../src/messages/Messages.tsx","../../src/messages/Message.tsx","../../src/messages/components/AskUploadButton.tsx","../../src/messages/components/Author.tsx","../../src/messages/components/MessageTime.tsx","../../src/messages/components/DetailsButton.tsx","../../src/messages/components/MessageActions.tsx","../../src/messages/components/ActionButton.tsx","../../src/messages/components/ActionDrawerButton.tsx","../../src/messages/components/MessageButtons.tsx","../../src/messages/components/FeedbackButtons.tsx","../../src/Dialog.tsx","../../src/messages/components/PlaygroundButton.tsx","../../src/messages/components/MessageContent.tsx","../../src/Collapse.tsx","../../utils/message.ts","../../contexts/PlaygroundContext.tsx","../../src/playground/index.tsx","../../src/playground/actionBar.tsx","../../src/playground/basic.tsx","../../src/playground/editor/completion.tsx","../../../../node_modules/.pnpm/immutable@4.3.5/node_modules/immutable/dist/immutable.es.js","../../src/playground/editor/EditorWrapper.tsx","../../src/playground/editor/MessageWrapper.tsx","../../src/playground/editor/formatted.tsx","../../src/playground/helpers/format.ts","../../src/playground/chat.tsx","../../src/playground/editor/promptMessage.tsx","../../src/playground/editor/functionModal.tsx","../../src/playground/editor/variableModal.tsx","../../src/playground/header.tsx","../../src/playground/functionInput.tsx","../../src/playground/modeToggle.tsx","../../src/playground/variableInput.tsx","../../src/playground/modelSettings.tsx","../../src/playground/helpers/provider.ts","../../src/playground/submitButton.tsx"],"names":["useFormik","useEffect","useState","PasswordChecklist","TextField","FormControl","FormHelperText","Stack","Box","Typography","useTheme","jsx","NotificationCount","count","inputProps","theme","getInputWidth","hasArrow","countString","contentWidth","Info","MInputLabel","Tooltip","jsxs","InputLabel","id","label","tooltip","notificationsProps","InputStateHandler","props","children","description","hasError","sx","TextInput","disabled","size","multiline","endAdornment","rest","white","grey","primary","green","yellow","useToggle","yup","Visibility","VisibilityOff","Alert","Button","IconButton","InputAdornment","Link","AuthTemplate","title","renderLogo","GitHub","Google","Microsoft","Auth0","Cognito","Descope","Okta","capitalizeFirstLetter","string","getProviderName","provider","renderProviderIcon","ProviderButton","onClick","isSignIn","Fragment","signinErrors","getErrorMessage","errorType","AuthLogin","error","providers","callbackUrl","onPasswordSignIn","onOAuthSignIn","onForgotPassword","onSignUp","passwordChecklistSettings","loading","setLoading","isPasswordValid","setIsPasswordValid","showSignIn","toggleShowSignIn","showPassword","toggleShowPassword","errorState","setErrorState","oAuthReady","formik","email","password","err","e","index","MailOutline","AuthForgotPassword","onGoBack","onContinue","setError","showConfirmation","setShowConfirmation","AuthResetPassword","onResetPassword","token","newPassword","AuthVerifyEmail","onResend","success","setSuccess","createTheme","typography","components","shape","darkTheme","fontFamily","breakpoints","lightTheme","makeTheme","variant","darkGreyButtonTheme","lightGreyButtonTheme","ThemeProvider","GreyButton","greyTheme","RegularButton","AccentButton","useCallback","useIsDarkMode","darkColors","lightColors","hashCode","str","currentVal","useColors","inverted","colors","useColorForName","uiName","name","isUser","isError","useDropzone","useUpload","onError","onResolved","options","spec","onDrop","acceptedFiles","fileRejections","dzAccept","accept","a","getRootProps","getInputProps","isDragActive","omit","object","result","prop","omit_default","Slider","styled","SliderInput","setField","sliderProps","onChange","event","parsedValue","min","max","StyledSlider","isLightMode","MSwitch","SwitchInput","checked","StyledSwitchInput","isDarkMode","MuiChipsInput","TagsInput","value","KeyboardArrowDown","MSelect","MMenuItem","createElement","MenuItem","item","selected","icon","SelectInput","items","placeholder","renderLabel","onClose","iconSx","FormInput","element","ListSubheader","SelectCategoryInput","renderCategoryItem","categoryItem","header","foundItem","el","Tab","Tabs","Toggle","newValue","AudioElement","Avatar","AvatarElement","author","bgColor","avatar","FileIcon","defaultStyles","Attachment","mime","extension","FileElement","Skeleton","FrameElement","handleImageClick","src","link","ImageElement","PDFElement","url","Suspense","lazy","Component","ErrorBoundary","errorInfo","msg","useSWR","fetcher","response","contentType","useFetch","endpoint","Plot","_PlotlyElement","data","isLoading","state","PlotlyElement","useMemo","ReactMarkdown","rehypeKatex","rehypeRaw","remarkGfm","remarkMath","hljs","useRef","useCopyToClipboard","ContentPaste","ClipboardCopy","edge","isCopied","setIsCopied","_","copy","CodeSnippet","language","codeRef","Code","codeChildren","className","match","code","showSyntaxHighlighter","highlightedCode","nonHighlightedCode","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","createContext","defaultMessageContext","MessageContext","useContext","ElementRef","onElementRefClick","InlineCode","Markdown","refElements","allowHtml","latex","rehypePlugins","remarkPlugins","TextElement","content","VideoElement","Element","forwardRef","Resizable","useWindowSize","Close","MDrawer","useMediaQuery","DRAWER_DEFAULT_WIDTH","Handle","ref","ElementSideView","isOpen","resizeInProgress","setResizeInProgress","drawerWidth","setDrawerWidth","handleResize","_event","width","isSmallScreen","MainDrawer","Drawer","open","ArrowBack","ElementView","InlinedAudioList","audio","i","InlinedFileList","file","ImageList","ImageListItem","sizeToUnit","ListWithSize","elements","Renderer","cols","rows","InlinedImageList","ctx","InlinedPDFList","pdf","InlinedPlotlyList","AlertTitle","InlinedTextList","InlinedVideoList","InlinedElements","elementsByType","acc","memo","keyframes","CircularProgress","AskUploadChildButton","askUser","uploadFile","uploads","setUploads","uploading","upload","progress","files","promises","xhr","promise","prev","fileRefs","u","AskUploadButton","messageContext","MessageTime","timestamp","dateOptions","date","AUTHOR_BOX_WIDTH","Author","message","show","context","getColorForName","avatarEl","ExpandLess","ExpandMore","DetailsButton","opened","nestedCount","nested","lastStep","tool","showDefaultLoader","stepCount","m","text","ActionButton","action","margin","isAskingAction","isDisabled","handleClick","MoreVertIcon","Menu","ICON_SIZE","ActionDrawerButton","actions","anchorEl","setAnchorEl","MessageActions","scopedActions","displayedActions","drawerActions","MDialog","DialogActions","DialogContent","DialogTitle","Dialog","Dialog_default","StickyNote2Outlined","ThumbDownAlt","ThumbDownAltOutlined","ThumbUpAlt","ThumbUpAltOutlined","FeedbackButtons","onFeedbackUpdated","showFeedbackDialog","setShowFeedbackDialog","commentInput","setCommentInput","feedback","setFeedback","comment","setComment","DownIcon","UpIcon","handleFeedbackChanged","handleFeedbackClick","status","buttons","baseButtons","FeedbackButton","Terminal","PlaygroundButton","step","onPlaygroundButtonClick","MessageButtons","isDark","showFbButtons","showPlaygroundButton","isAsk","hasContent","showCopyButton","showFeedbackButtons","MCollapse","Collapse","defaultExpandAll","expandAll","toggleExpandAll","isForIdMatch","forId","escapeRegExp","prepareContent","elementNames","b","elementRegexp","preparedContent","inlinedElements","nameMatch","scopeMatch","foundElement","inlined","prefix","Divider","COLLAPSE_MIN_LINES","COLLAPSE_MIN_LENGTH","MessageContent","preserveSize","lineCount","contentLength","output","outputInlinedElements","outputRefElements","outputMarkdown","inputMarkdown","input","inputRefElements","markdownContent","messageContent","Message","indent","showAvatar","showBorder","isRunning","isLast","hideCot","highlightedMessage","defaultCollapseContent","showDetails","setShowDetails","flash","Messages","messages","isRoot","previousAuthor","filtered","hasInlinedElement","hasChildren","messageRunning","MessageContainer","autoScroll","setAutoScroll","handleScroll","scrollTop","scrollHeight","clientHeight","atBottom","defaultPlaygroundContext","PlaygroundContext","RestoreIcon","Chip","ActionBar","Editor","EditorState","Modifier","SelectionState","DELETE","SHIFT","SIZE","MASK","NOT_SET","MakeRef","SetRef","OwnerID","ensureSize","iter","returnTrue","wrapIndex","uint32Index","wholeSlice","begin","end","isNeg","resolveBegin","resolveIndex","resolveEnd","defaultIndex","IS_COLLECTION_SYMBOL","isCollection","maybeCollection","IS_KEYED_SYMBOL","isKeyed","maybeKeyed","IS_INDEXED_SYMBOL","isIndexed","maybeIndexed","isAssociative","maybeAssociative","Collection","Seq","KeyedCollection","KeyedSeq","IndexedCollection","IndexedSeq","SetCollection","SetSeq","IS_SEQ_SYMBOL","isSeq","maybeSeq","IS_RECORD_SYMBOL","isRecord","maybeRecord","isImmutable","maybeImmutable","IS_ORDERED_SYMBOL","isOrdered","maybeOrdered","ITERATE_KEYS","ITERATE_VALUES","ITERATE_ENTRIES","REAL_ITERATOR_SYMBOL","FAUX_ITERATOR_SYMBOL","ITERATOR_SYMBOL","Iterator","next","iteratorValue","type","k","v","iteratorResult","iteratorDone","hasIterator","maybeIterable","getIteratorFn","isIterator","maybeIterator","getIterator","iterable","iteratorFn","isEntriesIterable","isKeysIterable","hasOwnProperty","isArrayLike","emptySequence","seqFromValue","fn","reverse","cache","entry","keyedSeqFromValue","indexedSeqFromValue","ArraySeq","array","notSetValue","ii","ObjectSeq","keys","key","CollectionSeq","collection","iterator","iterations","EMPTY_SEQ","seq","maybeIndexedSeqFromValue","IS_MAP_SYMBOL","isMap","maybeMap","isOrderedMap","maybeOrderedMap","isValueObject","maybeValue","is","valueA","valueB","imul","c","d","smi","i32","defaultValueOf","hash","o","hashNullish","valueOf","hashNumber","STRING_HASH_CACHE_MIN_STRLEN","cachedHashString","hashString","hashJSObj","hashSymbol","nullish","n","hashed","stringHashCache","STRING_HASH_CACHE_SIZE","STRING_HASH_CACHE_MAX_SIZE","sym","symbolMap","nextHash","obj","usingWeakMap","weakMap","UID_HASH_KEY","canDefineProperty","getIENodeHash","isExtensible","node","_objHashUID","ToKeyedSequence","indexed","useKeys","this$1$1","reversedSequence","reverseFactory","mapper","mappedSequence","mapFactory","ToIndexedSequence","ToSetSequence","FromEntriesSequence","entries","validateEntry","indexedCollection","cacheResultThrough","flipFactory","flipSequence","makeSequence","filterFactory","predicate","filterSequence","countByFactory","grouper","groups","Map","groupByFactory","isKeyedIter","OrderedMap","coerce","collectionClass","arr","reify","partitionFactory","sliceFactory","originalSize","resolvedBegin","resolvedEnd","resolvedSize","sliceSize","sliceSeq","skipped","isSkipping","takeWhileFactory","takeSequence","iterating","skipWhileFactory","skipSequence","skipping","concatFactory","values","isKeyedCollection","iters","singleton","concatSeq","sum","flattenFactory","depth","flatSequence","stopped","flatDeep","currentDepth","stack","flatMapFactory","interposeFactory","separator","interposedSequence","sortFactory","comparator","defaultComparator","maxFactory","maxCompare","comp","zipWithFactory","keyIter","zipper","zipAll","zipSequence","sizes","iterators","isDone","steps","s","arrCopy","offset","len","newArr","invariant","condition","assertNotInfinite","coerceKeyPath","keyPath","toString","isPlainObject","proto","parentProto","nextProto","isDataStructure","quoteString","has","get","shallowCopy","from","to","remove","collectionCopy","set","updateIn$1","updater","updatedValue","updateInDeeply","inImmutable","existing","wasNotSet","existingValue","nextExisting","nextUpdated","emptyMap","setIn$1","setIn","removeIn","deleteIn","update$1","update","updateIn","merge$1","mergeIntoKeyedWith","mergeWith$1","merger","collections","collection$1","mergeIntoCollection","oldVal","mergeDeepWithSources","sources","mergeWithSources","deepMergerWith","isArray","merged","mergeItem","hasVal","nextVal","deepMerger","oldValue","areMergeable","oldDataStructure","newDataStructure","oldSeq","newSeq","mergeDeep","mergeDeepWith","mergeIn","mergeDeepIn","withMutations","mutable","asMutable","asImmutable","wasAltered","map","keyValues","updateMap","MapIterator","ownerID","makeMap","MapPrototype","ArrayMapNode","shift","keyHash","didChangeSize","didAlter","removed","idx","exists","MAX_ARRAY_MAP_SIZE","createNodes","isEditable","newEntries","BitmapIndexedNode","bitmap","nodes","bit","popCount","keyHashFrag","newNode","updateNode","MAX_BITMAP_INDEXED_SIZE","expandNodes","isLeafNode","newBitmap","newNodes","setAt","spliceOut","spliceIn","HashArrayMapNode","newCount","MIN_HASH_ARRAY_MAP_SIZE","packNodes","HashCollisionNode","mergeIntoNode","ValueNode","keyMatch","maxIndex","mapIteratorFrame","mapIteratorValue","subNode","root","EMPTY_MAP","newRoot","newSize","idx1","idx2","excluding","packedII","packedNodes","including","expandedNodes","x","val","canEdit","newArray","newLen","after","IS_LIST_SYMBOL","isList","maybeList","List","empty","emptyList","makeList","VNode","list","listNodeFor","updateList","oldSize","setListBounds","arguments$1","seqs","argument","iterateList","DONE","ListPrototype","level","originIndex","removingFirst","newChild","oldChild","editable","editableVNode","sizeIndex","left","right","tailPos","getTailOffset","tail","iterateNodeOrLeaf","iterateLeaf","iterateNode","origin","capacity","EMPTY_LIST","newTail","updateVNode","nodeHas","lowerNode","newLowerNode","rawIndex","owner","oldOrigin","oldCapacity","newOrigin","newCapacity","newLevel","offsetShift","oldTailOffset","newTailOffset","oldTail","beginIndex","emptyOrderedMap","updateOrderedMap","newMap","newList","makeOrderedMap","omap","EMPTY_ORDERED_MAP","IS_STACK_SYMBOL","isStack","maybeStack","emptyStack","head","makeStack","StackPrototype","EMPTY_STACK","IS_SET_SYMBOL","isSet","maybeSet","isOrderedSet","maybeOrderedSet","deepEqual","notAssociative","flipped","allEqual","bSize","mixin","ctor","methods","keyCopier","toJS","result$1","Set","emptySet","sets","SetPrototype","updateSet","didChanges","mapped","toRemove","OrderedSet","makeSet","EMPTY_SET","Range","start","EMPTY_RANGE","searchValue","possibleIndex","offsetValue","other","getIn$1","searchKeyPath","getIn","hasIn$1","hasIn","toObject","useTuples","returnValue","sideEffect","joined","isFirst","reducer","initialReduction","reduce","entriesSequence","entryMapper","not","found","searchKey","keyMapper","neg","defaultNegComparator","amount","hashCollection","CollectionPrototype","KeyedCollectionPrototype","removeNum","numArgs","spliced","zipped","interleaved","defaultZipper","IndexedCollectionPrototype","SetCollectionPrototype","reduction","useFirst","ordered","keyed","h","hashMerge","murmurHashOfSize","emptyOrderedSet","OrderedSetPrototype","makeOrderedSet","EMPTY_ORDERED_SET","throwOnInvalidDefaultValues","defaultValues","Record","hasInitialized","RecordType","indices","RecordTypePrototype","propName","recordName","setProp","l","RecordPrototype","recordSeq","newValues","makeRecord","likeRecord","record","prototype","merge","EditorWrapper","clipboardValue","sxChildren","ExpandLessIcon","ExpandMoreIcon","RemoveCircleOutlineOutlined","roles","MessageWrapper","canSelectRole","role","showSelectRole","setShowSelectRole","setPlayground","onRoleSelected","old","mIndex","onRemove","roleSelect","MessageWrapper_default","Completion","completion","chatMode","setState","isCompletionOpen","setCompletionOpen","_state","insertCompletion","contentState","blockMap","length","selection","ncs","es","renderEditor","nextState","ContentState","isEqual","buildTemplatePlaceholderRegexp","variable","format","escape","buildEscapeReplaceRegexp","buildVariablePlaceholder","validateVariablePlaceholder","variableName","prefixBracesCount","suffixBracesCount","ok","localStartIndex","localEndIndex","useIsFirstRender","useCustomStyleMap","customStyleMap","matchToEscapeOrReplace","regexp","matches","matchVariable","matchedVariable","formatTemplate","variables","contentBlock","ssmToEscapeOrReplace","escapeOffset","ssmToEscapeOrReplaceWithVariable","ssm","ss","variableFound","startIndex","endIndex","selectionToEscape","replaceOffset","currentSelection","selectionToHighlight","entityKey","getEntityAtSelection","editorState","selectionState","selectionKey","contentstate","block","entityInstance","FormattedEditor","template","formatted","inputs","readOnly","showTitle","sxEditorChildren","editorRef","setVariableName","setPromptMode","onNotification","prevInputs","setPrevInputs","variableNames","variableContent","sortedVariables","handleOnEditorChange","hasFocus","isCollapsed","entity","currentContent","nextContent","BasicPromptPlayground","generation","restoredTime","promptMode","onFormattedChange","AddCircleOutlined","PromptMessage","mode","templateProps","renderFormatted","ChatPromptPlayground","hasTemplate","chat_default","FunctionModal","playground","functionIndex","setFunctionIndex","hasIndex","functions","updateFunction","nextFn","functionModal_default","VariableModal","updateVariable","resetVariableName","variableModal_default","CloseIcon","TuneIcon","FunctionInput","functionInput_default","PromptModeToggle","toggle","VariableInput","variableInput_default","PlaygroundHeader","showToggleDrawerButton","toggleDrawer","handleClose","cloneDeep","getProviders","providerFound","ChevronRightIcon","SettingsForm","settings","schema","providerTooltip","providerWarning","debounceTimeout","onSelectedProviderChange","ModelSettings","buildProviderTooltip","currentSettings","origSettings","isSettingCompatible","settingValue","ResponsiveModelSettings","isDrawerOpen","SubmitButton","onSubmit","completionController","setCompletionController","createCompletion","submit","controller","done","_PromptPlayground","setRestoredTime","chatPromptScrollRef","restore","isChat","PromptPlayground"],"mappings":"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","sourcesContent":["import { useFormik } from 'formik';\r\nimport { useEffect, useState } from 'react';\r\nimport PasswordChecklist, { RuleNames } from 'react-password-checklist';\r\nimport { TextInput } from 'src/inputs/TextInput';\r\nimport { grey } from 'theme/palette';\r\nimport { useToggle } from 'usehooks-ts';\r\nimport * as yup from 'yup';\r\n\r\nimport Visibility from '@mui/icons-material/Visibility';\r\nimport VisibilityOff from '@mui/icons-material/VisibilityOff';\r\nimport Alert from '@mui/material/Alert';\r\nimport Box from '@mui/material/Box';\r\nimport Button from '@mui/material/Button';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport InputAdornment from '@mui/material/InputAdornment';\r\nimport Link from '@mui/material/Link';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport { AuthTemplate } from './AuthTemplate';\r\nimport { ProviderButton } from './ProviderButton';\r\n\r\nconst signinErrors: Record<string, string> = {\r\n  default: 'Unable to sign in.',\r\n  signin: 'Try signing in with a different account.',\r\n  oauthsignin: 'Try signing in with a different account.',\r\n  redirect_uri_mismatch:\r\n    'The redirect URI is not matching the oauth app configuration.',\r\n  oauthcallbackerror: 'Try signing in with a different account.',\r\n  oauthcreateaccount: 'Try signing in with a different account.',\r\n  emailcreateaccount: 'Try signing in with a different account.',\r\n  callback: 'Try signing in with a different account.',\r\n  oauthaccountnotlinked:\r\n    'To confirm your identity, sign in with the same account you used originally.',\r\n  emailsignin: 'The e-mail could not be sent.',\r\n  emailverify: 'Please verify your email, a new email has been sent.',\r\n  credentialssignin:\r\n    'Sign in failed. Check the details you provided are correct.',\r\n  sessionrequired: 'Please sign in to access this page.'\r\n};\r\n\r\nconst getErrorMessage = (errorType?: string): string => {\r\n  if (!errorType) {\r\n    return '';\r\n  }\r\n  return signinErrors[errorType.toLowerCase()] ?? signinErrors.default;\r\n};\r\n\r\ntype AuthLoginProps = {\r\n  title: string;\r\n  error?: string;\r\n  providers: string[];\r\n  callbackUrl: string;\r\n  onPasswordSignIn?: (\r\n    email: string,\r\n    password: string,\r\n    callbackUrl: string\r\n  ) => Promise<any>;\r\n  onOAuthSignIn?: (provider: string, callbackUrl: string) => Promise<any>;\r\n  onSignUp?: (\r\n    email: string,\r\n    password: string,\r\n    callbackUrl: string\r\n  ) => Promise<any>;\r\n  onForgotPassword?: () => Promise<any>;\r\n  renderLogo?: React.ReactElement;\r\n  passwordChecklistSettings?: {\r\n    rules: RuleNames[];\r\n    messages?: Partial<Record<RuleNames, string>>;\r\n    minLength?: number;\r\n    maxLength?: number;\r\n  };\r\n};\r\n\r\nconst AuthLogin = ({\r\n  title,\r\n  error,\r\n  providers,\r\n  callbackUrl,\r\n  onPasswordSignIn,\r\n  onOAuthSignIn,\r\n  onForgotPassword,\r\n  onSignUp,\r\n  renderLogo,\r\n  passwordChecklistSettings\r\n}: AuthLoginProps) => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [isPasswordValid, setIsPasswordValid] = useState(\r\n    !passwordChecklistSettings\r\n  );\r\n  const [showSignIn, toggleShowSignIn] = useToggle(true);\r\n  const [showPassword, toggleShowPassword] = useToggle();\r\n  const [errorState, setErrorState] = useState(error);\r\n\r\n  const oAuthReady = onOAuthSignIn && providers.length;\r\n\r\n  useEffect(() => {\r\n    setErrorState(undefined);\r\n    formik.resetForm();\r\n  }, [showSignIn]);\r\n  useEffect(() => {\r\n    setErrorState(error);\r\n  }, [error]);\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      email: '',\r\n      password: ''\r\n    },\r\n    validationSchema: yup.object({\r\n      email: yup.string().required(),\r\n      password: yup.string().required()\r\n    }),\r\n    onSubmit: async ({ email, password }) => {\r\n      setLoading(true);\r\n\r\n      if (!onPasswordSignIn) {\r\n        return;\r\n      }\r\n\r\n      try {\r\n        showSignIn\r\n          ? await onPasswordSignIn(email, password, callbackUrl)\r\n          : onSignUp && (await onSignUp(email, password, callbackUrl));\r\n      } catch (err: unknown) {\r\n        if (err instanceof Error) {\r\n          setErrorState(err.message);\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    },\r\n    validateOnBlur: true\r\n  });\r\n\r\n  return (\r\n    <AuthTemplate title={title} renderLogo={renderLogo}>\r\n      {errorState ? (\r\n        <Alert sx={{ my: 1 }} severity=\"error\">\r\n          {getErrorMessage(errorState)}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      {onPasswordSignIn ? (\r\n        <form onSubmit={formik.handleSubmit}>\r\n          <TextInput\r\n            id=\"email\"\r\n            placeholder=\"Email address\"\r\n            size=\"medium\"\r\n            value={formik.values.email}\r\n            hasError={!!formik.errors.email}\r\n            description={formik.touched.email ? formik.errors.email : undefined}\r\n            onBlur={formik.handleBlur}\r\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n              formik.setFieldValue('email', e.target.value)\r\n            }\r\n          />\r\n          <TextInput\r\n            id=\"password\"\r\n            placeholder=\"Password\"\r\n            value={formik.values.password}\r\n            hasError={!!formik.errors.password}\r\n            description={\r\n              formik.touched.password ? formik.errors.password : undefined\r\n            }\r\n            onBlur={formik.handleBlur}\r\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n              formik.setFieldValue('password', e.target.value)\r\n            }\r\n            type={showPassword ? 'text' : 'password'}\r\n            size=\"medium\"\r\n            endAdornment={\r\n              <InputAdornment position=\"end\">\r\n                <IconButton\r\n                  aria-label=\"toggle password visibility\"\r\n                  onClick={toggleShowPassword}\r\n                >\r\n                  {showPassword ? <VisibilityOff /> : <Visibility />}\r\n                </IconButton>\r\n              </InputAdornment>\r\n            }\r\n          />\r\n\r\n          {!showSignIn &&\r\n          formik.values.password.length &&\r\n          passwordChecklistSettings ? (\r\n            <Box\r\n              sx={{\r\n                border: 1,\r\n                marginTop: 1,\r\n                padding: 1.5,\r\n                borderRadius: 1,\r\n                borderColor: 'grey.400',\r\n                '& .checklist-icon': {\r\n                  marginTop: 0.5\r\n                },\r\n                fontSize: 14\r\n              }}\r\n            >\r\n              Your password must contain:\r\n              <PasswordChecklist\r\n                rules={passwordChecklistSettings.rules}\r\n                minLength={passwordChecklistSettings.minLength}\r\n                maxLength={passwordChecklistSettings.maxLength}\r\n                value={formik.values.password}\r\n                messages={passwordChecklistSettings.messages}\r\n                onChange={setIsPasswordValid}\r\n              />\r\n            </Box>\r\n          ) : null}\r\n\r\n          {showSignIn && onForgotPassword ? (\r\n            <Link href=\"#\" marginTop={1} onClick={onForgotPassword}>\r\n              Forgot password?\r\n            </Link>\r\n          ) : null}\r\n          <Button\r\n            type=\"submit\"\r\n            disabled={loading || (!showSignIn && !isPasswordValid)}\r\n            variant=\"contained\"\r\n            sx={{ marginTop: 3, width: '100%' }}\r\n          >\r\n            Continue\r\n          </Button>\r\n        </form>\r\n      ) : null}\r\n\r\n      {onSignUp ? (\r\n        <Stack direction=\"row\" alignItems=\"center\" gap={0.5} marginTop={1}>\r\n          {showSignIn ? (\r\n            <>\r\n              <Typography color=\"text.primary\">{`${\"Don't have an account?\"}`}</Typography>\r\n              <Link component=\"button\" onClick={toggleShowSignIn}>\r\n                Sign Up\r\n              </Link>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Typography color=\"text.primary\">{`${'Already have an account?'}`}</Typography>\r\n              <Link component=\"button\" onClick={toggleShowSignIn}>\r\n                Sign In\r\n              </Link>\r\n            </>\r\n          )}\r\n        </Stack>\r\n      ) : null}\r\n      {onPasswordSignIn && oAuthReady ? (\r\n        <Typography\r\n          color=\"text.primary\"\r\n          sx={{\r\n            alignItems: 'center',\r\n            direction: 'row',\r\n            display: 'flex',\r\n            gap: 2,\r\n            marginTop: 1,\r\n            width: '100%',\r\n            ':before, :after': {\r\n              content: '\"\"',\r\n              borderBottom: `1px solid ${grey[400]}`,\r\n              height: '0.5px',\r\n              flex: '1 0 auto'\r\n            }\r\n          }}\r\n        >\r\n          OR\r\n        </Typography>\r\n      ) : null}\r\n      {oAuthReady ? (\r\n        <Stack color=\"text.primary\" marginTop={1} gap={1}>\r\n          {providers.map((provider, index) => (\r\n            <ProviderButton\r\n              key={`provider-${index}`}\r\n              isSignIn={showSignIn}\r\n              provider={provider}\r\n              onClick={() => onOAuthSignIn(provider, callbackUrl)}\r\n            />\r\n          ))}\r\n        </Stack>\r\n      ) : null}\r\n    </AuthTemplate>\r\n  );\r\n};\r\n\r\nexport { AuthLogin };\r\n","import TextField, { TextFieldProps } from '@mui/material/TextField';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\nimport { InputStateHandler } from './InputStateHandler';\r\n\r\ntype TextInputProps = {\r\n  value?: string;\r\n  placeholder?: string;\r\n  endAdornment?: React.ReactNode;\r\n} & IInput &\r\n  Omit<React.InputHTMLAttributes<HTMLInputElement>, 'size'> &\r\n  Pick<TextFieldProps, 'multiline'>;\r\n\r\nconst TextInput = ({\r\n  description,\r\n  disabled,\r\n  hasError,\r\n  id,\r\n  label,\r\n  size = 'small',\r\n  tooltip,\r\n  multiline,\r\n  endAdornment,\r\n  ...rest\r\n}: TextInputProps): JSX.Element => {\r\n  return (\r\n    <InputStateHandler\r\n      description={description}\r\n      hasError={hasError}\r\n      id={id}\r\n      label={label}\r\n      tooltip={tooltip}\r\n    >\r\n      <TextField\r\n        disabled={disabled}\r\n        InputProps={{ endAdornment }}\r\n        inputProps={{\r\n          ...rest,\r\n          id: id,\r\n          name: id,\r\n          sx: {\r\n            height: size === 'small' ? '7px' : '15px',\r\n            minHeight: multiline ? '100px' : 'auto'\r\n          }\r\n        }}\r\n        fullWidth\r\n        multiline={multiline}\r\n        sx={{\r\n          fontSize: '14px',\r\n          fontWeight: 400,\r\n          my: 0.5\r\n        }}\r\n      />\r\n    </InputStateHandler>\r\n  );\r\n};\r\n\r\nexport { TextInput };\r\nexport type { TextInputProps };\r\n","import type { SxProps } from '@mui/material';\r\nimport FormControl from '@mui/material/FormControl';\r\nimport FormHelperText from '@mui/material/FormHelperText';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\nimport { InputLabel } from './InputLabel';\r\n\r\ntype InputStateHandlerProps = {\r\n  children: React.ReactNode;\r\n  sx?: SxProps;\r\n} & IInput;\r\n\r\nconst InputStateHandler = (props: InputStateHandlerProps): JSX.Element => {\r\n  const {\r\n    children,\r\n    description,\r\n    hasError,\r\n    id,\r\n    label,\r\n    notificationsProps,\r\n    tooltip,\r\n    sx\r\n  } = props;\r\n\r\n  return (\r\n    <Stack width=\"100%\" sx={sx} gap={0.5}>\r\n      {label ? (\r\n        <InputLabel\r\n          id={id}\r\n          label={label}\r\n          tooltip={tooltip}\r\n          notificationsProps={notificationsProps}\r\n        />\r\n      ) : null}\r\n      <FormControl error={hasError} fullWidth>\r\n        {children}\r\n        {description ? <FormHelperText>{description}</FormHelperText> : null}\r\n      </FormControl>\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { InputStateHandler };\r\nexport type { InputStateHandlerProps };\r\n","import type { Theme } from '@mui/material';\r\nimport Box from '@mui/material/Box';\r\nimport TextField from '@mui/material/TextField';\r\nimport Typography from '@mui/material/Typography';\r\nimport useTheme from '@mui/material/styles/useTheme';\r\n\r\nimport { NotificationCountProps } from './types/NotificationCount';\r\n\r\nconst NotificationCount = ({\r\n  count,\r\n  inputProps\r\n}: NotificationCountProps): JSX.Element | null => {\r\n  const theme = useTheme();\r\n\r\n  if (!count) return null;\r\n\r\n  const renderBox = () => (\r\n    <Box\r\n      display=\"flex\"\r\n      alignItems=\"center\"\r\n      className=\"notification-count\"\r\n      sx={{\r\n        borderRadius: '6px',\r\n        padding: '4px 8px',\r\n        backgroundColor:\r\n          theme.palette.mode === 'light' ? 'grey.100' : 'grey.800'\r\n      }}\r\n    >\r\n      <Typography\r\n        className=\"notification-count\"\r\n        color=\"text.secondary\"\r\n        sx={{\r\n          fontSize: '12px',\r\n          fontWeight: 600\r\n        }}\r\n      >\r\n        {count}\r\n      </Typography>\r\n    </Box>\r\n  );\r\n\r\n  const renderInput = () => {\r\n    const getInputWidth = (hasArrow?: boolean) => {\r\n      const countString = count.toString();\r\n      let contentWidth = countString.length * 8 + (hasArrow ? 22 : 0);\r\n      if (countString.includes('.') || countString.includes(','))\r\n        contentWidth -= 6;\r\n      return `${contentWidth}px`;\r\n    };\r\n\r\n    return inputProps ? (\r\n      <TextField\r\n        id={inputProps.id}\r\n        inputProps={{\r\n          type: 'number',\r\n          max: inputProps.max,\r\n          min: inputProps.min,\r\n          step: inputProps.step || 1,\r\n          sx: {\r\n            width: getInputWidth(),\r\n            padding: (theme: Theme) => theme.spacing(0.5, 1),\r\n            fontSize: '12px',\r\n            fontWeight: 600,\r\n            color: 'text.secondary',\r\n            MozAppearance: 'textfield',\r\n            '&::-webkit-inner-spin-button, &::-webkit-outer-spin-button': {\r\n              display: 'none'\r\n            },\r\n            '&:focus': {\r\n              width: getInputWidth(true),\r\n              MozAppearance: 'auto',\r\n              '&::-webkit-inner-spin-button, &::-webkit-outer-spin-button': {\r\n                display: 'flex'\r\n              }\r\n            }\r\n          }\r\n        }}\r\n        sx={{\r\n          borderRadius: '6px',\r\n          backgroundColor: (theme: Theme) =>\r\n            theme.palette.mode === 'light' ? 'grey.100' : 'grey.800',\r\n          '& fieldset': { border: 'none' }\r\n        }}\r\n        value={count}\r\n        onChange={inputProps.onChange}\r\n      />\r\n    ) : null;\r\n  };\r\n\r\n  return !inputProps ? renderBox() : renderInput();\r\n};\r\n\r\nexport { NotificationCount };\r\n","import { NotificationCount } from 'src/NotificationCount';\r\n\r\nimport Info from '@mui/icons-material/Info';\r\nimport Box from '@mui/material/Box';\r\nimport MInputLabel from '@mui/material/InputLabel';\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\nimport { NotificationCountProps } from 'src/types/NotificationCount';\r\n\r\ntype InputLabelProps = {\r\n  id?: string;\r\n  label: string | number;\r\n  tooltip?: string;\r\n  notificationsProps?: NotificationCountProps;\r\n};\r\n\r\nconst InputLabel = ({\r\n  id,\r\n  label,\r\n  tooltip,\r\n  notificationsProps\r\n}: InputLabelProps): JSX.Element => {\r\n  return (\r\n    <Box display=\"flex\" justifyContent=\"space-between\" width=\"100%\">\r\n      <Box display=\"flex\" gap={0.5} alignItems=\"center\">\r\n        <MInputLabel\r\n          htmlFor={id}\r\n          sx={{\r\n            fontWeight: 600,\r\n            fontSize: '12px',\r\n            color: 'grey.500'\r\n          }}\r\n        >\r\n          {label}\r\n        </MInputLabel>\r\n        {tooltip ? (\r\n          <Tooltip title={tooltip}>\r\n            <Info sx={{ fontSize: 12, color: 'grey.600' }} />\r\n          </Tooltip>\r\n        ) : null}\r\n      </Box>\r\n      {notificationsProps ? (\r\n        <NotificationCount {...notificationsProps} />\r\n      ) : null}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport { InputLabel };\r\n","export const white = '#FFFFFF';\r\n\r\nexport const grey = {\r\n  50: '#FAFAFA',\r\n  100: '#F5F5F5',\r\n  200: '#EEEEEE',\r\n  300: '#E0E0E0',\r\n  400: '#BDBDBD',\r\n  500: '#9E9E9E',\r\n  600: '#757575',\r\n  700: '#616161',\r\n  800: '#424242',\r\n  850: '#303030',\r\n  900: '#212121'\r\n};\r\n\r\nexport const primary = {\r\n  50: '#FEEDEF',\r\n  100: '#FCD1D7',\r\n  200: '#FBA3B1',\r\n  300: '#F9748F',\r\n  400: '#F05579',\r\n  500: '#F51762',\r\n  600: '#DA0054',\r\n  700: '#B90A47',\r\n  800: '#980039',\r\n  900: '#79002C'\r\n};\r\n\r\nexport const green = {\r\n  50: '#E6F5EE',\r\n  100: '#CDEADE',\r\n  200: '#9ED6BE',\r\n  300: '#72C29E',\r\n  400: '#4AAE80',\r\n  500: '#20A56D',\r\n  600: '#258A59',\r\n  700: '#21794E',\r\n  800: '#1D6844',\r\n  900: '#19583A'\r\n};\r\n\r\nexport const yellow = {\r\n  50: '#FFF5E6',\r\n  100: '#FFEBCC',\r\n  200: '#FFD699',\r\n  300: '#FFC266',\r\n  400: '#FFAD33',\r\n  500: '#FF9900',\r\n  600: '#E68A00',\r\n  700: '#CC7A00',\r\n  800: '#B36B00',\r\n  900: '#995C00'\r\n};\r\n\r\nexport default {\r\n  white,\r\n  grey,\r\n  primary,\r\n  green,\r\n  yellow\r\n};\r\n","import Box from '@mui/material/Box';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\ninterface AuthTemplateProps {\r\n  children: React.ReactNode;\r\n  renderLogo?: React.ReactElement;\r\n  title?: string;\r\n}\r\n\r\nconst AuthTemplate = ({\r\n  title,\r\n  children,\r\n  renderLogo\r\n}: AuthTemplateProps): JSX.Element => {\r\n  return (\r\n    <Stack\r\n      sx={{\r\n        backgroundColor: (theme) => theme.palette.background.default,\r\n        height: '100vh',\r\n        width: '100vw',\r\n        alignItems: 'center',\r\n        justifyContent: 'center'\r\n      }}\r\n    >\r\n      <Box\r\n        sx={(theme) => ({\r\n          backgroundColor: (theme) => theme.palette.background.paper,\r\n          border: (theme) => `1px solid ${theme.palette.divider}`,\r\n          borderRadius: 1,\r\n          padding: theme.spacing(5, 5),\r\n\r\n          maxWidth: '400px',\r\n          height: 'auto',\r\n          maxHeight: '90%',\r\n\r\n          [theme.breakpoints.down('sm')]: {\r\n            maxWidth: 'unset',\r\n            width: '100%',\r\n            height: '100%'\r\n          }\r\n        })}\r\n      >\r\n        <Stack\r\n          sx={{\r\n            alignItems: 'center',\r\n            gap: 3,\r\n            marginBottom: 3\r\n          }}\r\n        >\r\n          {renderLogo}\r\n          {title ? (\r\n            <Typography textAlign=\"center\" color=\"text.primary\">\r\n              {title}\r\n            </Typography>\r\n          ) : null}\r\n        </Stack>\r\n        <Stack gap={1} paddingX={3}>\r\n          {children}\r\n        </Stack>\r\n      </Box>\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { AuthTemplate };\r\n","import { grey } from 'theme/palette';\r\n\r\nimport GitHub from '@mui/icons-material/GitHub';\r\nimport Google from '@mui/icons-material/Google';\r\nimport Microsoft from '@mui/icons-material/Microsoft';\r\nimport Button from '@mui/material/Button';\r\n\r\nimport { Auth0 } from './Auth0';\r\nimport { Cognito } from './Cognito';\r\nimport { Descope } from './Descope';\r\nimport { Okta } from './Okta';\r\n\r\nfunction capitalizeFirstLetter(string: string) {\r\n  return string.charAt(0).toUpperCase() + string.slice(1);\r\n}\r\n\r\nfunction getProviderName(provider: string) {\r\n  switch (provider) {\r\n    case 'azure-ad':\r\n      return 'Microsoft';\r\n    case 'github':\r\n      return 'GitHub';\r\n    case 'okta':\r\n      return 'Okta';\r\n    case 'descope':\r\n      return 'Descope';\r\n    case 'aws-cognito':\r\n      return 'Coginto';\r\n    default:\r\n      return capitalizeFirstLetter(provider);\r\n  }\r\n}\r\n\r\nfunction renderProviderIcon(provider: string) {\r\n  switch (provider) {\r\n    case 'google':\r\n      return <Google />;\r\n    case 'github':\r\n      return <GitHub />;\r\n    case 'azure-ad':\r\n      return <Microsoft />;\r\n    case 'okta':\r\n      return <Okta />;\r\n    case 'auth0':\r\n      return <Auth0 />;\r\n    case 'descope':\r\n      return <Descope />;\r\n    case 'aws-cognito':\r\n      return <Cognito />;\r\n    default:\r\n      return null;\r\n  }\r\n}\r\n\r\ninterface ProviderButtonProps {\r\n  provider: string;\r\n  onClick: () => void;\r\n  isSignIn?: boolean;\r\n}\r\n\r\nconst ProviderButton = ({\r\n  provider,\r\n  onClick,\r\n  isSignIn\r\n}: ProviderButtonProps): JSX.Element => {\r\n  return (\r\n    <Button\r\n      variant=\"outlined\"\r\n      color=\"inherit\"\r\n      startIcon={renderProviderIcon(provider.toLowerCase())}\r\n      onClick={onClick}\r\n      sx={{\r\n        width: '100%',\r\n        textTransform: 'none',\r\n        borderColor: grey[400],\r\n        padding: 1.5,\r\n        paddingLeft: 3,\r\n        justifyContent: 'flex-start'\r\n      }}\r\n    >\r\n      {`${isSignIn ? 'Continue' : 'Sign up'} with ${getProviderName(provider)}`}\r\n    </Button>\r\n  );\r\n};\r\n\r\nexport { ProviderButton };\r\n","export const Auth0 = () => {\r\n  return (\r\n    <svg\r\n      width=\"24\"\r\n      height=\"24\"\r\n      viewBox=\"0 0 256 287\"\r\n      style={{ fill: 'inherit' }}\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      preserveAspectRatio=\"xMinYMin meet\"\r\n    >\r\n      <path d=\"M203.24 231.531l-28.73-88.434 75.208-54.64h-92.966L128.019.025l-.009-.024h92.98l28.74 88.446.002-.002.024-.013c16.69 51.31-.5 109.67-46.516 143.098zm-150.45 0l-.023.017 75.228 54.655 75.245-54.67-75.221-54.656-75.228 54.654zM6.295 88.434c-17.57 54.088 2.825 111.4 46.481 143.108l.007-.028 28.735-88.429-75.192-54.63h92.944L128.004.024 128.01 0H35.025L6.294 88.434z\" />\r\n    </svg>\r\n  );\r\n};\r\n","export const Cognito = () => {\r\n  return (\r\n    <svg\r\n      width=\"24\"\r\n      height=\"24\"\r\n      viewBox=\"0 0 256 299\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      preserveAspectRatio=\"xMidYMid\"\r\n    >\r\n      <path\r\n        d=\"M208.752 58.061l25.771-6.636.192.283.651 155.607-.843.846-5.31.227-20.159-3.138-.302-.794V58.061M59.705 218.971l.095.007 68.027 19.767.173.133.296.236-.096 59.232-.2.252-68.295-33.178v-46.449\"\r\n        fill=\"#7A3E65\"\r\n      />\r\n      <path\r\n        d=\"M208.752 204.456l-80.64 19.312-40.488-9.773-27.919 4.976L128 238.878l105.405-28.537 1.118-2.18-25.771-3.705\"\r\n        fill=\"#CFB2C1\"\r\n      />\r\n      <path\r\n        d=\"M196.295 79.626l-.657-.749-66.904-19.44-.734.283-.672-.343L22.052 89.734l-.575.703.845.463 24.075 3.53.851-.289 80.64-19.311 40.488 9.773 27.919-4.977\"\r\n        fill=\"#512843\"\r\n      />\r\n      <path\r\n        d=\"M47.248 240.537l-25.771 6.221-.045-.149-1.015-155.026 1.06-1.146 25.771 3.704v146.396\"\r\n        fill=\"#C17B9E\"\r\n      />\r\n      <path\r\n        d=\"M82.04 180.403l45.96 5.391.345-.515.187-71.887-.532-.589-45.96 5.392v62.208\"\r\n        fill=\"#7A3E65\"\r\n      />\r\n      <path\r\n        d=\"M173.96 180.403L128 185.794v-72.991l45.96 5.392v62.208M196.295 79.626L128 59.72V0l68.295 33.177v46.449\"\r\n        fill=\"#C17B9E\"\r\n      />\r\n      <path\r\n        d=\"M128 0L0 61.793v175.011l21.477 9.954V90.437L128 59.72V0\"\r\n        fill=\"#7A3E65\"\r\n      />\r\n      <path\r\n        d=\"M234.523 51.425v156.736L128 238.878v59.72l128-61.794V61.793l-21.477-10.368\"\r\n        fill=\"#C17B9E\"\r\n      />\r\n    </svg>\r\n  );\r\n};\r\n","export const Descope = () => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"24\"\r\n      height=\"24\"\r\n      version=\"1.1\"\r\n      viewBox=\"0 0 196 216\"\r\n      xmlSpace=\"preserve\"\r\n    >\r\n      <path\r\n        fill=\"#0198B8\"\r\n        d=\"M66.841 183.009c.049 4.355.097 8.71-.27 13.485-11.818-6.767-23.167-14.04-34.66-21.077-3.023-1.85-6.494-2.968-9.759-4.421-1.994-5.399-3.99-10.797-5.564-16.59 2.378.369 4.526.837 6.264 1.947 12.42 7.933 24.72 16.054 37.157 23.961 2.028 1.29 4.543 1.816 6.832 2.695z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#0BE5DA\"\r\n        d=\"M56.298 102c.85-.912 1.624-2.505 2.565-2.611 3.038-.343 6.137-.139 9.679.29 1.212 1.44 1.753 2.758 2.736 3.396 17.255 11.216 34.541 22.386 51.898 33.444 1.855 1.182 4.195 1.604 6.31 2.38-.19 1.28.077 3.15-.662 3.723-1.792 1.39-4.052 2.174-6.483 2.884-1.164-1.446-1.731-2.93-2.809-3.643-7.175-4.742-14.43-9.367-21.72-13.934-4.877-3.057-9.855-5.954-14.788-8.923-1.091-.413-2.182-.827-3.71-1.653-7.963-5.393-15.49-10.373-23.016-15.353z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#13E5D1\"\r\n        d=\"M129.377 138.545c-2.006-.422-4.346-.844-6.201-2.026-17.357-11.058-34.643-22.228-51.898-33.444-.983-.638-1.524-1.957-2.285-3.3 3.358-.406 6.73-.473 10.563-.1 1.243 1.615 1.78 3.14 2.856 3.903 3.597 2.547 7.509 4.656 11.063 7.256 2.387 1.748 4.374 4.043 6.254 6.143-.431.113-.606.145-.713.247-.096.092-.118.261-.172.397l5.186 1.336c1.656.136 3.312.279 4.968.406 7.268.557 12.628 3.671 15.482 10.766 1.153 2.866 3.167 5.386 4.897 8.416z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#07E4E3\"\r\n        d=\"M82.727 119.17a257.804 257.804 0 0115.086 8.759c7.29 4.567 14.544 9.192 21.719 13.934 1.078.713 1.645 2.197 2.45 3.691-2.826 1.962-5.652 3.557-9.194 5.557-2.288-4.191-4.438-7.98-6.446-11.841-3.98-7.655-7.928-7.877-13.248-.74-5.877-3.234-11.26-6.38-16.642-9.524 1.993-3.225 3.986-6.449 6.275-9.837z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#57DB45\"\r\n        d=\"M180.423 56.014c.762 2.732 1.524 5.464 1.853 8.58-1.646-.019-3-.2-4.05-.863-9.341-5.915-18.569-12.013-27.954-17.857-6.12-3.811-12.448-7.29-18.682-10.92-.078-2.364-.156-4.729.227-7.511 11.469 6.52 22.417 13.556 33.511 20.353 4.879 2.989 10.054 5.493 15.095 8.218z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#06A3BE\"\r\n        d=\"M66.914 182.573c-2.362-.443-4.877-.97-6.905-2.259-12.437-7.907-24.737-16.028-37.157-23.96-1.738-1.11-3.886-1.58-6.217-2.344-.464-.472-.555-.944-.662-2.2.014-2.802.045-4.819.445-6.821 4.9 2.647 9.35 5.428 13.983 7.865 3.738 1.966 7.696 3.516 11.557 5.25 5.502 9.625 13.99 15.097 25.029 17.64 0 2.146 0 4.27-.073 6.83z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#088FB2\"\r\n        d=\"M22.181 171.339c3.236 1.11 6.707 2.227 9.73 4.078 11.493 7.036 22.842 14.31 34.591 21.536.346 1.483.346 2.924.346 4.552-19.021-2.271-32.731-12.099-42.868-27.5-.534-.811-1.177-1.55-1.799-2.666z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#5CDB3C\"\r\n        d=\"M180.408 55.677c-5.026-2.388-10.201-4.892-15.08-7.881-11.094-6.797-22.042-13.833-33.376-20.778-.418-2.055-.51-4.103-.145-6.568 1.673.084 3 .414 4.09 1.112 10.474 6.71 20.862 13.554 31.389 20.18 2.318 1.459 5.084 2.206 7.644 3.281 1.821 3.44 3.642 6.878 5.478 10.654z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#59DD55\"\r\n        d=\"M131.458 35.376c6.366 3.207 12.693 6.687 18.814 10.498 9.385 5.844 18.613 11.942 27.954 17.857 1.05.664 2.404.844 3.974 1.244.501 2.046.646 4.098.38 6.545-7.279-3.892-14.065-8.316-21.058-12.385-2.192-1.275-4.942-1.59-7.436-2.346-5.384-3.857-10.328-8.777-16.286-11.25-5.178-2.148-7.703-4.195-6.342-10.163z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#01E3E3\"\r\n        d=\"M15.447 90.994c-.065-4.355-.131-8.71.255-13.521 2.615.575 4.824 1.524 6.932 2.657 5.425 2.916 10.805 5.913 16.203 8.878.046 4.358.092 8.716-.295 13.527-3.835-1.435-7.207-3.382-10.647-5.197-4.118-2.173-8.296-4.234-12.448-6.344z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#22E3B4\"\r\n        d=\"M100.982 92.49c-5.371.802-10.758 1.513-16.107 2.443-2.781.484-4.543-.264-5.988-2.802-3.166-5.56-6.618-10.957-10.33-17.038 2.094-1.064 3.92-1.994 6.137-2.627 1.35 1.37 2.138 2.71 3.302 3.476 6.054 3.99 12.27 7.737 18.282 11.79 1.813 1.222 3.15 3.153 4.704 4.759z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#66DB3A\"\r\n        d=\"M174.883 44.68c-2.513-.732-5.279-1.48-7.597-2.938-10.527-6.626-20.915-13.47-31.39-20.18-1.09-.698-2.416-1.028-3.964-1.533-1.176-3.157-.493-4.067 3.096-3.379 17.434 3.343 30.305 13.045 39.855 28.03z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#07E4E3\"\r\n        d=\"M173.516 175.205c-2.971 3.499-5.943 6.998-9.27 10.29-4.452-3.19-8.447-6.328-12.682-9.1-2.676-1.75-5.71-2.954-8.585-4.403 3.165-2.552 6.33-5.105 10.158-7.814 2.674.924 4.708 1.962 6.688 3.095 4.578 2.62 9.13 5.285 13.691 7.932z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#19E3BC\"\r\n        d=\"M128.157 117.563c-5.08.066-10.162.133-15.708-.24-1.486-1.621-2.32-3.067-3.56-3.937-4.746-3.333-9.7-6.372-14.403-9.762-1.448-1.044-2.341-2.857-3.488-4.318 5.015-.057 10.03-.114 15.524.242 1.13 1.272 1.615 2.373 2.46 2.95 4.987 3.41 10.154 6.566 15.047 10.101 1.69 1.22 2.77 3.285 4.128 4.964z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#26E2A8\"\r\n        d=\"M101.374 92.561c-1.947-1.676-3.283-3.607-5.096-4.83-6.011-4.052-12.228-7.798-18.282-11.789-1.164-.767-1.951-2.106-2.947-3.525 2.391-1.668 4.817-2.992 7.748-4.059 2.898 1.398 5.29 2.537 7.683 3.677 1.158 2.159 2.405 4.276 3.453 6.487 1.481 3.128 3.688 4.935 8.075 4.528 3.838 2.53 6.91 5.09 9.981 7.649-3.408.644-6.815 1.289-10.615 1.862z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#52DD5A\"\r\n        d=\"M154.217 57.132c2.363.412 5.113.728 7.305 2.003 6.993 4.069 13.78 8.493 20.991 12.823.386 3.074.426 6.106.057 9.544-8.285-4.232-16.162-8.87-24.038-13.508a10797.74 10797.74 0 01-4.315-10.862z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#00CFD8\"\r\n        d=\"M16.05 144.975c-.032 2.016-.063 4.033-.11 6.474-.266-1.494-.726-3.41-.731-5.328-.036-15.064.016-30.13.484-45.645 2.058.335 3.731 1.02 5.277 1.925 5.976 3.495 11.912 7.06 17.863 10.6.047 2.703.095 5.406-.273 8.51-7.515-3.888-14.615-8.178-22.472-12.926 0 3.858 0 6.64-.026 9.87-.011 3.147.004 5.844-.011 8.991-.014 3.152.002 5.853-.008 9.004-.015 3.14-.004 5.833.006 8.525z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#22E2AA\"\r\n        d=\"M112.026 99.266c3.355-.08 6.71-.16 10.58.153 7.661 4.795 14.808 9.196 21.955 13.596v4.757c-3.706 0-7.16 0-11.087-.418-1.152-1.264-1.678-2.334-2.536-2.918-5.006-3.407-10.197-6.553-15.088-10.114-1.635-1.19-2.57-3.343-3.824-5.056z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#0BE5DA\"\r\n        d=\"M38.909 88.559c-5.47-2.516-10.85-5.513-16.275-8.429-2.108-1.133-4.317-2.082-6.836-3.111-.392-3.025-.428-6.053-.01-9.536 2.605.583 4.8 1.543 6.903 2.674 5.414 2.913 10.786 5.902 16.176 8.86.038 3.03.076 6.062.042 9.542z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#04D9DF\"\r\n        d=\"M142.637 172.105c3.216 1.336 6.251 2.54 8.927 4.29 4.235 2.772 8.23 5.91 12.376 9.23-1.94 2.225-3.928 4.112-6.416 5.68-2.805-2.126-5.087-3.967-7.423-5.736-4.688-3.55-9.406-7.062-14.111-10.59 2.101-.92 4.203-1.841 6.647-2.874z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#07E4E3\"\r\n        d=\"M56.216 102.46c7.609 4.52 15.135 9.5 22.722 14.795-7.345.314-14.751.314-22.804.314 0-4.869 0-9.758.082-15.108z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#00D9DE\"\r\n        d=\"M38.904 112.552c-6.022-3.09-11.958-6.656-17.934-10.151-1.546-.904-3.22-1.59-5.178-2.382-.41-2.718-.475-5.43-.443-8.582 4.25 1.667 8.428 3.728 12.546 5.9 3.44 1.816 6.812 3.763 10.576 5.658.41 3.04.456 6.074.433 9.557z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#02ABC3\"\r\n        d=\"M16.418 144.989c-.38-2.706-.39-5.398-.012-8.534 2.24.512 4.135 1.395 5.936 2.439 5.769 3.34 11.503 6.74 17.25 10.117.75 2.772 1.498 5.544 2.306 8.705-3.801-1.346-7.759-2.896-11.497-4.862-4.633-2.437-9.084-5.218-13.983-7.865z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#14E4C7\"\r\n        d=\"M90.544 99.234c1.6 1.533 2.494 3.346 3.942 4.39 4.703 3.39 9.657 6.43 14.404 9.762 1.239.87 2.073 2.316 3.106 3.838-2.395.419-4.804.497-7.903.314-1.82-.378-2.949-.495-4.078-.611-2.166-2.05-4.153-4.345-6.54-6.093-3.554-2.6-7.466-4.71-11.063-7.256-1.077-.763-1.613-2.288-2.409-3.804 3.355-.43 6.722-.521 10.541-.54z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#00BDCD\"\r\n        d=\"M16.08 126.997c-.014-2.698-.029-5.395.343-8.539 2.267.537 4.164 1.488 6.024 2.508 5.47 2.998 10.925 6.023 16.386 9.038.048 3.032.096 6.064-.268 9.501-7.769-3.9-15.127-8.204-22.484-12.508z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#14E4C7\"\r\n        d=\"M39.985 66.998c-.326 2.73-.653 5.46-1.395 8.557-1.717-.33-3.022-1.016-4.317-1.721-6.023-3.282-12.043-6.569-18.064-9.854.57-2.436 1.14-4.873 2.25-7.643a29.74 29.74 0 017.06 2.707c4.853 2.594 9.648 5.296 14.466 7.954z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#02B4C8\"\r\n        d=\"M16.05 127.446c7.388 3.855 14.746 8.16 22.445 12.509.642 2.778.942 5.511 1.17 8.65-5.82-2.971-11.554-6.371-17.323-9.711-1.801-1.044-3.695-1.927-5.91-2.888-.379-2.707-.395-5.408-.381-8.56z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#00C6D3\"\r\n        d=\"M38.904 129.564c-5.532-2.575-10.987-5.6-16.457-8.598a74.807 74.807 0 00-5.998-2.956c-.36-2.785-.36-5.567-.36-9.425 7.856 4.748 14.956 9.038 22.4 13.372.391 2.418.439 4.792.415 7.607z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#19E3BC\"\r\n        d=\"M159.333 145.996c0-2.371 0-4.742.456-7.537 2.769.814 5.081 2.052 7.395 3.286 5.17 2.758 10.34 5.513 15.511 8.27-.218 2.093-.435 4.186-1.201 6.632-2.487-.413-4.517-1.009-6.349-1.978-5.313-2.81-10.547-5.771-15.812-8.673z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#36E087\"\r\n        d=\"M43.012 25.04c1.452-.952 2.904-1.903 4.846-2.6 6.652 4.024 12.816 7.791 18.98 11.558-.346 3.21-.692 6.42-1.446 9.266-1.63-1.61-2.685-3.108-4.105-4.06-4.952-3.319-10.12-6.323-15.008-9.73-1.426-.994-2.196-2.93-3.267-4.434z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#22E2AA\"\r\n        d=\"M182.848 137.005c.043 2.042.085 4.084-.298 6.554-5.814-2.777-11.152-6.073-16.617-9.141-1.954-1.097-4.217-1.646-6.338-2.445-.083-2.362-.166-4.724.204-7.511 1.925.273 3.46.865 4.857 1.688 6.086 3.582 12.132 7.23 18.192 10.855z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#10D2DA\"\r\n        d=\"M135.591 174.997c5.104 3.51 9.822 7.021 14.51 10.572 2.336 1.769 4.618 3.61 7.07 5.788-1.752 1.637-3.65 2.903-5.878 3.865-6.792-4.604-13.253-8.903-19.714-13.201-.304-3.114-1.881-6.883 4.012-7.024z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#2EE29A\"\r\n        d=\"M182.85 123.001c.044 2.044.088 4.087-.298 6.559-2.865-.817-5.323-2.023-7.734-3.316-5.092-2.732-10.158-5.51-15.235-8.268-.083-2.367-.165-4.733.205-7.523 1.196-.108 1.986.128 2.677.533 6.804 3.99 13.593 8.006 20.386 12.015z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#34E192\"\r\n        d=\"M42.672 25.09c1.41 1.454 2.181 3.39 3.607 4.384 4.889 3.407 10.056 6.411 15.008 9.73 1.42.952 2.475 2.45 3.713 4.031a22.66 22.66 0 01-6.684 2.299c-1.223-1.3-1.863-2.572-2.894-3.245-6.364-4.15-12.816-8.163-19.239-12.223 2.05-1.641 4.1-3.283 6.489-4.975z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#2EE29A\"\r\n        d=\"M35.89 30.195a473.368 473.368 0 0119.532 12.094c1.031.673 1.67 1.946 2.525 3.284-1.092.995-2.22 1.647-4.042 2.354a312.328 312.328 0 01-19.87-11.69c-.703-.449-.679-2.038-.991-3.097.85-.94 1.7-1.878 2.845-2.945z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#3CDF74\"\r\n        d=\"M182.838 95.002c.044 2.044.087 4.087-.3 6.558-3.87-1.491-7.28-3.461-10.755-5.314-4.021-2.144-8.098-4.185-12.151-6.27-.091-2.039-.182-4.078.203-6.542a33.016 33.016 0 018.01 3.094c5.042 2.744 10 5.64 14.993 8.474z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#38DF7C\"\r\n        d=\"M159.495 90.398c4.19 1.663 8.267 3.704 12.288 5.848 3.474 1.853 6.886 3.823 10.687 5.747.41 2.048.456 4.09.076 6.562-3.872-1.488-7.29-3.459-10.77-5.313-4.032-2.148-8.117-4.193-12.179-6.283-.08-2.046-.159-4.092-.102-6.56z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#04D9DF\"\r\n        d=\"M76.254 129.3c5.58 2.85 10.963 5.996 16.54 9.41-.633 2.14-1.462 4.01-2.936 6.076-6.049-3.127-11.451-6.45-16.854-9.775a537.765 537.765 0 013.25-5.712z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#44DE6C\"\r\n        d=\"M182.906 94.568c-5.06-2.4-10.019-5.296-15.06-8.04-2.43-1.322-5.018-2.355-7.879-3.514-.47-2.047-.597-4.1-.263-6.583 3.218.886 6.032 2.098 8.72 3.542 4.845 2.602 9.615 5.343 14.416 8.026.045 2.045.09 4.09.066 6.57z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#34E192\"\r\n        d=\"M182.917 122.567c-6.86-3.575-13.648-7.592-20.452-11.581-.691-.405-1.48-.641-2.552-.96-.413-1.73-.498-3.454-.111-5.598 3.012.683 5.653 1.602 8.073 2.927 5.055 2.769 9.993 5.751 14.98 8.646.043 2.044.086 4.088.062 6.566z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#0BE5DA\"\r\n        d=\"M173.79 175.063c-4.836-2.505-9.387-5.17-13.965-7.79a75.774 75.774 0 00-6.388-3.251 24.082 24.082 0 013.526-6.486c6.92 4.175 13.374 8.288 19.829 12.401-.91 1.662-1.818 3.323-3.001 5.126z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#00C6D3\"\r\n        d=\"M131.465 182.46c6.575 3.86 13.036 8.158 19.505 12.8-2.413 1.401-4.832 2.458-7.663 3.16-4.167-2.713-7.922-5.073-11.677-7.433-.093-2.696-.186-5.393-.165-8.528z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#14E4C7\"\r\n        d=\"M159.236 146.383c5.362 2.515 10.596 5.475 15.909 8.286 1.832.97 3.862 1.565 6.17 2.331-.242 2.213-.853 4.426-2.005 6.782-4.846-2.523-9.07-5.332-13.486-7.796-2.34-1.306-5.014-2.011-7.537-2.988.284-2.076.568-4.152.949-6.615z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#48DD63\"\r\n        d=\"M182.907 87.574c-4.868-2.258-9.638-5-14.482-7.601-2.69-1.444-5.503-2.656-8.62-3.972-.713-2.409-1.067-4.818-1.347-7.617 7.95 4.248 15.827 8.886 24.044 13.568.385 1.761.428 3.479.405 5.622z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#3BE189\"\r\n        d=\"M182.921 115.566c-5.053-2.46-9.99-5.442-15.046-8.21-2.42-1.326-5.061-2.245-7.952-3.343-.431-2.064-.513-4.132-.46-6.628 4.196 1.664 8.281 3.71 12.312 5.857 3.48 1.854 6.899 3.825 10.708 5.747.41 2.05.457 4.096.438 6.577z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#22E2AA\"\r\n        d=\"M47.885 52.757c-.817.965-1.634 1.931-3.08 3.02-7.014-4.162-13.399-8.447-19.784-12.732.813-1.245 1.626-2.49 3.083-3.849 4.956 2.48 9.387 4.9 13.535 7.734 2.324 1.588 4.18 3.862 6.246 5.827z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#19E3BC\"\r\n        d=\"M40.25 66.76c-5.083-2.42-9.878-5.122-14.731-7.716-2.112-1.129-4.343-2.034-6.888-3.041.25-1.793.87-3.585 2.047-5.683 2.473.551 4.455 1.287 6.292 2.287 5.016 2.732 9.972 5.576 14.952 8.376-.47 1.846-.939 3.692-1.673 5.776z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#22E3B4\"\r\n        d=\"M42.186 60.792c-5.244-2.609-10.2-5.453-15.216-8.185-1.837-1-3.819-1.736-6.082-2.585.951-2.219 2.25-4.445 3.84-6.824 6.678 4.132 13.063 8.417 19.794 12.73-.46 1.576-1.266 3.124-2.336 4.864zM159.464 132.392c2.252.38 4.515.929 6.469 2.026 5.465 3.068 10.803 6.364 16.552 9.575.379 1.73.397 3.455.313 5.601-5.273-2.336-10.444-5.091-15.614-7.849-2.314-1.234-4.626-2.472-7.27-3.712-.414-1.743-.497-3.483-.45-5.641z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#2CE2A4\"\r\n        d=\"M159.455 118.395c5.205 2.34 10.271 5.117 15.363 7.849a115.926 115.926 0 007.67 3.75c.408 2.051.453 4.097.429 6.578-6.13-3.191-12.175-6.84-18.26-10.422-1.399-.823-2.933-1.415-4.735-2.115-.418-1.742-.506-3.481-.467-5.64z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#34E192\"\r\n        d=\"M107.005 77c.83-1.862 1.66-3.724 3.114-5.754 6.028 3.442 11.431 7.05 16.835 10.66-.85 1.562-1.7 3.124-3.171 4.838-6.008-3.147-11.393-6.445-16.778-9.743z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#13E5D1\"\r\n        d=\"M158.124 153.32c2.686.655 5.36 1.36 7.7 2.666 4.416 2.464 8.64 5.273 13.304 8.085-.331 1.922-1.024 3.697-2.027 5.67-6.764-3.917-13.219-8.03-19.872-12.406.112-1.406.422-2.55.895-4.015z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#10D2DA\"\r\n        d=\"M72.707 135.176c5.7 3.16 11.102 6.483 16.876 9.808-.464 1.924-1.298 3.846-2.388 6.357l-18.676-9.997c1.469-2.266 2.68-4.134 4.188-6.168z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#40E28D\"\r\n        d=\"M127.235 81.727c-5.685-3.43-11.088-7.04-16.845-10.681.36-1.67 1.074-3.307 2.092-5.642l18.892 9.704c-1.531 2.556-2.695 4.498-4.14 6.619z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#32E29F\"\r\n        d=\"M106.734 77.187c5.656 3.112 11.04 6.41 16.77 9.736-2.041 4.98-6.953 2.77-11.099 3.845-3.487-2.629-6.559-5.188-9.995-7.75 1.108-1.883 2.581-3.764 4.324-5.83z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#26E2A8\"\r\n        d=\"M144.662 112.586c-7.248-3.971-14.395-8.372-21.603-13.101 3.302-.374 6.663-.42 10.541-.073 4.004 2.466 7.492 4.54 10.98 6.613.06 2.044.121 4.088.082 6.561z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#2CE2A4\"\r\n        d=\"M48.197 52.661c-2.379-1.87-4.234-4.143-6.558-5.731-4.148-2.835-8.579-5.255-13.244-7.882 1.117-1.9 2.587-3.768 4.353-5.772.608.923.584 2.512 1.287 2.96 6.318 4.029 12.765 7.857 19.54 11.745-1.446 1.528-3.256 3.057-5.378 4.68z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#38DF7C\"\r\n        d=\"M66.904 33.565c-6.23-3.334-12.394-7.101-18.71-11.163a27.463 27.463 0 017.47-3.006c3.998 2.755 7.584 5.18 11.17 7.604.045 2.043.09 4.087.07 6.565z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#00BDCD\"\r\n        d=\"M131.497 191.427c3.888 1.92 7.643 4.28 11.448 6.969-3.55 1.412-7.15 2.496-11.582 3.83 0-3.906 0-7.133.134-10.8z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#32E6BE\"\r\n        d=\"M111.61 99.179c1.67 1.8 2.605 3.952 4.24 5.143 4.89 3.56 10.082 6.707 15.088 10.114.858.584 1.384 1.654 2.086 2.837-1.387.386-2.797.437-4.537.388-1.688-1.777-2.768-3.841-4.458-5.062-4.893-3.535-10.06-6.69-15.047-10.1-.845-.578-1.33-1.68-2-2.884 1.392-.404 2.802-.464 4.628-.436z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#3CDF74\"\r\n        d=\"M66.901 26.546c-3.653-1.97-7.239-4.395-10.86-7.165 3.35-1.367 6.735-2.387 10.928-3.65 0 3.915 0 7.138-.068 10.815z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#23E0D5\"\r\n        d=\"M16.109 64.287c6.121 2.978 12.14 6.265 18.164 9.547 1.295.705 2.6 1.392 4.249 2.12.395.793.442 1.553.417 2.688-5.462-2.583-10.834-5.572-16.248-8.485-2.103-1.131-4.298-2.09-6.798-3.113-.193-.806-.039-1.628.216-2.757z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#32E29F\"\r\n        d=\"M144.68 105.59c-3.588-1.639-7.076-3.712-10.626-6.115 3.355-.33 6.772-.33 10.726-.33 0 2.18 0 4.094-.1 6.444zM90.45 71.705c-2.363-.81-4.755-1.95-7.3-3.396.974-1.133 2.102-1.96 3.466-2.96 1.41 2.235 2.607 4.13 3.834 6.356z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n      <path\r\n        fill=\"#32E6BE\"\r\n        d=\"M99.73 116.977c1.414.066 2.543.183 3.91.537.249.441.26.644.33 1.145-1.669-.147-3.397-.593-5.126-1.038.054-.136.076-.305.172-.397.107-.102.282-.134.713-.247z\"\r\n        opacity=\"1\"\r\n      ></path>\r\n    </svg>\r\n  );\r\n};\r\n","export const Okta = () => {\r\n  return (\r\n    <svg\r\n      version=\"1.2\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      viewBox=\"0 0 1594 1595\"\r\n      width=\"24\"\r\n      height=\"24\"\r\n      style={{ fill: 'inherit' }}\r\n    >\r\n      <path\r\n        fillRule=\"evenodd\"\r\n        d=\"m877 11.5l-32.8 403.8c-15.5-1.8-31-2.7-46.9-2.7-19.9 0-39.4 1.3-58.5 4.4l-18.6-195.6c-0.4-6.2 4.5-11.6 10.7-11.6h33.2l-16-197.8c-0.4-6.2 4.5-11.6 10.2-11.6h108.5c6.2 0 11.1 5.4 10.2 11.1zm-166.1 410.4c-35 8-68.2 20.8-98.8 37.6l-84.6-177.5c-2.6-5.3 0-11.9 5.8-14.2l31.4-11.5-82.8-180.6c-2.6-5.3 0-11.9 5.8-14.2l101.9-37.2c5.7-2.2 11.9 1.4 13.7 7.1 0.4 0 107.6 390.5 107.6 390.5zm-357.4-278l234.3 330.2c-29.7 19.5-56.7 42.5-79.7 69.1l-140.5-138.1c-4.4-4.4-3.9-11.5 0.5-15.5l25.7-21.3-139.6-141.2c-4.4-4.4-3.9-11.5 0.9-15.5l82.9-69.5c4.8-4 11.5-3.1 15 1.8zm136.9 421.4c-21.3 27.9-38.5 58.9-51.4 92.1l-178.9-81.9c-5.8-2.2-8-9.3-4.9-14.6l16.8-28.8-179.8-85c-5.3-2.6-7.5-9.3-4.4-14.6l54-93.8c3.1-5.3 10.2-7.1 15.1-3.6zm-466 24.8c0.9-6.2 7.1-9.7 12.8-8.4l392 102.3c-10.2 33.2-15.9 68.2-16.8 104.5l-196.2-16c-6.2-0.4-10.7-6.2-9.3-12.4l5.7-32.7-198-18.6c-6.2-0.5-10.1-6.2-9.3-12.4l18.6-106.7zm-15 264.7l403.5-37.2c1.8 35.9 8.9 70.9 19.9 103.6l-189.5 52.3c-5.8 1.3-12-2.2-12.9-8.4l-5.7-32.8-192.3 50c-5.7 1.4-11.9-2.2-12.8-8.4l-19.1-106.7c-0.9-6.2 3.1-11.9 9.3-12.4zm63.4 280.7c-3.1-5.3-0.9-11.9 4.4-14.6l365.9-173.5c13.7 32.7 32.3 63.3 54.4 90.7l-160.3 114.2c-4.9 3.6-12 2.2-15.1-3.1l-16.8-29.2-163.4 112.9c-4.9 3.5-12 1.8-15.1-3.5 0 0-54.5-93.9-54-93.9zm525.7-9.3l-111.6 162c-3.5 5.4-10.6 6.2-15.5 2.3l-25.7-21.7-115.1 162c-3.6 4.9-10.2 5.8-15.1 1.8l-83.3-69.5c-4.8-4-5.3-11.1-0.9-15.5l284.8-288.2c24.4 25.6 52.3 48.2 82.4 66.8zm-138.6 395.8c-5.8-2.2-8.4-8.9-5.8-14.2l168.8-368.3c31 15.9 64.7 27.9 99.7 34.5l-49.7 190.4c-1.3 5.7-7.9 9.3-13.7 7.1l-31.4-11.5-52.7 191.7c-1.8 5.7-8 9.3-13.8 7l-101.8-37.1zm337.5-340c19.9 0 39.4-1.4 58.4-4.5l18.6 195.7c0.5 6.2-4.4 11.5-10.6 11.5h-33.2l15.9 197.9c0.9 6.2-3.9 11.5-10.1 11.5h-108.6c-5.7 0-10.6-5.3-10.2-11.5l32.8-403.7c15.5 2.2 31 3.1 47 3.1zm174.5-728.3c-31-15.5-64.2-27.5-99.7-34.5l49.6-190.4c1.8-5.8 8-9.3 13.8-7.1l31.4 11.5 52.7-191.7c1.8-5.7 8-9.3 13.8-7.1l101.8 37.2c5.8 2.2 8.5 8.4 5.8 14.2zm391.6-207.2l-284.9 288.2c-23.9-25.7-51.3-48.2-81.9-66.8l111.6-162.1c3.6-4.8 10.7-6.2 15.5-2.2l25.7 21.7 115.2-162c3.5-4.9 10.6-5.8 15-1.8l83.3 69.5c4.9 4 4.9 11.1 0.5 15.5zm153.7 227.1l-365.9 173.6c-14.2-32.8-32.3-63.4-54.5-90.8l160.3-114.2c4.9-4 12-2.2 15.1 3.1l16.8 28.8 163.5-112.9c4.9-3.1 11.9-1.8 15 3.5l54.5 93.9c3.1 5.3 1.4 11.9-4.4 14.6zm58 146.5l18.6 106.7c0.9 6.2-3.1 11.5-9.3 12.4l-403.5 37.6c-1.8-36.3-8.9-70.8-19.9-103.6l189.6-52.2c5.7-1.8 11.9 2.2 12.8 8.4l5.8 32.8 192.2-50.1c5.8-1.3 12 2.3 12.8 8.5zm-18.6 391.3l-392-102.3c10.2-33.2 16-68.1 16.9-104.4l196.2 15.9c6.2 0.9 10.2 6.2 9.3 12.4l-5.8 32.8 198 18.6c6.2 0.8 10.2 6.1 9.3 12.3l-18.6 106.7c-0.9 6.2-7.1 9.8-12.8 8.5zm-104.1 243.9c-3.1 5.3-10.2 6.6-15.1 3.5l-333.5-230.2c21.3-27.9 38.5-58.9 51.4-92.1l178.9 81.9c5.8 2.7 8 9.3 4.9 14.6l-16.8 28.8 179.8 85c5.3 2.7 7.5 9.3 4.4 14.6zm-446.5-135.9c29.7-19 56.3-42.5 79.8-69l140.4 138.1c4.4 4.4 4.4 11.5-0.5 15.5l-25.7 21.2 139.6 141.3c4 4.4 4 11.5-0.9 15.4l-82.8 69.6c-4.5 3.9-11.6 3.1-15.1-1.8l-234.3-330.3zm-1.8 449.8c-5.7 2.2-11.9-1.3-13.7-7.1l-107.2-390.4c35-8 68.2-20.8 98.8-37.7l84.6 177.6c2.6 5.7 0 12.4-5.8 14.1l-31.4 11.5 82.8 180.7c2.6 5.7 0 11.9-5.8 14.1l-101.8 37.2z\"\r\n      />\r\n    </svg>\r\n  );\r\n};\r\n","import { useFormik } from 'formik';\r\nimport { useState } from 'react';\r\nimport { TextInput } from 'src/inputs/TextInput';\r\nimport * as yup from 'yup';\r\n\r\nimport MailOutline from '@mui/icons-material/MailOutline';\r\nimport Alert from '@mui/material/Alert';\r\nimport Box from '@mui/material/Box';\r\nimport Button from '@mui/material/Button';\r\nimport Link from '@mui/material/Link';\r\n\r\nimport { AuthTemplate } from './AuthTemplate';\r\n\r\ninterface AuthForgotPasswordProps {\r\n  onGoBack: () => void;\r\n  onContinue: (value: string) => Promise<void>;\r\n}\r\n\r\nconst AuthForgotPassword = ({\r\n  onGoBack,\r\n  onContinue\r\n}: AuthForgotPasswordProps): JSX.Element => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [showConfirmation, setShowConfirmation] = useState(false);\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      email: ''\r\n    },\r\n    validationSchema: yup.object({\r\n      email: yup.string().email().required()\r\n    }),\r\n    onSubmit: async ({ email }) => {\r\n      setLoading(true);\r\n\r\n      try {\r\n        await onContinue(email);\r\n        setShowConfirmation(true);\r\n      } catch (error) {\r\n        if (error instanceof Error) {\r\n          setError(error.message);\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    },\r\n    validateOnBlur: true,\r\n    validateOnChange: false\r\n  });\r\n\r\n  return (\r\n    <AuthTemplate\r\n      renderLogo={\r\n        showConfirmation ? (\r\n          <Box\r\n            sx={{\r\n              border: 3,\r\n              borderColor: 'success.main',\r\n              borderRadius: 50,\r\n              width: 60,\r\n              height: 60,\r\n              display: 'grid',\r\n              placeItems: 'center'\r\n            }}\r\n          >\r\n            <MailOutline color=\"success\" fontSize=\"large\" />\r\n          </Box>\r\n        ) : undefined\r\n      }\r\n      title={\r\n        showConfirmation\r\n          ? `Please check the email address ${formik.values.email} for instructions to reset your password.`\r\n          : 'Enter your email address and we will send you instructions to reset your password.'\r\n      }\r\n    >\r\n      {error ? (\r\n        <Alert sx={{ my: 1 }} severity=\"error\">\r\n          {error}\r\n        </Alert>\r\n      ) : null}{' '}\r\n      {showConfirmation ? (\r\n        <Button\r\n          onClick={() => formik.handleSubmit()}\r\n          color=\"success\"\r\n          variant=\"outlined\"\r\n          sx={{ marginTop: 1 }}\r\n        >\r\n          Resend email\r\n        </Button>\r\n      ) : (\r\n        <form onSubmit={formik.handleSubmit}>\r\n          <TextInput\r\n            id=\"email\"\r\n            placeholder=\"Email adress\"\r\n            size=\"medium\"\r\n            value={formik.values.email}\r\n            hasError={!!formik.errors.email}\r\n            description={formik.errors.email}\r\n            onBlur={formik.handleBlur}\r\n            onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n              formik.setFieldValue('email', e.target.value)\r\n            }\r\n          />\r\n\r\n          <Button\r\n            type=\"submit\"\r\n            disabled={loading}\r\n            variant=\"contained\"\r\n            sx={{ marginTop: 1, width: '100%' }}\r\n          >\r\n            Continue\r\n          </Button>\r\n        </form>\r\n      )}\r\n      <Link component=\"button\" marginTop={1} onClick={onGoBack}>\r\n        Go Back\r\n      </Link>\r\n    </AuthTemplate>\r\n  );\r\n};\r\n\r\nexport { AuthForgotPassword };\r\n","import { useFormik } from 'formik';\r\nimport { ReactElement, useState } from 'react';\r\nimport { TextInput } from 'src/inputs/TextInput';\r\nimport * as yup from 'yup';\r\n\r\nimport Alert from '@mui/material/Alert';\r\nimport Button from '@mui/material/Button';\r\n\r\nimport { AuthTemplate } from './AuthTemplate';\r\n\r\ninterface AuthResetPasswordProps {\r\n  callbackUrl: string;\r\n  onResetPassword: (\r\n    email: string,\r\n    token: string,\r\n    callbackUrl: string\r\n  ) => Promise<any>;\r\n  renderLogo?: ReactElement;\r\n  title: string;\r\n  token: string;\r\n}\r\n\r\nconst AuthResetPassword = ({\r\n  callbackUrl,\r\n  onResetPassword,\r\n  renderLogo,\r\n  title,\r\n  token\r\n}: AuthResetPasswordProps): JSX.Element => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      newPassword: '',\r\n      confirmPassword: ''\r\n    },\r\n    validationSchema: yup.object({\r\n      newPassword: yup.string().required('New password is a required field'),\r\n      confirmPassword: yup\r\n        .string()\r\n        .oneOf([yup.ref('newPassword'), undefined], 'Passwords must match')\r\n        .required('Confirm password is a required field')\r\n    }),\r\n    onSubmit: async ({ newPassword }) => {\r\n      setLoading(true);\r\n      setError('');\r\n\r\n      try {\r\n        await onResetPassword(newPassword, token, callbackUrl);\r\n      } catch (error) {\r\n        if (error instanceof Error) {\r\n          setError(error.message);\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    },\r\n    validateOnBlur: true\r\n  });\r\n\r\n  return (\r\n    <AuthTemplate renderLogo={renderLogo} title={title}>\r\n      {error ? (\r\n        <Alert sx={{ my: 1 }} severity=\"error\">\r\n          {error}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      <form onSubmit={formik.handleSubmit}>\r\n        <TextInput\r\n          id=\"newPassword\"\r\n          placeholder=\"New password\"\r\n          size=\"medium\"\r\n          value={formik.values.newPassword}\r\n          hasError={!!formik.errors.newPassword}\r\n          description={\r\n            formik.touched.newPassword ? formik.errors.newPassword : undefined\r\n          }\r\n          onBlur={formik.handleBlur}\r\n          onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n            formik.setFieldValue('newPassword', e.target.value)\r\n          }\r\n          type=\"password\"\r\n        />\r\n\r\n        <TextInput\r\n          id=\"confirmPassword\"\r\n          placeholder=\"Confirm password\"\r\n          size=\"medium\"\r\n          value={formik.values.confirmPassword}\r\n          hasError={!!formik.errors.confirmPassword}\r\n          description={\r\n            formik.touched.confirmPassword\r\n              ? formik.errors.confirmPassword\r\n              : undefined\r\n          }\r\n          onBlur={formik.handleBlur}\r\n          onChange={(e: React.ChangeEvent<HTMLInputElement>) =>\r\n            formik.setFieldValue('confirmPassword', e.target.value)\r\n          }\r\n          type=\"password\"\r\n        />\r\n\r\n        <Button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          variant=\"contained\"\r\n          sx={{ marginTop: 3, width: '100%' }}\r\n        >\r\n          Reset Password\r\n        </Button>\r\n      </form>\r\n    </AuthTemplate>\r\n  );\r\n};\r\n\r\nexport { AuthResetPassword };\r\n","import { useState } from 'react';\r\n\r\nimport MailOutline from '@mui/icons-material/MailOutline';\r\nimport Alert from '@mui/material/Alert';\r\nimport Box from '@mui/material/Box';\r\nimport Button from '@mui/material/Button';\r\nimport Link from '@mui/material/Link';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport { AuthTemplate } from './AuthTemplate';\r\n\r\ninterface AuthVerifyEmailProps {\r\n  email: string;\r\n  onGoBack: () => void;\r\n  onResend: (value: string) => Promise<void>;\r\n}\r\n\r\nconst AuthVerifyEmail = ({\r\n  email,\r\n  onGoBack,\r\n  onResend\r\n}: AuthVerifyEmailProps): JSX.Element => {\r\n  const [loading, setLoading] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [success, setSuccess] = useState('');\r\n\r\n  const onSubmit = async () => {\r\n    setLoading(true);\r\n\r\n    try {\r\n      await onResend(email);\r\n      setSuccess('Email sent successfully.');\r\n    } catch (error) {\r\n      if (error instanceof Error) {\r\n        setError(error.message);\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <AuthTemplate\r\n      renderLogo={\r\n        <>\r\n          <Box\r\n            sx={{\r\n              border: 3,\r\n              borderColor: 'success.main',\r\n              borderRadius: 50,\r\n              width: 60,\r\n              height: 60,\r\n              display: 'grid',\r\n              placeItems: 'center'\r\n            }}\r\n          >\r\n            <MailOutline color=\"success\" fontSize=\"large\" />\r\n          </Box>\r\n          <Typography fontSize=\"18px\" fontWeight={700} color=\"text.primary\">\r\n            {'Verify your email address'}\r\n          </Typography>\r\n        </>\r\n      }\r\n    >\r\n      {error ? (\r\n        <Alert sx={{ my: 1 }} severity=\"error\">\r\n          {error}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      {success ? (\r\n        <Alert sx={{ my: 1 }} severity=\"success\">\r\n          {success}\r\n        </Alert>\r\n      ) : null}\r\n\r\n      <Box display=\"flex\" flexDirection=\"column\" gap={3}>\r\n        <Box>\r\n          <Typography>\r\n            {\"You're almost there! We've sent an email to \"}\r\n          </Typography>\r\n          <Typography fontWeight=\"fontWeightMedium\" component=\"span\">\r\n            {email}\r\n          </Typography>\r\n        </Box>\r\n        <Typography>\r\n          Please click on the link in that email to complete your signup.\r\n        </Typography>\r\n\r\n        <Typography>{\"Can't find the email?\"}</Typography>\r\n      </Box>\r\n\r\n      <Button\r\n        onClick={onSubmit}\r\n        color=\"success\"\r\n        variant=\"outlined\"\r\n        sx={{ marginTop: 1 }}\r\n        disabled={loading}\r\n      >\r\n        Resend email\r\n      </Button>\r\n\r\n      <Link component=\"button\" marginTop={1} onClick={onGoBack}>\r\n        Go Back\r\n      </Link>\r\n    </AuthTemplate>\r\n  );\r\n};\r\n\r\nexport { AuthVerifyEmail };\r\n","import { BreakpointsOptions } from '@mui/material';\r\nimport createTheme from '@mui/material/styles/createTheme';\r\n\r\nimport { green, grey, primary, white } from './palette';\r\n\r\nconst typography = {\r\n  fontFamily: ['Inter', 'sans-serif'].join(',')\r\n};\r\n\r\nconst components = {\r\n  MuiButton: {\r\n    defaultProps: {\r\n      disableElevation: true,\r\n      disableRipple: true,\r\n      sx: {\r\n        textTransform: 'none'\r\n      }\r\n    }\r\n  },\r\n  MuiLink: {\r\n    defaultProps: {\r\n      fontWeight: 500\r\n    }\r\n  },\r\n  MuiFormHelperText: {\r\n    defaultProps: {\r\n      sx: {\r\n        m: 0,\r\n        fontWeight: 400,\r\n        color: grey[500]\r\n      }\r\n    }\r\n  },\r\n  MuiTooltip: {\r\n    styleOverrides: {\r\n      tooltip: {\r\n        backgroundColor: 'black'\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\nconst shape = {\r\n  borderRadius: 8\r\n};\r\n\r\nconst success = {\r\n  main: green[500],\r\n  contrastText: white\r\n};\r\nconst error = {\r\n  main: 'rgba(239, 65, 70, 1)',\r\n  contrastText: white\r\n};\r\n\r\nconst darkTheme = (fontFamily?: string, breakpoints?: BreakpointsOptions) =>\r\n  createTheme({\r\n    typography: fontFamily ? { fontFamily } : typography,\r\n    components,\r\n    shape,\r\n    breakpoints: breakpoints,\r\n    palette: {\r\n      mode: 'dark',\r\n      success,\r\n      error,\r\n      background: {\r\n        default: grey[850],\r\n        paper: grey[900]\r\n      },\r\n      primary: {\r\n        main: '#F80061',\r\n        dark: primary[800],\r\n        light: '#FFE7EB',\r\n        contrastText: white\r\n      },\r\n      secondary: {\r\n        main: '#9757D7',\r\n        dark: '#763FB8',\r\n        light: '#B87FE7',\r\n        contrastText: white\r\n      },\r\n      divider: grey[800],\r\n      text: {\r\n        primary: grey[200],\r\n        secondary: grey[400]\r\n      }\r\n    }\r\n  });\r\n\r\nconst lightTheme = (fontFamily?: string, breakpoints?: BreakpointsOptions) =>\r\n  createTheme({\r\n    typography: fontFamily ? { fontFamily } : typography,\r\n    components,\r\n    shape,\r\n    breakpoints: breakpoints,\r\n    palette: {\r\n      mode: 'light',\r\n      success,\r\n      error,\r\n      background: {\r\n        default: grey[50],\r\n        paper: white\r\n      },\r\n      primary: {\r\n        main: '#F80061',\r\n        dark: primary[800],\r\n        light: '#FFE7EB',\r\n        contrastText: white\r\n      },\r\n      secondary: {\r\n        main: '#9757D7',\r\n        dark: '#763FB8',\r\n        light: '#B87FE7',\r\n        contrastText: white\r\n      },\r\n      divider: grey[200],\r\n      text: {\r\n        primary: grey[900],\r\n        secondary: grey[700]\r\n      }\r\n    }\r\n  });\r\n\r\nconst makeTheme = (\r\n  variant: 'dark' | 'light',\r\n  fontFamily?: string,\r\n  breakpoints?: BreakpointsOptions\r\n) =>\r\n  variant === 'dark'\r\n    ? darkTheme(fontFamily, breakpoints)\r\n    : lightTheme(fontFamily, breakpoints);\r\n\r\nconst darkGreyButtonTheme = createTheme({\r\n  typography,\r\n  components,\r\n  shape,\r\n  palette: {\r\n    primary: {\r\n      main: grey[900]\r\n    }\r\n  }\r\n});\r\n\r\nconst lightGreyButtonTheme = createTheme({\r\n  typography,\r\n  components,\r\n  shape,\r\n  palette: {\r\n    primary: {\r\n      main: grey[200]\r\n    }\r\n  }\r\n});\r\n\r\n// Maybe we should not export dark and light theme button from the package\r\nexport { makeTheme, darkGreyButtonTheme, lightGreyButtonTheme };\r\n","import { darkGreyButtonTheme, lightGreyButtonTheme } from 'theme/theme';\r\n\r\nimport Button, { ButtonProps } from '@mui/material/Button';\r\nimport ThemeProvider from '@mui/material/styles/ThemeProvider';\r\nimport useTheme from '@mui/material/styles/useTheme';\r\n\r\nconst GreyButton = ({ sx, ...props }: ButtonProps) => {\r\n  const theme = useTheme();\r\n  const greyTheme =\r\n    theme.palette.mode === 'dark' ? darkGreyButtonTheme : lightGreyButtonTheme;\r\n\r\n  return (\r\n    <ThemeProvider theme={greyTheme}>\r\n      <Button\r\n        {...props}\r\n        disableElevation\r\n        disableRipple\r\n        sx={{\r\n          ...sx,\r\n          textTransform: 'none'\r\n        }}\r\n      />\r\n    </ThemeProvider>\r\n  );\r\n};\r\n\r\nexport { GreyButton };\r\n","import { grey } from 'theme/palette';\r\n\r\nimport Button, { ButtonProps } from '@mui/material/Button';\r\n\r\ninterface Props extends ButtonProps {\r\n  component?: any;\r\n  to?: any;\r\n}\r\n\r\nconst RegularButton = ({ children, ...props }: Props) => {\r\n  return (\r\n    <span>\r\n      <Button\r\n        sx={{\r\n          textTransform: 'none',\r\n          color: (theme) =>\r\n            theme.palette.mode === 'dark'\r\n              ? 'text.primary'\r\n              : theme.palette.primary.main,\r\n          background: (theme) =>\r\n            theme.palette.mode === 'dark'\r\n              ? grey[700]\r\n              : theme.palette.primary.light,\r\n          '&:hover': {\r\n            background: (theme) =>\r\n              theme.palette.mode === 'dark'\r\n                ? grey[700]\r\n                : theme.palette.primary.light\r\n          }\r\n        }}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </Button>\r\n    </span>\r\n  );\r\n};\r\n\r\nexport { RegularButton };\r\n","import Button, { ButtonProps } from '@mui/material/Button';\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\nfunction AccentButton({\r\n  children,\r\n  ...props\r\n}: ButtonProps & { target?: string }) {\r\n  const theme = useTheme();\r\n  return (\r\n    <span style={{ color: theme.palette.text.primary }}>\r\n      <Button\r\n        color={theme.palette.mode === 'dark' ? 'inherit' : 'primary'}\r\n        {...props}\r\n      >\r\n        {children}\r\n      </Button>\r\n    </span>\r\n  );\r\n}\r\n\r\nexport { AccentButton };\r\n","import { useCallback } from 'react';\r\n\r\nimport { useIsDarkMode } from './useIsDarkMode';\r\n\r\nconst darkColors = [\r\n  '#fb923c',\r\n  '#facc15',\r\n  '#34d399',\r\n  '#38bdf8',\r\n  '#818cf8',\r\n  '#c084fc',\r\n  '#f472b6',\r\n  '#0ea5e9'\r\n];\r\n\r\nconst lightColors = [\r\n  '#ea580c',\r\n  '#ca8a04',\r\n  '#059669',\r\n  '#0284c7',\r\n  '#4f46e5',\r\n  '#9333ea',\r\n  '#db2777',\r\n  '#2563eb'\r\n];\r\n\r\nconst hashCode = (str: string) => {\r\n  const arr = str.split('');\r\n  return arr.reduce(\r\n    (hashCode, currentVal) =>\r\n      (hashCode =\r\n        currentVal.charCodeAt(0) +\r\n        (hashCode << 6) +\r\n        (hashCode << 16) -\r\n        hashCode),\r\n    0\r\n  );\r\n};\r\n\r\nconst useColors = (inverted?: boolean) => {\r\n  const isDarkMode = useIsDarkMode();\r\n  let colors = isDarkMode ? darkColors : lightColors;\r\n\r\n  if (inverted) {\r\n    if (colors === darkColors) {\r\n      colors = lightColors;\r\n    } else {\r\n      colors = darkColors;\r\n    }\r\n  }\r\n  return colors;\r\n};\r\n\r\nconst useColorForName = (uiName: string) => {\r\n  const colors = useColors();\r\n\r\n  return useCallback(\r\n    (name: string, isUser?: boolean, isError?: boolean) => {\r\n      if (isError) {\r\n        return 'error.main';\r\n      }\r\n      if (name === uiName) {\r\n        return 'primary.main';\r\n      }\r\n      if (isUser) {\r\n        return 'text.primary';\r\n      }\r\n      const index = Math.abs(hashCode(name)) % colors.length;\r\n      return colors[index];\r\n    },\r\n    [uiName]\r\n  );\r\n};\r\n\r\nexport { useColorForName, useColors };\r\n","import useTheme from '@mui/material/styles/useTheme';\r\n\r\nconst useIsDarkMode = (): boolean => {\r\n  const theme = useTheme();\r\n\r\n  return theme.palette.mode === 'dark';\r\n};\r\n\r\nexport { useIsDarkMode };\r\n","import { useCallback } from 'react';\r\nimport {\r\n  DropzoneOptions,\r\n  FileRejection,\r\n  FileWithPath,\r\n  useDropzone\r\n} from 'react-dropzone';\r\n\r\nimport type { FileSpec } from 'client-types/';\r\n\r\ninterface useUploadProps {\r\n  onError?: (error: string) => void;\r\n  onResolved: (payloads: FileWithPath[]) => void;\r\n  options?: DropzoneOptions;\r\n  spec: FileSpec;\r\n}\r\n\r\nconst useUpload = ({ onError, onResolved, options, spec }: useUploadProps) => {\r\n  const onDrop: DropzoneOptions['onDrop'] = useCallback(\r\n    (acceptedFiles: FileWithPath[], fileRejections: FileRejection[]) => {\r\n      if (fileRejections.length > 0) {\r\n        onError && onError(fileRejections[0].errors[0].message);\r\n        return;\r\n      }\r\n\r\n      if (!acceptedFiles.length) return;\r\n      return onResolved(acceptedFiles);\r\n    },\r\n    [spec]\r\n  );\r\n\r\n  let dzAccept: Record<string, string[]> = {};\r\n  const accept = spec.accept;\r\n\r\n  if (Array.isArray(accept)) {\r\n    accept.forEach((a) => {\r\n      if (typeof a === 'string') {\r\n        dzAccept[a] = [];\r\n      }\r\n    });\r\n  } else if (typeof accept === 'object') {\r\n    dzAccept = accept;\r\n  }\r\n\r\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\r\n    onDrop,\r\n    maxFiles: spec.max_files || undefined,\r\n    accept: dzAccept,\r\n    maxSize: (spec.max_size_mb || 2) * 1000000,\r\n    ...options\r\n  });\r\n\r\n  return { getInputProps, getRootProps, isDragActive };\r\n};\r\n\r\nexport { useUpload };\r\n","const omit = <T extends Record<string, any>, K extends keyof T>(\r\n  object: T,\r\n  ...props: K[]\r\n): Omit<T, K> => {\r\n  const result = { ...object };\r\n  for (const prop of props) {\r\n    delete result[prop];\r\n  }\r\n  return result;\r\n};\r\n\r\nexport default omit;\r\n","import { grey } from 'theme/palette';\r\n\r\nimport Slider, { SliderProps as MSliderProps } from '@mui/material/Slider';\r\nimport styled from '@mui/material/styles/styled';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\nimport { InputStateHandler } from './InputStateHandler';\r\n\r\ntype SliderInputProps = IInput &\r\n  MSliderProps & {\r\n    setField?(field: string, value: number, shouldValidate?: boolean): void;\r\n  };\r\n\r\nconst SliderInput = ({\r\n  description,\r\n  hasError,\r\n  id,\r\n  label,\r\n  tooltip,\r\n  setField,\r\n  ...sliderProps\r\n}: SliderInputProps) => {\r\n  const onChange = (event: any) => {\r\n    const parsedValue = parseFloat(event.target.value);\r\n    const { min, max, onChange } = sliderProps;\r\n\r\n    if (max && parsedValue > max) setField && setField(id, max);\r\n    else if (min && parsedValue < min) setField && setField(id, min);\r\n    else onChange && onChange(event, parsedValue, 0);\r\n  };\r\n\r\n  return (\r\n    <InputStateHandler\r\n      description={description}\r\n      hasError={hasError}\r\n      id={id}\r\n      label={label}\r\n      tooltip={tooltip}\r\n      notificationsProps={{\r\n        count: sliderProps.value?.toString() || '0',\r\n        inputProps: {\r\n          id,\r\n          max: sliderProps.max,\r\n          min: sliderProps.min,\r\n          step: sliderProps.step || 1,\r\n          onChange\r\n        }\r\n      }}\r\n    >\r\n      <StyledSlider {...sliderProps} id={id} name={id} />\r\n    </InputStateHandler>\r\n  );\r\n};\r\n\r\nconst StyledSlider = styled(Slider)(({ theme }) => {\r\n  const isLightMode = theme.palette.mode === 'light';\r\n\r\n  return {\r\n    width: 'calc(100% - 18px)',\r\n    marginLeft: '8px',\r\n    color: grey[isLightMode ? 300 : 850],\r\n    height: 3,\r\n    '& .MuiSlider-track': {\r\n      border: 'none',\r\n      color: grey[500]\r\n    },\r\n    '& .MuiSlider-thumb': {\r\n      height: 15,\r\n      width: 15,\r\n      backgroundColor: isLightMode ? grey[600] : 'white',\r\n      border: `4px solid ${isLightMode ? grey[300] : grey[800]}`,\r\n      '&:focus, &:hover, &.Mui-active, &.Mui-focusVisible': {\r\n        boxShadow: 'inherit'\r\n      },\r\n      '&:before': {\r\n        display: 'none'\r\n      }\r\n    },\r\n    '& .MuiSlider-valueLabel': {\r\n      lineHeight: 1.2,\r\n      fontSize: 12,\r\n      background: 'unset',\r\n      padding: 0,\r\n      width: 32,\r\n      height: 32,\r\n      borderRadius: '50% 50% 50% 0',\r\n      backgroundColor: '#52af77',\r\n      transformOrigin: 'bottom left',\r\n      transform: 'translate(50%, -100%) rotate(-45deg) scale(0)',\r\n      '&:before': { display: 'none' },\r\n      '&.MuiSlider-valueLabelOpen': {\r\n        transform: 'translate(50%, -100%) rotate(-45deg) scale(1)'\r\n      },\r\n      '& > *': {\r\n        transform: 'rotate(45deg)'\r\n      }\r\n    }\r\n  };\r\n});\r\n\r\nexport { SliderInput };\r\nexport type { SliderInputProps };\r\n","import { green } from 'theme/palette';\r\n\r\nimport MSwitch, { SwitchProps as MSwitchProps } from '@mui/material/Switch';\r\nimport styled from '@mui/material/styles/styled';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\nimport { InputStateHandler } from './InputStateHandler';\r\n\r\ntype SwitchInputProps = IInput & {\r\n  checked: boolean;\r\n  inputProps?: React.InputHTMLAttributes<HTMLInputElement>;\r\n  onChange: (\r\n    event?: React.ChangeEvent<HTMLInputElement>,\r\n    checked?: boolean\r\n  ) => void;\r\n};\r\n\r\nconst SwitchInput = (props: SwitchInputProps): JSX.Element => {\r\n  const {\r\n    checked,\r\n    description,\r\n    disabled,\r\n    hasError,\r\n    id,\r\n    inputProps,\r\n    label,\r\n    onChange,\r\n    tooltip\r\n  } = props;\r\n\r\n  return (\r\n    <InputStateHandler\r\n      description={description}\r\n      hasError={hasError}\r\n      id={id}\r\n      label={label}\r\n      tooltip={tooltip}\r\n    >\r\n      <StyledSwitchInput\r\n        name={id}\r\n        disabled={disabled}\r\n        edge=\"end\"\r\n        onChange={onChange}\r\n        checked={checked}\r\n        inputProps={inputProps}\r\n      />\r\n    </InputStateHandler>\r\n  );\r\n};\r\n\r\nconst StyledSwitchInput = styled((props: MSwitchProps) => (\r\n  <MSwitch focusVisibleClassName=\".Mui-focusVisible\" disableRipple {...props} />\r\n))(({ theme }) => {\r\n  const isDarkMode = theme.palette.mode === 'dark';\r\n\r\n  return {\r\n    width: 40,\r\n    height: 24,\r\n    padding: 0,\r\n    '& .MuiSwitch-switchBase': {\r\n      margin: 0,\r\n      padding: '4px',\r\n      transitionDuration: '300ms',\r\n      '&.Mui-checked': {\r\n        transform: 'translateX(16px)',\r\n        color: '#fff',\r\n        '& + .MuiSwitch-track': {\r\n          backgroundColor: green[500],\r\n          opacity: 1,\r\n          border: 0\r\n        },\r\n        '&.Mui-disabled + .MuiSwitch-track': {\r\n          opacity: 0.5\r\n        }\r\n      },\r\n      '&.Mui-disabled .MuiSwitch-thumb': {\r\n        color: isDarkMode ? theme.palette.grey[600] : theme.palette.grey[100]\r\n      },\r\n      '&.Mui-disabled + .MuiSwitch-track': {\r\n        opacity: isDarkMode ? 0.3 : 0.7\r\n      }\r\n    },\r\n    '& .MuiSwitch-thumb': {\r\n      boxSizing: 'border-box',\r\n      width: 16,\r\n      height: 16,\r\n      boxShadow: 'unset'\r\n    },\r\n    '& .MuiSwitch-track': {\r\n      borderRadius: 26 / 2,\r\n      backgroundColor: theme.palette.grey[400],\r\n      opacity: 1,\r\n      transition: theme.transitions.create(['background-color'], {\r\n        duration: 500\r\n      })\r\n    }\r\n  };\r\n});\r\n\r\nexport { SwitchInput };\r\nexport type { SwitchInputProps };\r\n","import { MuiChipsInput } from 'mui-chips-input';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\nimport { InputStateHandler } from './InputStateHandler';\r\n\r\ntype TagsInputProps = {\r\n  placeholder?: string;\r\n  value?: string[];\r\n  setField?(field: string, value: string[], shouldValidate?: boolean): void;\r\n} & IInput &\r\n  Omit<React.InputHTMLAttributes<HTMLInputElement>, 'size' | 'color'>;\r\n\r\nconst TagsInput = ({\r\n  description,\r\n  hasError,\r\n  id,\r\n  label,\r\n  size = 'small',\r\n  tooltip,\r\n  setField,\r\n  ...rest\r\n}: TagsInputProps): JSX.Element => (\r\n  <InputStateHandler\r\n    description={description}\r\n    hasError={hasError}\r\n    id={id}\r\n    label={label}\r\n    tooltip={tooltip}\r\n  >\r\n    <MuiChipsInput\r\n      {...rest}\r\n      sx={{ my: 0.5 }}\r\n      size={size}\r\n      onChange={(value: string[]) => setField?.(id, value, false)}\r\n      inputProps={{\r\n        id: id,\r\n        name: id\r\n      }}\r\n    />\r\n  </InputStateHandler>\r\n);\r\n\r\nexport { TagsInput };\r\nexport type { TagsInputProps };\r\n","import { InputStateHandler } from 'src/inputs/InputStateHandler';\r\nimport { grey, primary } from 'theme/index';\r\n\r\nimport KeyboardArrowDown from '@mui/icons-material/KeyboardArrowDown';\r\nimport { Stack, type SxProps } from '@mui/material';\r\nimport MSelect, { SelectChangeEvent, SelectProps } from '@mui/material/Select';\r\n\r\nimport { useIsDarkMode } from 'hooks/useIsDarkMode';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\nimport { MenuItem } from './MenuItem';\r\n\r\ntype SelectItem = {\r\n  label: string;\r\n  icon?: JSX.Element;\r\n  notificationCount?: number;\r\n  value: string | number;\r\n};\r\n\r\ntype SelectInputProps = IInput &\r\n  Omit<SelectProps<string>, 'value' | 'onChange'> & {\r\n    children?: React.ReactNode;\r\n    items?: SelectItem[];\r\n    name?: string;\r\n    onChange: (e: SelectChangeEvent) => void;\r\n    placeholder?: string;\r\n    renderLabel?: () => string;\r\n    value?: string | number;\r\n    iconSx?: SxProps;\r\n  };\r\n\r\nconst SelectInput = ({\r\n  children,\r\n  description,\r\n  disabled = false,\r\n  hasError,\r\n  id,\r\n  items,\r\n  label,\r\n  name,\r\n  onChange,\r\n  size = 'small',\r\n  tooltip,\r\n  value,\r\n  placeholder = 'Select',\r\n  renderLabel,\r\n  onClose,\r\n  sx,\r\n  iconSx,\r\n  ...rest\r\n}: SelectInputProps): JSX.Element => {\r\n  const isDarkMode = useIsDarkMode();\r\n\r\n  return (\r\n    <InputStateHandler\r\n      id={id}\r\n      hasError={hasError}\r\n      description={description}\r\n      label={label}\r\n      tooltip={tooltip}\r\n      sx={sx}\r\n    >\r\n      <MSelect\r\n        {...rest}\r\n        size={size}\r\n        onClose={onClose}\r\n        labelId={id}\r\n        value={value?.toString()}\r\n        onChange={onChange}\r\n        disabled={disabled}\r\n        displayEmpty\r\n        renderValue={() => {\r\n          const item = items?.find((item) => item.value === value);\r\n          if (!value || value === '') return placeholder;\r\n          return (\r\n            (renderLabel && renderLabel()) || (\r\n              <Stack direction=\"row\" alignItems=\"center\" spacing={1}>\r\n                {item?.icon}\r\n                <span>{item?.label}</span>\r\n              </Stack>\r\n            )\r\n          );\r\n        }}\r\n        sx={{\r\n          backgroundColor: (theme) => theme.palette.background.paper,\r\n          borderRadius: 1,\r\n          '&.MuiOutlinedInput-root': {\r\n            '& fieldset': {\r\n              border: (theme) => `1px solid ${theme.palette.divider}`\r\n            }\r\n          }\r\n        }}\r\n        inputProps={{\r\n          id: id,\r\n          name: name || id,\r\n          sx: {\r\n            color: 'text.primary',\r\n            fontSize: '14px',\r\n            fontWeight: 400\r\n          }\r\n        }}\r\n        MenuProps={{\r\n          PaperProps: {\r\n            sx: {\r\n              border: (theme: any) => `1px solid ${theme.palette.divider}`,\r\n              boxShadow: (theme: any) =>\r\n                theme.palette.mode === 'light'\r\n                  ? '0px 2px 4px 0px #0000000D'\r\n                  : '0px 10px 10px 0px #0000000D',\r\n              '&& .Mui-selected, .Mui-selected.Mui-selected:hover': {\r\n                backgroundColor: isDarkMode ? grey[800] : primary[50]\r\n              }\r\n            }\r\n          },\r\n          MenuListProps: {\r\n            sx: { backgroundColor: isDarkMode ? grey[900] : '' }\r\n          }\r\n        }}\r\n        IconComponent={(props) => (\r\n          <KeyboardArrowDown\r\n            {...props}\r\n            fontSize=\"16px\"\r\n            sx={{\r\n              px: '9px',\r\n              color: !disabled\r\n                ? `${isDarkMode ? grey[300] : grey[600]} !important`\r\n                : '',\r\n              ...iconSx\r\n            }}\r\n          />\r\n        )}\r\n      >\r\n        {children ||\r\n          items?.map((item) => (\r\n            <MenuItem\r\n              isDarkMode={isDarkMode}\r\n              item={item}\r\n              selected={item.value === value}\r\n              key={item.value}\r\n              value={item.value}\r\n            />\r\n          ))}\r\n      </MSelect>\r\n    </InputStateHandler>\r\n  );\r\n};\r\n\r\nexport { SelectInput };\r\nexport type { SelectItem, SelectInputProps };\r\n","import { NotificationCount } from 'src/NotificationCount';\r\nimport { grey, primary } from 'theme/index';\r\n\r\nimport MMenuItem from '@mui/material/MenuItem';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport { SelectItem } from './SelectInput';\r\n\r\ntype MenuItemProps = {\r\n  isDarkMode: boolean;\r\n  item: SelectItem;\r\n  selected: boolean;\r\n  value: string | number;\r\n};\r\n\r\nconst MenuItem = ({\r\n  item,\r\n  value,\r\n  selected,\r\n  isDarkMode,\r\n  icon,\r\n  ...props\r\n}: MenuItemProps & { icon?: JSX.Element }) => (\r\n  <MMenuItem\r\n    {...props}\r\n    key={value}\r\n    sx={{\r\n      display: 'flex',\r\n      justifyContent: 'space-between',\r\n      fontWeight: 500,\r\n      fontSize: '14px',\r\n      color: (isDarkMode && grey[400]) || (selected ? primary[500] : grey[700]),\r\n      '&:hover': {\r\n        backgroundColor: isDarkMode ? grey[800] : primary[50],\r\n        color: isDarkMode ? grey[400] : primary[500],\r\n        '& .notification-count': {\r\n          backgroundColor: isDarkMode ? grey[850] : primary[100],\r\n          color: isDarkMode ? grey[400] : primary[500]\r\n        }\r\n      }\r\n    }}\r\n  >\r\n    <Stack direction=\"row\" alignItems=\"center\" spacing={1}>\r\n      {item.icon ? item.icon : null}\r\n      <span>{item.value}</span>\r\n    </Stack>\r\n    {item.notificationCount ? (\r\n      <NotificationCount count={item.notificationCount} />\r\n    ) : null}\r\n  </MMenuItem>\r\n);\r\n\r\nexport { MenuItem };\r\n","import omit from 'utils/omit';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\nimport { SliderInput, SliderInputProps } from './SliderInput';\r\nimport { SwitchInput, SwitchInputProps } from './SwitchInput';\r\nimport { TagsInput, TagsInputProps } from './TagsInput';\r\nimport { TextInput, TextInputProps } from './TextInput';\r\nimport { SelectInput, SelectInputProps } from './selects/SelectInput';\r\n\r\ntype TFormInputValue = string | number | boolean | string[] | undefined;\r\n\r\ninterface IFormInput<T, V extends TFormInputValue> extends IInput {\r\n  type: T;\r\n  value?: V;\r\n  initial?: V;\r\n  setField?(field: string, value: V, shouldValidate?: boolean): void;\r\n}\r\n\r\ntype TFormInput =\r\n  | (Omit<SwitchInputProps, 'checked'> & IFormInput<'switch', boolean>)\r\n  | (Omit<SliderInputProps, 'value'> & IFormInput<'slider', number>)\r\n  | (Omit<TagsInputProps, 'value'> & IFormInput<'tags', string[]>)\r\n  | (Omit<SelectInputProps, 'value'> & IFormInput<'select', string>)\r\n  | (Omit<TextInputProps, 'value'> & IFormInput<'textinput', string>)\r\n  | (Omit<TextInputProps, 'value'> & IFormInput<'numberinput', number>);\r\n\r\nconst FormInput = ({ element }: { element: TFormInput }): JSX.Element => {\r\n  switch (element?.type) {\r\n    case 'select':\r\n      // We omit the 'setField' prop to avoid React warnings and ensure it's available for <Tags/>.\r\n      return (\r\n        <SelectInput\r\n          {...omit(element, 'setField')}\r\n          value={element.value ?? ''}\r\n        />\r\n      );\r\n    case 'slider':\r\n      return <SliderInput {...element} value={element.value ?? 0} />;\r\n    case 'tags':\r\n      return <TagsInput {...element} value={element.value ?? []} />;\r\n    case 'switch':\r\n      return (\r\n        <SwitchInput\r\n          {...omit(element, 'setField')}\r\n          checked={!!element.value}\r\n          inputProps={{\r\n            id: element.id,\r\n            name: element.id\r\n          }}\r\n        />\r\n      );\r\n    case 'textinput':\r\n      return (\r\n        <TextInput {...omit(element, 'setField')} value={element.value ?? ''} />\r\n      );\r\n    case 'numberinput':\r\n      return (\r\n        <TextInput\r\n          {...omit(element, 'setField')}\r\n          type=\"number\"\r\n          value={element.value?.toString() ?? '0'}\r\n        />\r\n      );\r\n    default:\r\n      // If the element type is not recognized, we indicate an unimplemented type.\r\n      // This code path should not normally occur and serves as a fallback.\r\n      element satisfies never;\r\n      return <></>;\r\n  }\r\n};\r\n\r\nexport { FormInput };\r\nexport type { IFormInput, TFormInput, TFormInputValue };\r\n","import ListSubheader from '@mui/material/ListSubheader';\r\n\r\nimport { useIsDarkMode } from 'hooks/useIsDarkMode';\r\n\r\nimport { MenuItem } from './MenuItem';\r\nimport { SelectInput, SelectInputProps, SelectItem } from './SelectInput';\r\n\r\ntype CategoryItem = {\r\n  header: string;\r\n  items: SelectItem[];\r\n};\r\n\r\ntype SelectCategoryProps = {\r\n  items: CategoryItem[];\r\n} & Omit<SelectInputProps, 'items'>;\r\n\r\nconst SelectCategoryInput = ({\r\n  items,\r\n  value,\r\n  ...rest\r\n}: SelectCategoryProps): JSX.Element => {\r\n  const isDarkMode = useIsDarkMode();\r\n\r\n  const renderCategoryItem = (categoryItem: CategoryItem) => {\r\n    const header = <ListSubheader>{categoryItem.header}</ListSubheader>;\r\n    const items = categoryItem.items.map((item) => (\r\n      <MenuItem\r\n        isDarkMode={isDarkMode}\r\n        item={item}\r\n        selected={item.value === value}\r\n        value={item.value}\r\n      />\r\n    ));\r\n\r\n    return [header, ...items];\r\n  };\r\n\r\n  const renderLabel = () => {\r\n    let label: string | undefined = undefined;\r\n\r\n    for (const item of items) {\r\n      const foundItem = item.items.find((el) => el.value === value);\r\n      if (foundItem) {\r\n        label = foundItem.label;\r\n        break;\r\n      }\r\n    }\r\n\r\n    return label || '';\r\n  };\r\n\r\n  return (\r\n    <SelectInput value={value} renderLabel={renderLabel} {...rest}>\r\n      {items.map(renderCategoryItem)}\r\n    </SelectInput>\r\n  );\r\n};\r\n\r\nexport { SelectCategoryInput };\r\n","import { useIsDarkMode } from 'hooks';\r\nimport React from 'react';\r\nimport { InputStateHandler } from 'src/inputs';\r\nimport { grey } from 'theme';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Tab from '@mui/material/Tab';\r\nimport Tabs from '@mui/material/Tabs';\r\n\r\nimport { IInput } from 'src/types/Input';\r\n\r\ninterface ToggleProps extends IInput {\r\n  items: string[];\r\n  onChange: (newValue: string) => void;\r\n  value: string;\r\n}\r\n\r\nconst Toggle = (props: ToggleProps): JSX.Element => {\r\n  const { id, items, label, onChange, value, disabled } = props;\r\n\r\n  const isDarkMode = useIsDarkMode();\r\n\r\n  return (\r\n    <InputStateHandler\r\n      id={id}\r\n      label={label}\r\n      sx={{\r\n        width: 'fit-content'\r\n      }}\r\n    >\r\n      <Box\r\n        sx={{\r\n          border: (theme) => `1px solid ${theme.palette.divider}`,\r\n          backgroundColor: (theme) => theme.palette.background.paper,\r\n          borderRadius: 1\r\n        }}\r\n      >\r\n        <Tabs\r\n          value={items.findIndex((item) => item === value)}\r\n          onChange={(event: React.SyntheticEvent, newValue: number) =>\r\n            onChange(items[newValue])\r\n          }\r\n          sx={{\r\n            minHeight: '39px !important',\r\n            '& .MuiButtonBase-root': {\r\n              textTransform: 'none',\r\n              zIndex: 1,\r\n              color: grey[isDarkMode ? 600 : 500],\r\n              fontSize: '14px',\r\n              fontWeight: 500,\r\n              padding: 0,\r\n              minHeight: '39px !important',\r\n              width: '125px'\r\n            },\r\n            '& .Mui-selected': {\r\n              color: 'white !important'\r\n            },\r\n            '& .MuiTabs-indicator': {\r\n              background: (theme) =>\r\n                isDarkMode ? theme.palette.divider : theme.palette.primary.main,\r\n              height: '100%',\r\n              borderRadius: '5px'\r\n            }\r\n          }}\r\n        >\r\n          {items.map((item) => (\r\n            <Tab\r\n              disabled={disabled}\r\n              key={`tab-${item}`}\r\n              className={`tab-${item}`}\r\n              disableRipple\r\n              label={item}\r\n            />\r\n          ))}\r\n        </Tabs>\r\n      </Box>\r\n    </InputStateHandler>\r\n  );\r\n};\r\n\r\nexport { Toggle };\r\n","import { grey } from 'theme/palette';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport useTheme from '@mui/material/styles/useTheme';\r\n\r\nimport { type IAudioElement } from 'client-types/';\r\n\r\nconst AudioElement = ({ element }: { element: IAudioElement }) => {\r\n  const theme = useTheme();\r\n\r\n  if (!element.url) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Box className={`${element.display}-audio`}>\r\n      <Box\r\n        sx={{\r\n          fontSize: '14px',\r\n          lineHeight: 1.72,\r\n          color: theme.palette.mode === 'dark' ? grey[300] : grey[700],\r\n          marginBottom: theme.spacing(0.5)\r\n        }}\r\n      >\r\n        {element.name}\r\n      </Box>\r\n      <audio controls src={element.url}></audio>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport { AudioElement };\r\n","import Avatar from '@mui/material/Avatar';\r\n\r\nimport { type IAvatarElement } from 'client-types/';\r\n\r\ninterface Props {\r\n  author: string;\r\n  bgColor?: string;\r\n  element?: IAvatarElement;\r\n}\r\n\r\nconst AvatarElement = ({ element, author, bgColor }: Props) => {\r\n  let avatar: JSX.Element;\r\n  const sx = {\r\n    width: 26,\r\n    height: 26,\r\n    fontSize: '0.75rem',\r\n    mt: '-2px',\r\n    bgcolor: element?.url ? 'transparent' : bgColor\r\n  };\r\n  if (element?.url) {\r\n    avatar = <Avatar sx={sx} src={element?.url} />;\r\n  } else {\r\n    avatar = <Avatar sx={sx}>{author[0]?.toUpperCase()}</Avatar>;\r\n  }\r\n  return <span className={`message-avatar`}>{avatar}</span>;\r\n};\r\n\r\nexport { AvatarElement };\r\n","import { DefaultExtensionType, FileIcon, defaultStyles } from 'react-file-icon';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\ninterface Props {\r\n  name: string;\r\n  mime: string;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nconst Attachment = ({ name, mime, children }: Props) => {\r\n  const extension = (\r\n    mime ? mime.split('/').pop() : 'txt'\r\n  ) as DefaultExtensionType;\r\n\r\n  return (\r\n    <Box\r\n      position=\"relative\"\r\n      sx={(theme) => ({\r\n        height: 50,\r\n        [theme.breakpoints.down('sm')]: {\r\n          height: 36\r\n        }\r\n      })}\r\n    >\r\n      {children}\r\n      <Stack\r\n        sx={(theme) => ({\r\n          height: '100%',\r\n          flexDirection: 'row',\r\n          alignItems: 'center',\r\n          gap: 1.2,\r\n          borderRadius: 1,\r\n          px: 1.2,\r\n          border: (theme) => `1px solid ${theme.palette.primary.main}`,\r\n          color: (theme) =>\r\n            theme.palette.mode === 'light'\r\n              ? theme.palette.primary.main\r\n              : theme.palette.text.primary,\r\n          background: (theme) =>\r\n            theme.palette.mode === 'light'\r\n              ? theme.palette.primary.light\r\n              : theme.palette.primary.dark,\r\n          width: 160,\r\n          [theme.breakpoints.down('sm')]: {\r\n            width: 'fit-content',\r\n            maxWidth: 120\r\n          }\r\n        })}\r\n      >\r\n        <Box\r\n          sx={(theme) => ({\r\n            width: '2rem',\r\n            [theme.breakpoints.down('sm')]: {\r\n              width: '1.25rem'\r\n            }\r\n          })}\r\n        >\r\n          <FileIcon {...defaultStyles[extension]} extension={extension} />\r\n        </Box>\r\n        <Typography\r\n          sx={{\r\n            textOverflow: 'ellipsis',\r\n            overflow: 'hidden',\r\n            whiteSpace: 'nowrap',\r\n            fontWeight: 500,\r\n            fontSize: '0.8rem',\r\n            width: '70%'\r\n          }}\r\n        >\r\n          {name}\r\n        </Typography>\r\n      </Stack>\r\n    </Box>\r\n  );\r\n};\r\nexport { Attachment };\r\n","import { Attachment } from 'src/Attachment';\r\n\r\nimport Link from '@mui/material/Link';\r\n\r\nimport { type IFileElement } from 'client-types/';\r\n\r\nconst FileElement = ({ element }: { element: IFileElement }) => {\r\n  if (!element.url) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Link\r\n      className={`${element.display}-file`}\r\n      download={element.name}\r\n      href={element.url}\r\n      target=\"_blank\"\r\n      sx={{\r\n        textDecoration: 'none'\r\n      }}\r\n    >\r\n      <Attachment name={element.name} mime={element.mime!} />\r\n    </Link>\r\n  );\r\n};\r\n\r\nexport { FileElement };\r\n","import { useState } from 'react';\r\n\r\nimport Skeleton from '@mui/material/Skeleton';\r\n\r\nimport { type IImageElement } from 'client-types/';\r\n\r\nimport { FrameElement } from './Frame';\r\n\r\ninterface Props {\r\n  element: IImageElement;\r\n}\r\n\r\nconst handleImageClick = (name: string, src: string) => {\r\n  const link = document.createElement('a');\r\n  link.href = src;\r\n  link.target = '_blank';\r\n  link.download = name;\r\n  link.style.display = 'none';\r\n  document.body.appendChild(link);\r\n  link.click();\r\n  document.body.removeChild(link);\r\n};\r\n\r\nconst ImageElement = ({ element }: Props) => {\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  if (!element.url) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <FrameElement>\r\n      {loading && <Skeleton variant=\"rectangular\" width=\"100%\" height={200} />}\r\n      <img\r\n        className={`${element.display}-image`}\r\n        src={element.url}\r\n        onLoad={() => setLoading(false)}\r\n        onClick={() => {\r\n          if (element.display === 'inline') {\r\n            const name = `${element.name}.png`;\r\n            handleImageClick(name, element.url!);\r\n          }\r\n        }}\r\n        style={{\r\n          objectFit: 'cover',\r\n          maxWidth: '100%',\r\n          margin: 'auto',\r\n          height: 'auto',\r\n          display: 'block',\r\n          cursor: element.display === 'inline' ? 'pointer' : 'default'\r\n        }}\r\n        alt={element.name}\r\n        loading=\"lazy\"\r\n      />\r\n    </FrameElement>\r\n  );\r\n};\r\n\r\nexport { ImageElement };\r\n","import { grey } from 'theme/palette';\r\n\r\nimport Box from '@mui/material/Box';\r\n\r\nconst FrameElement = ({ children }: { children: React.ReactNode }) => (\r\n  <Box\r\n    sx={{\r\n      p: 1,\r\n      boxSizing: 'border-box',\r\n      bgcolor: (theme) =>\r\n        theme.palette.mode === 'light' ? grey[200] : grey[900],\r\n      borderRadius: '4px',\r\n      display: 'flex'\r\n    }}\r\n  >\r\n    {children}\r\n  </Box>\r\n);\r\n\r\nexport { FrameElement };\r\n","import { type IPdfElement } from 'client-types/';\r\n\r\ninterface Props {\r\n  element: IPdfElement;\r\n}\r\n\r\nconst PDFElement = ({ element }: Props) => {\r\n  if (!element.url) {\r\n    return null;\r\n  }\r\n  const url = element.page\r\n    ? `${element.url}#page=${element.page}`\r\n    : element.url;\r\n  return (\r\n    <iframe\r\n      className={`${element.display}-pdf`}\r\n      src={url}\r\n      style={{ border: 'none' }}\r\n      width=\"100%\"\r\n      height=\"100%\"\r\n    ></iframe>\r\n  );\r\n};\r\n\r\nexport { PDFElement };\r\n","import { Suspense, lazy } from 'react';\r\nimport { ErrorBoundary } from 'src/ErrorBoundary';\r\n\r\nimport { useFetch } from 'hooks/useFetch';\r\n\r\nimport { type IPlotlyElement } from 'client-types/';\r\n\r\nconst Plot = lazy(() => import('react-plotly.js'));\r\n\r\ninterface Props {\r\n  element: IPlotlyElement;\r\n}\r\n\r\nconst _PlotlyElement = ({ element }: Props) => {\r\n  const { data, error, isLoading } = useFetch(element.url || null);\r\n\r\n  if (isLoading) {\r\n    return <div>Loading...</div>;\r\n  } else if (error) {\r\n    return <div>An error occured</div>;\r\n  }\r\n\r\n  let state;\r\n\r\n  if (data) {\r\n    state = data;\r\n  } else {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Suspense fallback={<div>Loading...</div>}>\r\n      <Plot\r\n        className={`${element.display}-plotly`}\r\n        data={state.data}\r\n        layout={state.layout}\r\n        frames={state.frames}\r\n        config={state.config}\r\n        style={{ width: '100%', height: '100%' }}\r\n        useResizeHandler={true}\r\n      />\r\n    </Suspense>\r\n  );\r\n};\r\n\r\nconst PlotlyElement = (props: Props) => {\r\n  return (\r\n    <ErrorBoundary prefix=\"Failed to load chart.\">\r\n      <_PlotlyElement {...props} />\r\n    </ErrorBoundary>\r\n  );\r\n};\r\n\r\nexport { PlotlyElement };\r\n","import { Component, ErrorInfo, ReactNode } from 'react';\r\n\r\nimport Alert from '@mui/material/Alert';\r\nimport Box from '@mui/material/Box';\r\n\r\ninterface Props {\r\n  prefix?: string;\r\n  children?: ReactNode;\r\n}\r\n\r\ninterface State {\r\n  hasError: boolean;\r\n  error?: string;\r\n}\r\n\r\nclass ErrorBoundary extends Component<Props, State> {\r\n  public state: State = {\r\n    hasError: false,\r\n    error: undefined\r\n  };\r\n\r\n  public static getDerivedStateFromError(err: Error): State {\r\n    // Update state so the next render will show the fallback UI.\r\n    return { hasError: true, error: err.message };\r\n  }\r\n\r\n  public componentDidCatch(error: Error, errorInfo: ErrorInfo) {\r\n    console.error('Uncaught error:', error, errorInfo);\r\n  }\r\n\r\n  public render() {\r\n    if (this.state.hasError) {\r\n      const msg = this.props.prefix\r\n        ? `${this.props.prefix}: ${this.state.error}`\r\n        : this.state.error;\r\n      return (\r\n        <Box flexGrow={1}>\r\n          <Alert severity=\"error\">{msg}</Alert>\r\n        </Box>\r\n      );\r\n    }\r\n\r\n    return this.props.children;\r\n  }\r\n}\r\n\r\nexport { ErrorBoundary };\r\n","import useSWR, { SWRResponse } from 'swr';\r\n\r\nconst fetcher = async (url: string): Promise<any> => {\r\n  const response = await fetch(url);\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Network response was not ok');\r\n  }\r\n\r\n  // Check if the response is JSON\r\n  const contentType = response.headers.get('content-type');\r\n  if (contentType && contentType.includes('application/json')) {\r\n    return response.json();\r\n  } else {\r\n    // If it's not JSON, return the raw response body\r\n    return response.text();\r\n  }\r\n};\r\n\r\nconst useFetch = (endpoint: string | null): SWRResponse<any, Error> => {\r\n  return useSWR<any, Error>(endpoint, fetcher);\r\n};\r\nexport { useFetch };\r\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\r\nimport { useMemo } from 'react';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport { PluggableList } from 'react-markdown/lib';\r\nimport rehypeKatex from 'rehype-katex';\r\nimport rehypeRaw from 'rehype-raw';\r\nimport remarkGfm from 'remark-gfm';\r\nimport remarkMath from 'remark-math';\r\nimport { Code } from 'src/Code';\r\n\r\nimport Link from '@mui/material/Link';\r\nimport Paper from '@mui/material/Paper';\r\nimport Table from '@mui/material/Table';\r\nimport TableBody from '@mui/material/TableBody';\r\nimport TableCell from '@mui/material/TableCell';\r\nimport TableContainer from '@mui/material/TableContainer';\r\nimport TableHead from '@mui/material/TableHead';\r\nimport TableRow from '@mui/material/TableRow';\r\n\r\nimport { ElementRef } from 'src/messages/components/ElementRef';\r\n\r\nimport type { IMessageElement } from 'client-types/';\r\n\r\nimport { InlineCode } from './InlineCode';\r\n\r\ninterface Props {\r\n  allowHtml?: boolean;\r\n  latex?: boolean;\r\n  refElements?: IMessageElement[];\r\n  children: string;\r\n}\r\n\r\nfunction Markdown({ refElements, allowHtml, latex, children }: Props) {\r\n  const rehypePlugins = useMemo(() => {\r\n    let rehypePlugins: PluggableList = [];\r\n    if (allowHtml) {\r\n      rehypePlugins = [rehypeRaw as any, ...rehypePlugins];\r\n    }\r\n    if (latex) {\r\n      rehypePlugins = [rehypeKatex as any, ...rehypePlugins];\r\n    }\r\n    return rehypePlugins;\r\n  }, [allowHtml, latex]);\r\n\r\n  const remarkPlugins = useMemo(() => {\r\n    let remarkPlugins: PluggableList = [remarkGfm as any];\r\n\r\n    if (latex) {\r\n      remarkPlugins = [remarkMath as any, ...remarkPlugins];\r\n    }\r\n    return remarkPlugins;\r\n  }, [latex]);\r\n\r\n  return (\r\n    <ReactMarkdown\r\n      remarkPlugins={remarkPlugins}\r\n      rehypePlugins={rehypePlugins}\r\n      className=\"markdown-body\"\r\n      components={{\r\n        a({ children, ...props }) {\r\n          const name = children as string;\r\n          const element = refElements?.find((e) => e.name === name);\r\n\r\n          if (element) {\r\n            return <ElementRef element={element} />;\r\n          } else {\r\n            return (\r\n              // @ts-ignore\r\n              <Link {...props} target=\"_blank\">\r\n                {children}\r\n              </Link>\r\n            );\r\n          }\r\n        },\r\n        code({ ...props }) {\r\n          return <InlineCode {...props} />;\r\n        },\r\n        pre({ ...props }) {\r\n          return <Code {...props} />;\r\n        },\r\n        table({ children, ...props }) {\r\n          return (\r\n            <TableContainer\r\n              sx={{\r\n                width: 'fit-content',\r\n                minWidth: '300px'\r\n              }}\r\n              elevation={0}\r\n              component={Paper}\r\n            >\r\n              {/* @ts-ignore */}\r\n              <Table {...props}>{children}</Table>\r\n            </TableContainer>\r\n          );\r\n        },\r\n        thead({ children, ...props }) {\r\n          // @ts-ignore\r\n          return <TableHead {...props}>{children}</TableHead>;\r\n        },\r\n        tr({ children, ...props }) {\r\n          // @ts-ignore\r\n          return <TableRow {...props}>{children}</TableRow>;\r\n        },\r\n        th({ children, ...props }) {\r\n          return (\r\n            // @ts-ignore\r\n            <TableCell {...props} align=\"right\" sx={{ padding: 1 }}>\r\n              {children}\r\n            </TableCell>\r\n          );\r\n        },\r\n        td({ children, ...props }) {\r\n          return (\r\n            // @ts-ignore\r\n            <TableCell {...props} align=\"right\" sx={{ padding: 1 }}>\r\n              {children}\r\n            </TableCell>\r\n          );\r\n        },\r\n        tbody({ children, ...props }) {\r\n          // @ts-ignore\r\n          return <TableBody {...props}>{children}</TableBody>;\r\n        }\r\n      }}\r\n    >\r\n      {children}\r\n    </ReactMarkdown>\r\n  );\r\n}\r\n\r\nexport { Markdown };\r\n","import hljs from 'highlight.js';\r\nimport { useEffect, useRef } from 'react';\r\nimport { grey } from 'theme/palette';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport { useIsDarkMode } from 'hooks/useIsDarkMode';\r\n\r\nimport 'highlight.js/styles/monokai-sublime.css';\r\n\r\nimport { ClipboardCopy } from './ClipboardCopy';\r\n\r\nconst CodeSnippet = ({ language, children }) => {\r\n  const codeRef = useRef<HTMLElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (codeRef.current) {\r\n      const highlighted =\r\n        codeRef.current.getAttribute('data-highlighted') === 'yes';\r\n      if (!highlighted) {\r\n        hljs.highlightElement(codeRef.current);\r\n      }\r\n    }\r\n  }, []);\r\n\r\n  return (\r\n    <pre style={{ margin: 0 }}>\r\n      <code\r\n        ref={codeRef}\r\n        style={{\r\n          borderBottomLeftRadius: '4px',\r\n          borderBottomRightRadius: '4px',\r\n          fontFamily: 'monospace',\r\n          fontSize: '14px'\r\n        }}\r\n        className={`language-${language}`}\r\n      >\r\n        {children}\r\n      </code>\r\n    </pre>\r\n  );\r\n};\r\n\r\nconst Code = ({ children, ...props }: any) => {\r\n  const isDarkMode = useIsDarkMode();\r\n  const codeChildren = props.node?.children?.[0];\r\n  const className = codeChildren?.properties?.className?.[0];\r\n  const match = /language-(\\w+)/.exec(className || '');\r\n  const code = codeChildren?.children?.[0]?.value;\r\n\r\n  const showSyntaxHighlighter = match && code;\r\n\r\n  const highlightedCode = showSyntaxHighlighter ? (\r\n    <CodeSnippet language={match[1]}>{code}</CodeSnippet>\r\n  ) : null;\r\n\r\n  const nonHighlightedCode = showSyntaxHighlighter ? null : (\r\n    <Box\r\n      sx={{\r\n        background: isDarkMode ? grey[900] : grey[200],\r\n        borderRadius: '4px',\r\n        padding: (theme) => theme.spacing(1),\r\n        paddingRight: '2.5em',\r\n        minHeight: '20px',\r\n        overflowX: 'auto'\r\n      }}\r\n    >\r\n      <code\r\n        {...props}\r\n        style={{\r\n          whiteSpace: 'pre-wrap'\r\n        }}\r\n      >\r\n        {children}\r\n      </code>\r\n    </Box>\r\n  );\r\n\r\n  return (\r\n    <Box\r\n      sx={{\r\n        position: 'relative'\r\n      }}\r\n    >\r\n      <Stack\r\n        px={2}\r\n        py={0.5}\r\n        direction=\"row\"\r\n        sx={{\r\n          justifyContent: 'space-between',\r\n          alignItems: 'center',\r\n          borderTopLeftRadius: '4px',\r\n          borderTopRightRadius: '4px',\r\n          background: isDarkMode ? grey[900] : grey[200]\r\n        }}\r\n      >\r\n        <Typography variant=\"caption\">{match?.[1] || 'Raw code'}</Typography>\r\n        <ClipboardCopy edge=\"end\" value={code} />\r\n      </Stack>\r\n\r\n      {highlightedCode}\r\n      {nonHighlightedCode}\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport { Code };\r\n","import { useState } from 'react';\r\nimport { useCopyToClipboard } from 'usehooks-ts';\r\n\r\nimport ContentPaste from '@mui/icons-material/ContentPaste';\r\nimport IconButton, { IconButtonProps } from '@mui/material/IconButton';\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\ninterface ClipboardCopyProps {\r\n  value: string;\r\n  theme?: 'dark' | 'light';\r\n  edge?: IconButtonProps['edge'];\r\n}\r\n\r\nconst ClipboardCopy = ({ value, edge }: ClipboardCopyProps): JSX.Element => {\r\n  const [isCopied, setIsCopied] = useState(false);\r\n  const [_, copy] = useCopyToClipboard();\r\n\r\n  const handleCopy = () => {\r\n    copy(value)\r\n      .then(() => {\r\n        setIsCopied(true);\r\n      })\r\n      .catch((err) => console.log('An error occurred while copying: ', err));\r\n  };\r\n\r\n  const handleTooltipClose = () => {\r\n    setIsCopied(false);\r\n  };\r\n\r\n  return (\r\n    <Tooltip\r\n      title={isCopied ? 'Copied to clipboard!' : 'Copy'}\r\n      onClose={handleTooltipClose}\r\n      sx={{ zIndex: 2 }}\r\n    >\r\n      <IconButton color=\"inherit\" edge={edge} onClick={handleCopy}>\r\n        <ContentPaste sx={{ height: 16, width: 16 }} />\r\n      </IconButton>\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nexport { ClipboardCopy };\r\n","import { createContext } from 'react';\r\n\r\nimport { IMessageContext } from 'src/types/messageContext';\r\n\r\nconst defaultMessageContext = {\r\n  avatars: [],\r\n  defaultCollapseContent: false,\r\n  expandAll: false,\r\n  hideCot: false,\r\n  highlightedMessage: null,\r\n  loading: false,\r\n  onElementRefClick: undefined,\r\n  onFeedbackUpdated: undefined,\r\n  onPlaygroundButtonClick: undefined,\r\n  showFeedbackButtons: true,\r\n  onError: () => undefined,\r\n  uiName: ''\r\n};\r\n\r\nconst MessageContext = createContext<IMessageContext>(defaultMessageContext);\r\n\r\nexport { MessageContext, defaultMessageContext };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext } from 'react';\r\n\r\nimport Link from '@mui/material/Link';\r\n\r\nimport type { IMessageElement } from 'client-types/';\r\n\r\ninterface Props {\r\n  element: IMessageElement;\r\n}\r\n\r\nconst ElementRef = ({ element }: Props) => {\r\n  const { onElementRefClick } = useContext(MessageContext);\r\n\r\n  if (element.display === 'inline') {\r\n    return <span style={{ fontWeight: 700 }}>{element.name}</span>;\r\n  }\r\n\r\n  return (\r\n    <Link\r\n      role=\"link\"\r\n      className=\"element-link\"\r\n      sx={{ cursor: 'pointer' }}\r\n      onClick={() => onElementRefClick && onElementRefClick(element)}\r\n    >\r\n      {element.name}\r\n    </Link>\r\n  );\r\n};\r\n\r\nexport { ElementRef };\r\n","import { grey } from 'theme/palette';\r\n\r\nimport Box from '@mui/material/Box';\r\n\r\nimport { useIsDarkMode } from 'hooks/useIsDarkMode';\r\n\r\nconst InlineCode = ({ children, ...props }: any) => {\r\n  const isDarkMode = useIsDarkMode();\r\n  return (\r\n    <Box\r\n      sx={{\r\n        display: 'inline',\r\n        position: 'relative'\r\n      }}\r\n    >\r\n      <code\r\n        {...props}\r\n        style={{\r\n          background: isDarkMode ? grey[900] : grey[200],\r\n          borderRadius: '4px',\r\n          padding: '0.2em 0.4em',\r\n          overflowX: 'auto'\r\n        }}\r\n      >\r\n        {children}\r\n      </code>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport { InlineCode };\r\n","import { Markdown } from 'src/Markdown';\r\n\r\nimport Box from '@mui/material/Box';\r\n\r\nimport { useFetch } from 'hooks/useFetch';\r\n\r\nimport { type ITextElement } from 'client-types/';\r\n\r\ninterface Props {\r\n  element: ITextElement;\r\n}\r\n\r\nconst TextElement = ({ element }: Props) => {\r\n  const { data, error, isLoading } = useFetch(element.url || null);\r\n\r\n  let content;\r\n\r\n  if (isLoading) {\r\n    content = 'Loading...';\r\n  } else if (error) {\r\n    content = 'An error occured';\r\n  } else if (data) {\r\n    console.log('data' + data);\r\n    content = data.content;\r\n  }\r\n\r\n  if (element.language && content && !isLoading && !error) {\r\n    content = `\\`\\`\\`${element.language}\\n${content}\\n\\`\\`\\``;\r\n  }\r\n\r\n  return (\r\n    <Box sx={{ fontFamily: (theme) => theme.typography.fontFamily }}>\r\n      <Markdown>{content}</Markdown>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport { TextElement };\r\n","import { type IVideoElement } from 'client-types/';\r\n\r\nconst VideoElement = ({ element }: { element: IVideoElement }) => {\r\n  if (!element.url) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <video\r\n      className={`${element.display}-video`}\r\n      width=\"100%\"\r\n      controls\r\n      src={element.url}\r\n    ></video>\r\n  );\r\n};\r\n\r\nexport { VideoElement };\r\n","import type { IMessageElement } from 'client-types/';\r\n\r\nimport { AudioElement } from './Audio';\r\nimport { FileElement } from './File';\r\nimport { ImageElement } from './Image';\r\nimport { PDFElement } from './PDF';\r\nimport { PlotlyElement } from './Plotly';\r\nimport { TextElement } from './Text';\r\nimport { VideoElement } from './Video';\r\n\r\ninterface ElementProps {\r\n  element?: IMessageElement;\r\n}\r\n\r\nconst Element = ({ element }: ElementProps): JSX.Element | null => {\r\n  switch (element?.type) {\r\n    case 'file':\r\n      return <FileElement element={element} />;\r\n    case 'image':\r\n      return <ImageElement element={element} />;\r\n    case 'text':\r\n      return <TextElement element={element} />;\r\n    case 'pdf':\r\n      return <PDFElement element={element} />;\r\n    case 'audio':\r\n      return <AudioElement element={element} />;\r\n    case 'video':\r\n      return <VideoElement element={element} />;\r\n    case 'plotly':\r\n      return <PlotlyElement element={element} />;\r\n    default:\r\n      return null;\r\n  }\r\n};\r\n\r\nexport { Element };\r\n","import { SyntheticEvent, forwardRef, useState } from 'react';\r\nimport { Resizable } from 'react-resizable';\r\nimport { useWindowSize } from 'usehooks-ts';\r\n\r\nimport Close from '@mui/icons-material/Close';\r\nimport type { Theme } from '@mui/material';\r\nimport Box, { BoxProps } from '@mui/material/Box';\r\nimport MDrawer from '@mui/material/Drawer';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\nimport styled from '@mui/material/styles/styled';\r\nimport useMediaQuery from '@mui/material/useMediaQuery';\r\n\r\nimport type { IMessageElement } from 'client-types/';\r\n\r\nimport 'react-resizable/css/styles.css';\r\n\r\nimport { Element } from './Element';\r\n\r\nconst DRAWER_DEFAULT_WIDTH = 400;\r\n\r\ninterface MainDrawerProps {\r\n  open?: boolean;\r\n  width?: number;\r\n}\r\n\r\ninterface DrawerProps extends BoxProps {\r\n  open?: boolean;\r\n  width?: number | string;\r\n  isSmallScreen?: boolean;\r\n}\r\n\r\ninterface SideViewProps {\r\n  children: React.ReactNode;\r\n  element?: IMessageElement;\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nconst Handle = forwardRef(function Handle(\r\n  { ...props }: { handleAxis?: string },\r\n  ref\r\n) {\r\n  // Make sure the dom element doesn't receive the handleAxis prop.\r\n  delete props.handleAxis;\r\n  return (\r\n    <Box\r\n      sx={{\r\n        boxSizing: 'content-box',\r\n        width: '4px',\r\n        height: '24px',\r\n        position: 'absolute',\r\n        top: '50%',\r\n        marginTop: '-12px',\r\n        left: 0,\r\n        cursor: 'ew-resize',\r\n        padding: '10px 5px'\r\n      }}\r\n      ref={ref}\r\n      {...props}\r\n    >\r\n      <Box\r\n        sx={{\r\n          boxSizing: 'content-box',\r\n          width: '100%',\r\n          height: '100%',\r\n          backgroundColor: 'grey.300',\r\n          borderRadius: '4px'\r\n        }}\r\n      />\r\n    </Box>\r\n  );\r\n});\r\n\r\nconst ElementSideView = ({\r\n  children,\r\n  element,\r\n  isOpen,\r\n  onClose\r\n}: SideViewProps) => {\r\n  const [resizeInProgress, setResizeInProgress] = useState(false);\r\n  const [drawerWidth, setDrawerWidth] = useState<number>(DRAWER_DEFAULT_WIDTH);\r\n\r\n  const handleResize = (\r\n    _event: SyntheticEvent,\r\n    data: { size: { width: number } }\r\n  ) => setDrawerWidth(data.size.width);\r\n\r\n  const { width } = useWindowSize();\r\n  const isSmallScreen = useMediaQuery<Theme>((theme) =>\r\n    theme.breakpoints.down('sm')\r\n  );\r\n\r\n  if (drawerWidth < DRAWER_DEFAULT_WIDTH && isSmallScreen) {\r\n    setDrawerWidth(DRAWER_DEFAULT_WIDTH);\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <MainDrawer open={isOpen} width={drawerWidth}>\r\n        {children}\r\n      </MainDrawer>\r\n      <Resizable\r\n        width={drawerWidth}\r\n        height={0} // Resizable requires height, but we don't want to limit height, so set it to 0.\r\n        onResize={handleResize}\r\n        onResizeStart={() => setResizeInProgress(true)}\r\n        onResizeStop={() => setResizeInProgress(false)}\r\n        resizeHandles={['w']}\r\n        handle={!isSmallScreen ? <Handle /> : <></>}\r\n        axis=\"x\"\r\n        minConstraints={[100, 0]} // Minimum width of 100px and no limit on height.\r\n        maxConstraints={[width / 2, 0]} // Constraint the maximum width to the half of the screen without limit on height.\r\n      >\r\n        <Drawer\r\n          anchor=\"right\"\r\n          isSmallScreen={isSmallScreen}\r\n          open={isOpen}\r\n          variant={isSmallScreen ? 'temporary' : 'persistent'}\r\n          width={drawerWidth}\r\n        >\r\n          <Stack direction=\"row\" alignItems=\"center\">\r\n            <Typography\r\n              noWrap\r\n              fontSize=\"20px\"\r\n              fontWeight={500}\r\n              id=\"side-view-title\"\r\n            >\r\n              {element?.name}\r\n            </Typography>\r\n            <IconButton edge=\"end\" sx={{ ml: 'auto' }} onClick={onClose}>\r\n              <Close />\r\n            </IconButton>\r\n          </Stack>\r\n\r\n          <Box\r\n            mt=\"1.5rem\"\r\n            id=\"side-view-content\"\r\n            sx={{\r\n              height: '100%',\r\n              pointerEvents: resizeInProgress ? 'none' : 'auto'\r\n            }}\r\n          >\r\n            <Element element={element} />\r\n          </Box>\r\n        </Drawer>\r\n      </Resizable>\r\n    </>\r\n  );\r\n};\r\n\r\nconst MainDrawer = styled(Box, {\r\n  shouldForwardProp: (prop) => prop !== 'open'\r\n})<MainDrawerProps>(({ theme, open }) => ({\r\n  width: '100%',\r\n  display: 'flex',\r\n  flexDirection: 'column',\r\n  boxSizing: 'border-box',\r\n  transition: theme.transitions.create('margin', {\r\n    easing: theme.transitions.easing[open ? 'easeOut' : 'sharp'],\r\n    duration:\r\n      theme.transitions.duration[open ? 'enteringScreen' : 'leavingScreen']\r\n  })\r\n}));\r\n\r\nconst Drawer = styled(MDrawer, {\r\n  shouldForwardProp: (prop) => prop !== 'isSmallScreen'\r\n})<DrawerProps>(({ theme, open, width, isSmallScreen }) => ({\r\n  width,\r\n  flexShrink: 0,\r\n  display: open ? 'flex' : 'none',\r\n  '& .MuiDrawer-paper': {\r\n    position: 'inherit',\r\n    width,\r\n    maxWidth: isSmallScreen ? '80%' : '100%',\r\n    backgroundColor: theme.palette.background.paper,\r\n    borderLeft: `1px solid ${theme.palette.divider}`,\r\n    flexDirection: 'column',\r\n    borderRadius: 0,\r\n    color: theme.palette.text.primary,\r\n    whiteSpace: 'nowrap',\r\n    boxSizing: 'border-box',\r\n    padding: '1.5rem',\r\n    paddingTop: '.5rem',\r\n    overflowX: 'hidden'\r\n  }\r\n}));\r\n\r\nexport { ElementSideView };\r\n","import ArrowBack from '@mui/icons-material/ArrowBack';\r\nimport Box from '@mui/material/Box';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport type { IMessageElement } from 'client-types/';\r\n\r\nimport { Element } from './Element';\r\n\r\ninterface ElementViewProps {\r\n  element: IMessageElement;\r\n  onGoBack?: () => void;\r\n}\r\n\r\nconst ElementView = ({ element, onGoBack }: ElementViewProps) => {\r\n  return (\r\n    <Box\r\n      display=\"flex\"\r\n      flexDirection=\"column\"\r\n      flexGrow={1}\r\n      p={3}\r\n      gap={2}\r\n      boxSizing=\"border-box\"\r\n      mx=\"auto\"\r\n      sx={{\r\n        width: '100%',\r\n        maxWidth: '60rem',\r\n        color: 'text.primary'\r\n      }}\r\n      id=\"element-view\"\r\n    >\r\n      <Stack direction=\"row\" gap={1}>\r\n        {onGoBack ? (\r\n          <IconButton edge=\"start\" onClick={onGoBack}>\r\n            <ArrowBack />\r\n          </IconButton>\r\n        ) : null}\r\n        <Typography fontWeight={700} fontSize=\"25px\">\r\n          {element.name}\r\n        </Typography>\r\n      </Stack>\r\n\r\n      <Element element={element} />\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport { ElementView, Element };\r\n","import Box from '@mui/material/Box';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport type { IAudioElement } from 'client-types/';\r\n\r\nimport { AudioElement } from './Audio';\r\n\r\ninterface Props {\r\n  items: IAudioElement[];\r\n}\r\n\r\nconst InlinedAudioList = ({ items }: Props) => {\r\n  return (\r\n    <Stack spacing={1}>\r\n      {items.map((audio, i) => {\r\n        return (\r\n          <Box key={i} pt={0.5}>\r\n            <AudioElement element={audio} />\r\n          </Box>\r\n        );\r\n      })}\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { InlinedAudioList };\r\n","import Stack from '@mui/material/Stack';\r\n\r\nimport type { ElementType, IMessageElement } from 'client-types/';\r\n\r\nimport { InlinedAudioList } from './InlinedAudioList';\r\nimport { InlinedFileList } from './InlinedFileList';\r\nimport { InlinedImageList } from './InlinedImageList';\r\nimport { InlinedPDFList } from './InlinedPDFList';\r\nimport { InlinedPlotlyList } from './InlinedPlotlyList';\r\nimport { InlinedTextList } from './InlinedTextList';\r\nimport { InlinedVideoList } from './InlinedVideoList';\r\n\r\ninterface Props {\r\n  elements: IMessageElement[];\r\n}\r\n\r\nconst InlinedElements = ({ elements }: Props) => {\r\n  if (!elements.length) {\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * Categorize the elements by element type\r\n   * The TypeScript dance is needed to make sure we can do elementsByType.image\r\n   * and get an array of IImageElement.\r\n   */\r\n  const elementsByType = elements.reduce(\r\n    (acc, el: IMessageElement) => {\r\n      if (!acc[el.type]) {\r\n        acc[el.type] = [];\r\n      }\r\n      const array = acc[el.type] as Extract<\r\n        IMessageElement,\r\n        { type: typeof el.type }\r\n      >[];\r\n      array.push(el);\r\n      return acc;\r\n    },\r\n    {} as {\r\n      [K in ElementType]: Extract<IMessageElement, { type: K }>[];\r\n    }\r\n  );\r\n\r\n  return (\r\n    <Stack gap={1} mt={1}>\r\n      {elementsByType.image?.length ? (\r\n        <InlinedImageList items={elementsByType.image} />\r\n      ) : null}\r\n      {elementsByType.text?.length ? (\r\n        <InlinedTextList items={elementsByType.text} />\r\n      ) : null}\r\n      {elementsByType.pdf?.length ? (\r\n        <InlinedPDFList items={elementsByType.pdf} />\r\n      ) : null}\r\n      {elementsByType.audio?.length ? (\r\n        <InlinedAudioList items={elementsByType.audio} />\r\n      ) : null}\r\n      {elementsByType.video?.length ? (\r\n        <InlinedVideoList items={elementsByType.video} />\r\n      ) : null}\r\n      {elementsByType.file?.length ? (\r\n        <InlinedFileList items={elementsByType.file} />\r\n      ) : null}\r\n      {elementsByType.plotly?.length ? (\r\n        <InlinedPlotlyList items={elementsByType.plotly} />\r\n      ) : null}\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { InlinedElements };\r\n","import Stack from '@mui/material/Stack';\r\n\r\nimport type { IFileElement } from 'client-types/';\r\n\r\nimport { FileElement } from './File';\r\n\r\ninterface Props {\r\n  items: IFileElement[];\r\n}\r\n\r\nconst InlinedFileList = ({ items }: Props) => {\r\n  return (\r\n    <Stack spacing={1} direction=\"row\">\r\n      {items.map((file, i) => {\r\n        return (\r\n          <div key={i}>\r\n            <FileElement element={file} />\r\n          </div>\r\n        );\r\n      })}\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { InlinedFileList };\r\n","import ImageList from '@mui/material/ImageList';\r\nimport ImageListItem from '@mui/material/ImageListItem';\r\n\r\nimport type { IImageElement, IVideoElement } from 'client-types/';\r\n\r\nconst sizeToUnit = (element: IImageElement | IVideoElement) => {\r\n  switch (element.size) {\r\n    case 'small':\r\n      return 1;\r\n    case 'medium':\r\n      return 2;\r\n    case 'large':\r\n      return 4;\r\n    default:\r\n      return 2;\r\n  }\r\n};\r\n\r\nconst ListWithSize = <T extends IImageElement | IVideoElement>({\r\n  elements,\r\n  renderElement: Renderer\r\n}: {\r\n  elements: T[];\r\n  renderElement: ({ element }: { element: T }) => JSX.Element | null;\r\n}) => {\r\n  return (\r\n    <ImageList\r\n      sx={{\r\n        margin: 0,\r\n        // Promote the list into its own layer in Chrome. This costs memory, but helps keeping high FPS.\r\n        transform: 'translateZ(0)',\r\n        width: '100%',\r\n        maxWidth: 600\r\n      }}\r\n      variant=\"quilted\"\r\n      cols={4}\r\n      gap={8}\r\n    >\r\n      {elements.map((element, i) => {\r\n        const cols = sizeToUnit(element);\r\n        const rows = sizeToUnit(element);\r\n\r\n        return (\r\n          <ImageListItem key={i} cols={cols} rows={rows}>\r\n            <Renderer element={element} />\r\n          </ImageListItem>\r\n        );\r\n      })}\r\n    </ImageList>\r\n  );\r\n};\r\n\r\nexport { ListWithSize };\r\n","import type { IImageElement } from 'client-types/';\r\n\r\nimport { ImageElement } from './Image';\r\nimport { ListWithSize } from './ListWithSize';\r\n\r\ninterface Props {\r\n  items: IImageElement[];\r\n}\r\n\r\nconst InlinedImageList = ({ items }: Props) => (\r\n  <ListWithSize<IImageElement>\r\n    elements={items}\r\n    renderElement={(ctx) => <ImageElement element={ctx.element} />}\r\n  />\r\n);\r\n\r\nexport { InlinedImageList };\r\n","import Stack from '@mui/material/Stack';\r\n\r\nimport type { IPdfElement } from 'client-types/';\r\n\r\nimport { PDFElement } from './PDF';\r\n\r\ninterface Props {\r\n  items: IPdfElement[];\r\n}\r\n\r\nconst InlinedPDFList = ({ items }: Props) => (\r\n  <Stack spacing={1}>\r\n    {items.map((pdf, i) => {\r\n      return (\r\n        <div\r\n          key={i}\r\n          style={{\r\n            maxWidth: '600px',\r\n            height: '400px'\r\n          }}\r\n        >\r\n          <PDFElement element={pdf} />\r\n        </div>\r\n      );\r\n    })}\r\n  </Stack>\r\n);\r\n\r\nexport { InlinedPDFList };\r\n","import Stack from '@mui/material/Stack';\r\n\r\nimport type { IPlotlyElement } from 'client-types/';\r\n\r\nimport { PlotlyElement } from './Plotly';\r\n\r\ninterface Props {\r\n  items: IPlotlyElement[];\r\n}\r\n\r\nconst InlinedPlotlyList = ({ items }: Props) => (\r\n  <Stack spacing={1}>\r\n    {items.map((element, i) => {\r\n      return (\r\n        <div\r\n          key={i}\r\n          style={{\r\n            maxWidth: '600px',\r\n            height: '400px'\r\n          }}\r\n        >\r\n          <PlotlyElement element={element} />\r\n        </div>\r\n      );\r\n    })}\r\n  </Stack>\r\n);\r\n\r\nexport { InlinedPlotlyList };\r\n","import Alert from '@mui/material/Alert';\r\nimport AlertTitle from '@mui/material/AlertTitle';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport type { ITextElement } from 'client-types/';\r\n\r\nimport { TextElement } from './Text';\r\n\r\ninterface Props {\r\n  items: ITextElement[];\r\n}\r\n\r\nconst InlinedTextList = ({ items }: Props) => (\r\n  <Stack spacing={1}>\r\n    {items.map((el, i) => {\r\n      return (\r\n        <Alert color=\"info\" key={i} icon={false}>\r\n          <AlertTitle>{el.name}</AlertTitle>\r\n          <TextElement element={el} />\r\n        </Alert>\r\n      );\r\n    })}\r\n  </Stack>\r\n);\r\n\r\nexport { InlinedTextList };\r\n","import type { IVideoElement } from 'client-types/';\r\n\r\nimport { ListWithSize } from './ListWithSize';\r\nimport { VideoElement } from './Video';\r\n\r\ninterface Props {\r\n  items: IVideoElement[];\r\n}\r\n\r\nconst InlinedVideoList = ({ items }: Props) => (\r\n  <ListWithSize<IVideoElement>\r\n    elements={items}\r\n    renderElement={(ctx) => <VideoElement element={ctx.element} />}\r\n  />\r\n);\r\n\r\nexport { InlinedVideoList };\r\n","import { MessageContext, defaultMessageContext } from 'contexts/MessageContext';\r\nimport { memo, useEffect, useRef } from 'react';\r\n\r\nimport Box from '@mui/material/Box';\r\n\r\nimport type { IAction, IMessageElement, IStep } from 'client-types/';\r\nimport { IMessageContext } from 'src/types/messageContext';\r\n\r\nimport { Messages } from './Messages';\r\n\r\ninterface Props {\r\n  actions: IAction[];\r\n  autoScroll?: boolean;\r\n  context: IMessageContext;\r\n  elements: IMessageElement[];\r\n  messages: IStep[];\r\n  setAutoScroll?: (autoScroll: boolean) => void;\r\n}\r\n\r\nconst MessageContainer = memo(\r\n  ({\r\n    actions,\r\n    autoScroll,\r\n    context,\r\n    elements,\r\n    messages,\r\n    setAutoScroll\r\n  }: Props) => {\r\n    const ref = useRef<HTMLDivElement>();\r\n\r\n    useEffect(() => {\r\n      if (!ref.current || !autoScroll) {\r\n        return;\r\n      }\r\n      ref.current.scrollTop = ref.current.scrollHeight;\r\n    }, [messages, autoScroll]);\r\n\r\n    const handleScroll = () => {\r\n      if (!ref.current || !setAutoScroll) return;\r\n\r\n      const { scrollTop, scrollHeight, clientHeight } = ref.current;\r\n      const atBottom = scrollTop + clientHeight >= scrollHeight - 10;\r\n      setAutoScroll(atBottom);\r\n    };\r\n\r\n    return (\r\n      <MessageContext.Provider value={context || defaultMessageContext}>\r\n        <Box\r\n          ref={ref}\r\n          position=\"relative\"\r\n          display=\"flex\"\r\n          flexDirection=\"column\"\r\n          flexGrow={1}\r\n          sx={{\r\n            overflowY: 'auto'\r\n          }}\r\n          onScroll={handleScroll}\r\n        >\r\n          <Messages\r\n            indent={0}\r\n            messages={messages}\r\n            elements={elements}\r\n            actions={actions}\r\n          />\r\n        </Box>\r\n      </MessageContext.Provider>\r\n    );\r\n  }\r\n);\r\n\r\nexport { MessageContainer };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { memo, useContext } from 'react';\r\n\r\nimport type { IAction, IMessageElement, IStep } from 'client-types/';\r\n\r\nimport { Message } from './Message';\r\n\r\ninterface Props {\r\n  messages: IStep[];\r\n  elements: IMessageElement[];\r\n  actions: IAction[];\r\n  indent: number;\r\n  isRunning?: boolean;\r\n}\r\n\r\nconst Messages = memo(\r\n  ({ messages, elements, actions, indent, isRunning }: Props) => {\r\n    const messageContext = useContext(MessageContext);\r\n\r\n    const isRoot = indent === 0;\r\n    let previousAuthor = '';\r\n\r\n    const filtered = messages.filter((m, i) => {\r\n      const content = m.output;\r\n      const hasContent = !!content;\r\n      const hasInlinedElement = elements.find(\r\n        (el) => el.display === 'inline' && el.forId === m.id\r\n      );\r\n      const hasChildren = !!m.steps?.length && !messageContext.hideCot;\r\n      const isLast = i === messages.length - 1;\r\n      const messageRunning =\r\n        isRunning === undefined\r\n          ? messageContext.loading && isLast\r\n          : isRunning && isLast;\r\n      return (\r\n        hasContent ||\r\n        hasInlinedElement ||\r\n        hasChildren ||\r\n        (!hasContent && messageRunning)\r\n      );\r\n    });\r\n\r\n    return (\r\n      <>\r\n        {filtered.map((m, i) => {\r\n          const author = m.name;\r\n          const isLast = filtered.length - 1 === i;\r\n          let messageRunning =\r\n            isRunning === undefined ? messageContext.loading : isRunning;\r\n          if (isRoot) {\r\n            messageRunning = messageRunning && isLast;\r\n          }\r\n          const showAvatar = author !== previousAuthor;\r\n          const showBorder = false;\r\n          previousAuthor = author;\r\n          return (\r\n            <Message\r\n              message={m}\r\n              elements={elements}\r\n              actions={actions}\r\n              showAvatar={showAvatar}\r\n              showBorder={showBorder}\r\n              key={m.id}\r\n              indent={indent}\r\n              isRunning={messageRunning}\r\n              isLast={isLast}\r\n            />\r\n          );\r\n        })}\r\n      </>\r\n    );\r\n  }\r\n);\r\n\r\nexport { Messages };\r\n","import { keyframes } from '@emotion/react';\r\nimport { MessageContext } from 'contexts/MessageContext';\r\nimport { memo, useContext, useEffect, useState } from 'react';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport { AskUploadButton } from './components/AskUploadButton';\r\nimport { AUTHOR_BOX_WIDTH, Author } from './components/Author';\r\nimport { DetailsButton } from './components/DetailsButton';\r\nimport { MessageActions } from './components/MessageActions';\r\nimport { MessageButtons } from './components/MessageButtons';\r\nimport { MessageContent } from './components/MessageContent';\r\n\r\nimport type { IAction, IMessageElement, IStep } from 'client-types/';\r\n\r\nimport { Messages } from './Messages';\r\n\r\ninterface Props {\r\n  message: IStep;\r\n  elements: IMessageElement[];\r\n  actions: IAction[];\r\n  indent: number;\r\n  showAvatar?: boolean;\r\n  showBorder?: boolean;\r\n  isRunning?: boolean;\r\n  isLast?: boolean;\r\n}\r\n\r\nconst Message = memo(\r\n  ({\r\n    message,\r\n    elements,\r\n    actions,\r\n    indent,\r\n    showAvatar,\r\n    showBorder,\r\n    isRunning,\r\n    isLast\r\n  }: Props) => {\r\n    const {\r\n      expandAll,\r\n      hideCot,\r\n      highlightedMessage,\r\n      defaultCollapseContent,\r\n      allowHtml,\r\n      latex,\r\n      onError\r\n    } = useContext(MessageContext);\r\n\r\n    const [showDetails, setShowDetails] = useState(expandAll);\r\n\r\n    useEffect(() => {\r\n      setShowDetails(expandAll);\r\n    }, [expandAll]);\r\n\r\n    if (hideCot && indent) {\r\n      return null;\r\n    }\r\n\r\n    const isUser = message.type === 'user_message';\r\n    const isAsk = message.waitForAnswer;\r\n\r\n    return (\r\n      <Box\r\n        sx={{\r\n          color: 'text.primary',\r\n          backgroundColor: (theme) =>\r\n            isUser\r\n              ? 'transparent'\r\n              : theme.palette.mode === 'dark'\r\n              ? theme.palette.grey[800]\r\n              : theme.palette.grey[100]\r\n        }}\r\n        className=\"step\"\r\n      >\r\n        <Box\r\n          sx={{\r\n            boxSizing: 'border-box',\r\n            mx: 'auto',\r\n            maxWidth: '60rem',\r\n            px: 2,\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n            position: 'relative'\r\n          }}\r\n        >\r\n          <Stack\r\n            id={`step-${message.id}`}\r\n            direction=\"row\"\r\n            ml={indent ? `${indent * (AUTHOR_BOX_WIDTH + 12)}px` : 0}\r\n            sx={{\r\n              py: 2,\r\n              borderBottom: (theme) =>\r\n                showBorder ? `1px solid ${theme.palette.divider}` : 'none',\r\n              animation:\r\n                message.id && highlightedMessage === message.id\r\n                  ? `3s ease-in-out 0.1s ${flash}`\r\n                  : 'none',\r\n              overflowX: 'auto'\r\n            }}\r\n          >\r\n            <Author message={message} show={showAvatar}>\r\n              <Stack alignItems=\"flex-start\" minWidth={150}>\r\n                <MessageContent\r\n                  elements={elements}\r\n                  message={message}\r\n                  preserveSize={!!message.streaming || !defaultCollapseContent}\r\n                  allowHtml={allowHtml}\r\n                  latex={latex}\r\n                />\r\n                <DetailsButton\r\n                  message={message}\r\n                  opened={showDetails}\r\n                  onClick={() => setShowDetails(!showDetails)}\r\n                  loading={isRunning && isLast}\r\n                />\r\n                {!isRunning && isLast && isAsk && (\r\n                  <AskUploadButton onError={onError} />\r\n                )}\r\n                {actions?.length ? (\r\n                  <MessageActions message={message} actions={actions} />\r\n                ) : null}\r\n                <MessageButtons message={message} />\r\n              </Stack>\r\n            </Author>\r\n          </Stack>\r\n        </Box>\r\n        {message.steps && showDetails && (\r\n          <Messages\r\n            messages={message.steps}\r\n            actions={actions}\r\n            elements={elements}\r\n            indent={indent + 1}\r\n            isRunning={isRunning}\r\n          />\r\n        )}\r\n      </Box>\r\n    );\r\n  }\r\n);\r\n\r\n// Uses yellow[500] with 50% opacity\r\nconst flash = keyframes`\r\n  from {\r\n    background-color: transparent;\r\n  }\r\n  25% {\r\n    background-color: rgba(255, 173, 51, 0.5);\r\n  }\r\n  to {\r\n    background-color: transparent;\r\n  }\r\n`;\r\n\r\nexport { Message };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext, useState } from 'react';\r\n\r\nimport Button from '@mui/material/Button';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport { useUpload } from 'hooks/useUpload';\r\n\r\nimport type { IAsk, IFileRef } from 'client-types/';\r\n\r\nconst AskUploadChildButton = ({\r\n  askUser,\r\n  uploadFile,\r\n  onError\r\n}: {\r\n  askUser: IAsk;\r\n  uploadFile: (\r\n    file: File,\r\n    onProgress: (progress: number) => void\r\n  ) => { xhr: XMLHttpRequest; promise: Promise<IFileRef> };\r\n  onError: (error: string) => void;\r\n}) => {\r\n  const [uploads, setUploads] = useState<\r\n    {\r\n      progress: number;\r\n      uploaded: boolean;\r\n      cancel: () => void;\r\n      fileRef?: IFileRef;\r\n    }[]\r\n  >([]);\r\n\r\n  const uploading = uploads.some((upload) => !upload.uploaded);\r\n  const progress = uploads.reduce(\r\n    (acc, upload) => acc + upload.progress / uploads.length,\r\n    0\r\n  );\r\n\r\n  const onResolved = (files: File[]) => {\r\n    if (uploading) return;\r\n\r\n    const promises: Promise<IFileRef>[] = [];\r\n\r\n    const uploads = files.map((file, index) => {\r\n      const { xhr, promise } = uploadFile(file, (progress) => {\r\n        setUploads((prev) =>\r\n          prev.map((upload, i) => {\r\n            if (i === index) {\r\n              return { ...upload, progress };\r\n            }\r\n            return upload;\r\n          })\r\n        );\r\n      });\r\n      promises.push(promise);\r\n      return { progress: 0, uploaded: false, cancel: () => xhr.abort() };\r\n    });\r\n\r\n    Promise.all(promises)\r\n      .then((fileRefs) => askUser.callback(fileRefs))\r\n      .catch((error) => {\r\n        onError(`Failed to upload: ${error.message}`);\r\n        setUploads((prev) => {\r\n          prev.forEach((u) => u.cancel());\r\n          return [];\r\n        });\r\n      });\r\n\r\n    setUploads(uploads);\r\n  };\r\n\r\n  const upload = useUpload({\r\n    spec: askUser.spec,\r\n    onResolved: onResolved,\r\n    onError: (error: string) => onError(error)\r\n  });\r\n\r\n  if (!upload) return null;\r\n  const { getRootProps, getInputProps } = upload;\r\n\r\n  return (\r\n    <Stack\r\n      sx={{\r\n        width: '100%',\r\n        borderRadius: 1,\r\n        backgroundColor: (theme) => theme.palette.background.paper,\r\n        boxSizing: 'border-box',\r\n        mt: 1\r\n      }}\r\n      direction=\"row\"\r\n      alignItems=\"center\"\r\n      padding={2}\r\n      {...getRootProps({ className: 'dropzone' })}\r\n    >\r\n      <input id=\"ask-button-input\" {...getInputProps()} />\r\n      <Stack>\r\n        <Typography color=\"text.primary\">Drag and drop files here</Typography>\r\n        <Typography variant=\"caption\" color=\"text.secondary\">\r\n          Limit {askUser.spec.max_size_mb}mb.\r\n        </Typography>\r\n      </Stack>\r\n      <Button\r\n        id={uploading ? 'ask-upload-button-loading' : 'ask-upload-button'}\r\n        disabled={uploading}\r\n        sx={{ ml: 'auto !important', textTransform: 'capitalize' }}\r\n        variant=\"contained\"\r\n      >\r\n        {uploading ? (\r\n          <CircularProgress variant=\"determinate\" value={progress} size={20} />\r\n        ) : (\r\n          'Browse Files'\r\n        )}\r\n      </Button>\r\n    </Stack>\r\n  );\r\n};\r\n\r\nconst AskUploadButton = ({ onError }: { onError: (error: string) => void }) => {\r\n  const messageContext = useContext(MessageContext);\r\n\r\n  if (\r\n    messageContext.askUser?.spec.type !== 'file' ||\r\n    !messageContext?.uploadFile\r\n  )\r\n    return null;\r\n\r\n  return (\r\n    <AskUploadChildButton\r\n      onError={onError}\r\n      uploadFile={messageContext.uploadFile}\r\n      askUser={messageContext.askUser}\r\n    />\r\n  );\r\n};\r\n\r\nexport { AskUploadButton };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext } from 'react';\r\nimport { AvatarElement } from 'src/elements/Avatar';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport { useColorForName } from 'hooks/useColors';\r\n\r\nimport type { IStep } from 'client-types/';\r\n\r\nimport { MessageTime } from './MessageTime';\r\n\r\ninterface Props {\r\n  message: IStep;\r\n  show?: boolean;\r\n  children?: React.ReactNode;\r\n}\r\n\r\nexport const AUTHOR_BOX_WIDTH = 26;\r\n\r\nconst Author = ({ message, show, children }: Props) => {\r\n  const context = useContext(MessageContext);\r\n  const getColorForName = useColorForName(context.uiName);\r\n\r\n  const isUser = message.type === 'user_message';\r\n  const author = isUser ? 'You' : message.name;\r\n\r\n  const avatarEl = context.avatars.find((e) => e.name === author);\r\n  const avatar = show ? (\r\n    <Stack alignItems=\"center\" gap={1}>\r\n      <AvatarElement\r\n        element={avatarEl}\r\n        author={author}\r\n        bgColor={getColorForName(author, isUser, message.isError)}\r\n      />\r\n      {(!!message.indent || message.parentId) && (\r\n        <Box\r\n          width=\"2px\"\r\n          height=\"100%\"\r\n          borderRadius=\"13px\"\r\n          bgcolor={getColorForName(author, isUser)}\r\n        />\r\n      )}\r\n    </Stack>\r\n  ) : (\r\n    <Box width={AUTHOR_BOX_WIDTH} />\r\n  );\r\n  const name = (\r\n    <Stack direction=\"row\" gap={1} alignItems=\"center\">\r\n      {show ? (\r\n        <Typography\r\n          noWrap\r\n          sx={{\r\n            fontSize: '1rem',\r\n            fontWeight: 600,\r\n            lineHeight: 'unset'\r\n          }}\r\n        >\r\n          {author}\r\n        </Typography>\r\n      ) : null}\r\n      <MessageTime timestamp={message.createdAt} />\r\n    </Stack>\r\n  );\r\n\r\n  return (\r\n    <Stack direction=\"row\" gap={1.5} width=\"100%\">\r\n      {avatar}\r\n      <Stack gap={1} width={`calc(100% - ${AUTHOR_BOX_WIDTH + 12}px)`}>\r\n        {name}\r\n        {children}\r\n      </Stack>\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { Author };\r\n","import { grey } from 'theme/palette';\r\n\r\nimport Typography from '@mui/material/Typography';\r\n\r\ninterface Props {\r\n  timestamp: number | string;\r\n}\r\n\r\nconst MessageTime = ({ timestamp }: Props) => {\r\n  if (!timestamp) return null;\r\n  const dateOptions: Intl.DateTimeFormatOptions = {\r\n    hour: '2-digit',\r\n    minute: '2-digit'\r\n  };\r\n  if (typeof timestamp === 'string' && !timestamp.endsWith('Z')) {\r\n    timestamp = timestamp + 'Z';\r\n  }\r\n  const date = new Date(timestamp).toLocaleTimeString(undefined, dateOptions);\r\n  return (\r\n    <Typography\r\n      sx={{ mt: '1px' }}\r\n      color={grey[500]}\r\n      fontSize=\"12px\"\r\n      lineHeight=\"unset\"\r\n    >\r\n      {date}\r\n    </Typography>\r\n  );\r\n};\r\n\r\nexport { MessageTime };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext } from 'react';\r\nimport { GreyButton } from 'src/buttons/GreyButton';\r\n\r\nimport ExpandLess from '@mui/icons-material/ExpandLess';\r\nimport ExpandMore from '@mui/icons-material/ExpandMore';\r\nimport CircularProgress from '@mui/material/CircularProgress';\r\n\r\nimport type { IStep } from 'client-types/';\r\n\r\ninterface Props {\r\n  message: IStep;\r\n  opened: boolean;\r\n  loading?: boolean;\r\n  onClick: () => void;\r\n}\r\n\r\nconst DetailsButton = ({ message, opened, onClick, loading }: Props) => {\r\n  const messageContext = useContext(MessageContext);\r\n\r\n  const nestedCount = message.steps?.length;\r\n  const nested = !!nestedCount && !messageContext.hideCot;\r\n\r\n  const lastStep = nested ? message.steps![nestedCount - 1] : undefined;\r\n\r\n  const tool = lastStep ? lastStep.name : undefined;\r\n\r\n  const content = message.output;\r\n\r\n  const showDefaultLoader =\r\n    loading && (!content || (messageContext.hideCot && !message.streaming));\r\n\r\n  const show = tool || showDefaultLoader;\r\n\r\n  if (!show) {\r\n    return null;\r\n  }\r\n\r\n  // Don't count empty steps\r\n  const stepCount = nestedCount\r\n    ? message.steps!.filter((m) => !!m.output || m.steps?.length).length\r\n    : 0;\r\n\r\n  const text = loading\r\n    ? tool\r\n      ? `Using ${tool}`\r\n      : 'Running'\r\n    : `Took ${stepCount} step${stepCount <= 1 ? '' : 's'}`;\r\n\r\n  let id = '';\r\n  if (tool) {\r\n    id = tool.trim().toLowerCase().replaceAll(' ', '-');\r\n  }\r\n  if (loading) {\r\n    id += '-loading';\r\n  } else {\r\n    id += '-done';\r\n  }\r\n\r\n  return (\r\n    <GreyButton\r\n      size=\"small\"\r\n      id={id}\r\n      sx={{ marginTop: 1 }}\r\n      color=\"primary\"\r\n      startIcon={\r\n        loading ? <CircularProgress color=\"inherit\" size={16} /> : undefined\r\n      }\r\n      variant=\"contained\"\r\n      endIcon={\r\n        nested && tool ? opened ? <ExpandLess /> : <ExpandMore /> : undefined\r\n      }\r\n      onClick={tool ? onClick : undefined}\r\n    >\r\n      {text}\r\n    </GreyButton>\r\n  );\r\n};\r\n\r\nexport { DetailsButton };\r\n","import Box from '@mui/material/Box';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport type { IAction, IStep } from 'client-types/';\r\n\r\nimport { ActionButton } from './ActionButton';\r\nimport { ActionDrawerButton } from './ActionDrawerButton';\r\n\r\ninterface Props {\r\n  message: IStep;\r\n  actions: IAction[];\r\n}\r\n\r\nconst MessageActions = ({ message, actions }: Props) => {\r\n  const scopedActions = actions.filter((a) => {\r\n    if (a.forId) {\r\n      return a.forId === message.id;\r\n    }\r\n    return true;\r\n  });\r\n\r\n  const displayedActions = scopedActions.filter((a) => !a.collapsed);\r\n  const drawerActions = scopedActions.filter((a) => a.collapsed);\r\n\r\n  const show = displayedActions.length || drawerActions.length;\r\n\r\n  if (!show) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Stack\r\n      direction=\"row\"\r\n      spacing={1}\r\n      alignItems=\"start\"\r\n      justifyContent=\"space-between\"\r\n      width=\"100%\"\r\n    >\r\n      <Box id=\"actions-list\">\r\n        {displayedActions.map((action) => (\r\n          <ActionButton\r\n            key={action.id}\r\n            action={action}\r\n            margin={'2px 8px 6px 0'}\r\n          />\r\n        ))}\r\n        {drawerActions.length ? (\r\n          <ActionDrawerButton actions={drawerActions} />\r\n        ) : null}\r\n      </Box>\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { MessageActions };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext } from 'react';\r\n\r\nimport Button from '@mui/material/Button';\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\nimport type { IAction } from 'client-types/';\r\n\r\ninterface ActionProps {\r\n  action: IAction;\r\n  margin: number | string;\r\n  onClick?: () => void;\r\n}\r\n\r\nconst ActionButton = ({ action, margin, onClick }: ActionProps) => {\r\n  const { askUser, loading } = useContext(MessageContext);\r\n  const isAskingAction = askUser?.spec.type === 'action';\r\n  const isDisabled = isAskingAction && !askUser?.spec.keys?.includes(action.id);\r\n  const handleClick = () => {\r\n    if (isAskingAction) {\r\n      askUser?.callback(action);\r\n    } else {\r\n      action.onClick();\r\n      onClick?.();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Tooltip title={action.description} placement=\"top\">\r\n      <span>\r\n        <Button\r\n          size=\"small\"\r\n          variant=\"outlined\"\r\n          sx={{\r\n            textTransform: 'none',\r\n            margin\r\n          }}\r\n          id={action.id}\r\n          onClick={handleClick}\r\n          disabled={loading || isDisabled}\r\n        >\r\n          {action.label || action.name}\r\n        </Button>\r\n      </span>\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nexport { ActionButton };\r\n","import { useState } from 'react';\r\n\r\nimport MoreVertIcon from '@mui/icons-material/MoreVert';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Menu from '@mui/material/Menu';\r\nimport Stack from '@mui/material/Stack';\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\nimport type { IAction } from 'client-types/';\r\n\r\nimport { ActionButton } from './ActionButton';\r\n\r\nconst ICON_SIZE = '16px';\r\n\r\nconst ActionDrawerButton = ({ actions }: { actions: IAction[] }) => {\r\n  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null);\r\n\r\n  return (\r\n    <>\r\n      <Tooltip title=\"More Actions\">\r\n        <IconButton\r\n          id=\"actions-drawer-button\"\r\n          onClick={(event: React.MouseEvent<HTMLElement>) =>\r\n            setAnchorEl(event.currentTarget)\r\n          }\r\n        >\r\n          <MoreVertIcon sx={{ width: ICON_SIZE, height: ICON_SIZE }} />\r\n        </IconButton>\r\n      </Tooltip>\r\n      <Menu\r\n        id=\"actions-menu\"\r\n        anchorEl={anchorEl}\r\n        open={!!anchorEl}\r\n        onClose={() => setAnchorEl(null)}\r\n        sx={{ marginTop: 1 }}\r\n        slotProps={{\r\n          paper: {\r\n            sx: {\r\n              boxShadow: (theme) =>\r\n                theme.palette.mode === 'light'\r\n                  ? '0px 2px 4px 0px #0000000D'\r\n                  : '0px 10px 10px 0px #0000000D'\r\n            }\r\n          }\r\n        }}\r\n      >\r\n        <Stack direction=\"column\" paddingX={2} gap={1}>\r\n          {actions.map((action) => (\r\n            <ActionButton\r\n              key={action.id}\r\n              onClick={() => setAnchorEl(null)}\r\n              action={action}\r\n              margin={0}\r\n            />\r\n          ))}\r\n        </Stack>\r\n      </Menu>\r\n    </>\r\n  );\r\n};\r\n\r\nexport { ActionDrawerButton };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext } from 'react';\r\nimport { ClipboardCopy } from 'src/ClipboardCopy';\r\nimport { grey } from 'theme/palette';\r\n\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport { useIsDarkMode } from 'hooks/useIsDarkMode';\r\n\r\nimport type { IStep } from 'client-types/';\r\n\r\nimport { FeedbackButtons } from './FeedbackButtons';\r\nimport { PlaygroundButton } from './PlaygroundButton';\r\n\r\ninterface Props {\r\n  message: IStep;\r\n}\r\n\r\nconst MessageButtons = ({ message }: Props) => {\r\n  const isDark = useIsDarkMode();\r\n  const { showFeedbackButtons: showFbButtons } = useContext(MessageContext);\r\n\r\n  const showPlaygroundButton = !!message.generation;\r\n  const isUser = message.type === 'user_message';\r\n  const isAsk = message.waitForAnswer;\r\n  const hasContent = !!message.output;\r\n  const showCopyButton =\r\n    hasContent && !isUser && !isAsk && !message.disableFeedback;\r\n\r\n  const showFeedbackButtons =\r\n    showFbButtons &&\r\n    !message.disableFeedback &&\r\n    !isUser &&\r\n    !isAsk &&\r\n    hasContent;\r\n\r\n  const show = showCopyButton || showPlaygroundButton || showFeedbackButtons;\r\n\r\n  if (!show) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Stack\r\n      sx={{ marginLeft: '-8px !important' }}\r\n      alignItems=\"center\"\r\n      direction=\"row\"\r\n      color={isDark ? grey[400] : grey[600]}\r\n    >\r\n      {showCopyButton ? <ClipboardCopy value={message.output} /> : null}\r\n      {showFeedbackButtons ? <FeedbackButtons message={message} /> : null}\r\n      {showPlaygroundButton ? <PlaygroundButton step={message} /> : null}\r\n    </Stack>\r\n  );\r\n};\r\n\r\nexport { MessageButtons };\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext, useState } from 'react';\r\nimport { useMemo } from 'react';\r\nimport Dialog from 'src/Dialog';\r\nimport { AccentButton } from 'src/buttons/AccentButton';\r\nimport { TextInput } from 'src/inputs';\r\n\r\nimport StickyNote2Outlined from '@mui/icons-material/StickyNote2Outlined';\r\nimport ThumbDownAlt from '@mui/icons-material/ThumbDownAlt';\r\nimport ThumbDownAltOutlined from '@mui/icons-material/ThumbDownAltOutlined';\r\nimport ThumbUpAlt from '@mui/icons-material/ThumbUpAlt';\r\nimport ThumbUpAltOutlined from '@mui/icons-material/ThumbUpAltOutlined';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Stack from '@mui/material/Stack';\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\nimport type { IStep } from 'client-types/';\r\n\r\nconst ICON_SIZE = '16px';\r\n\r\ninterface Props {\r\n  message: IStep;\r\n}\r\n\r\nconst FeedbackButtons = ({ message }: Props) => {\r\n  const { onFeedbackUpdated } = useContext(MessageContext);\r\n  const [showFeedbackDialog, setShowFeedbackDialog] = useState<number>();\r\n  const [commentInput, setCommentInput] = useState<string>();\r\n\r\n  const [feedback, setFeedback] = useState(message.feedback?.value || 0);\r\n  const [comment, setComment] = useState(message.feedback?.comment);\r\n\r\n  const DownIcon = feedback === -1 ? ThumbDownAlt : ThumbDownAltOutlined;\r\n  const UpIcon = feedback === 1 ? ThumbUpAlt : ThumbUpAltOutlined;\r\n\r\n  const handleFeedbackChanged = (feedback: number, comment?: string) => {\r\n    onFeedbackUpdated &&\r\n      onFeedbackUpdated(\r\n        message,\r\n        () => {\r\n          setFeedback(feedback);\r\n          setComment(comment);\r\n        },\r\n        {\r\n          ...(message.feedback || { strategy: 'BINARY' }),\r\n          forId: message.id,\r\n          value: feedback,\r\n          comment\r\n        }\r\n      );\r\n  };\r\n\r\n  const handleFeedbackClick = (status: number) => {\r\n    if (feedback === status) {\r\n      handleFeedbackChanged(0);\r\n    } else {\r\n      setShowFeedbackDialog(status);\r\n    }\r\n  };\r\n\r\n  const disabled = !!message.streaming;\r\n\r\n  const buttons = useMemo(() => {\r\n    const iconSx = {\r\n      width: ICON_SIZE,\r\n      height: ICON_SIZE\r\n    };\r\n\r\n    const baseButtons = [\r\n      () => (\r\n        <Tooltip title=\"Helpful\">\r\n          <span>\r\n            <IconButton\r\n              color=\"inherit\"\r\n              disabled={disabled}\r\n              className={`positive-feedback-${feedback === 1 ? 'on' : 'off'}`}\r\n              onClick={() => {\r\n                handleFeedbackClick(1);\r\n              }}\r\n            >\r\n              <UpIcon sx={iconSx} />\r\n            </IconButton>\r\n          </span>\r\n        </Tooltip>\r\n      ),\r\n      () => (\r\n        <Tooltip title=\"Not helpful\">\r\n          <span>\r\n            <IconButton\r\n              color=\"inherit\"\r\n              disabled={disabled}\r\n              className={`negative-feedback-${feedback === -1 ? 'on' : 'off'}`}\r\n              onClick={() => {\r\n                handleFeedbackClick(-1);\r\n              }}\r\n            >\r\n              <DownIcon sx={iconSx} />\r\n            </IconButton>\r\n          </span>\r\n        </Tooltip>\r\n      )\r\n    ];\r\n\r\n    if (comment) {\r\n      baseButtons.push(() => (\r\n        <Tooltip title=\"Feedback\">\r\n          <span>\r\n            <IconButton\r\n              color=\"inherit\"\r\n              disabled={disabled}\r\n              onClick={() => {\r\n                setShowFeedbackDialog(feedback);\r\n                setCommentInput(comment);\r\n              }}\r\n              className=\"feedback-comment-edit\"\r\n            >\r\n              <StickyNote2Outlined sx={iconSx} />\r\n            </IconButton>\r\n          </span>\r\n        </Tooltip>\r\n      ));\r\n    }\r\n\r\n    return baseButtons;\r\n  }, [feedback, comment, disabled]);\r\n\r\n  return (\r\n    <>\r\n      <Stack direction=\"row\">\r\n        {buttons.map((FeedbackButton, index) => (\r\n          <FeedbackButton key={`feedback-button-${index}`} />\r\n        ))}\r\n      </Stack>\r\n\r\n      <Dialog\r\n        maxWidth=\"xs\"\r\n        onClose={() => {\r\n          setShowFeedbackDialog(undefined);\r\n        }}\r\n        open={!!showFeedbackDialog}\r\n        title={\r\n          <Stack direction=\"row\" alignItems=\"center\" gap={2}>\r\n            {showFeedbackDialog === -1 ? <DownIcon /> : <UpIcon />}\r\n            Provide additional feedback\r\n          </Stack>\r\n        }\r\n        content={\r\n          <TextInput\r\n            id=\"feedbackDescription\"\r\n            value={commentInput}\r\n            multiline\r\n            size=\"medium\"\r\n            onChange={(e) => {\r\n              if (e.target.value === '') {\r\n                setCommentInput(undefined);\r\n              } else {\r\n                setCommentInput(e.target.value);\r\n              }\r\n            }}\r\n          />\r\n        }\r\n        actions={\r\n          <AccentButton\r\n            id=\"feedbackSubmit\"\r\n            type=\"submit\"\r\n            variant=\"outlined\"\r\n            onClick={() => {\r\n              if (showFeedbackDialog != null) {\r\n                handleFeedbackChanged(showFeedbackDialog, commentInput);\r\n              }\r\n              setShowFeedbackDialog(undefined);\r\n              setCommentInput(undefined);\r\n            }}\r\n            autoFocus\r\n          >\r\n            Submit feedback\r\n          </AccentButton>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n};\r\n\r\nexport { FeedbackButtons };\r\n","import { ReactNode } from 'react';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport MDialog, { DialogProps as MDialogProps } from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport grey from '@mui/material/colors/grey';\r\n\r\ntype DialogProps = {\r\n  actions?: ReactNode;\r\n  content?: ReactNode;\r\n  title?: ReactNode;\r\n} & Omit<MDialogProps, 'content' | 'title'>;\r\n\r\nconst Dialog = ({ actions, content, title, ...rest }: DialogProps) => {\r\n  return (\r\n    <MDialog\r\n      {...rest}\r\n      fullWidth\r\n      sx={{\r\n        border: (theme) =>\r\n          theme.palette.mode === 'dark' ? `1px solid ${grey[800]}` : null,\r\n        borderRadius: 1\r\n      }}\r\n    >\r\n      <Box bgcolor=\"background.paper\">\r\n        {title ? (\r\n          <DialogTitle>\r\n            <>{title}</>\r\n          </DialogTitle>\r\n        ) : null}\r\n\r\n        {content ? <DialogContent>{content}</DialogContent> : null}\r\n\r\n        {actions ? (\r\n          <DialogActions sx={{ padding: (theme) => theme.spacing(0, 3, 2) }}>\r\n            <>{actions}</>\r\n          </DialogActions>\r\n        ) : null}\r\n      </Box>\r\n    </MDialog>\r\n  );\r\n};\r\n\r\nexport default Dialog;\r\n","import { MessageContext } from 'contexts/MessageContext';\r\nimport { useContext } from 'react';\r\n\r\nimport Terminal from '@mui/icons-material/Terminal';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\nimport type { IStep } from 'client-types/';\r\n\r\ninterface Props {\r\n  step: IStep;\r\n}\r\n\r\nconst PlaygroundButton = ({ step }: Props) => {\r\n  const { onPlaygroundButtonClick } = useContext(MessageContext);\r\n\r\n  return (\r\n    <Tooltip title=\"Inspect in prompt playground\">\r\n      <IconButton\r\n        color=\"inherit\"\r\n        className=\"playground-button\"\r\n        onClick={() => {\r\n          onPlaygroundButtonClick && onPlaygroundButtonClick(step);\r\n        }}\r\n      >\r\n        <Terminal sx={{ width: '18px', height: '18px' }} />\r\n      </IconButton>\r\n    </Tooltip>\r\n  );\r\n};\r\n\r\nexport { PlaygroundButton };\r\n","import { memo } from 'react';\r\nimport { Collapse } from 'src/Collapse';\r\nimport { Markdown } from 'src/Markdown';\r\nimport { InlinedElements } from 'src/elements/InlinedElements';\r\nimport { prepareContent } from 'utils/message';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Divider from '@mui/material/Divider';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport type { IMessageElement, IStep } from 'client-types/';\r\n\r\nconst COLLAPSE_MIN_LINES = 25; // Set this to the maximum number of lines you want to display before collapsing\r\nconst COLLAPSE_MIN_LENGTH = 3000; // Set this to the maximum number of characters you want to display before collapsing\r\n\r\nexport interface Props {\r\n  elements: IMessageElement[];\r\n  message: IStep;\r\n  preserveSize?: boolean;\r\n  allowHtml?: boolean;\r\n  latex?: boolean;\r\n}\r\n\r\nconst MessageContent = memo(\r\n  ({ message, elements, preserveSize, allowHtml, latex }: Props) => {\r\n    const isUser = 'role' in message && message.role === 'user';\r\n\r\n    let lineCount = 0;\r\n    let contentLength = 0;\r\n\r\n    const {\r\n      preparedContent: output,\r\n      inlinedElements: outputInlinedElements,\r\n      refElements: outputRefElements,\r\n    } = prepareContent({\r\n      elements,\r\n      id: message.id,\r\n      content: message.output,\r\n      language: message.language,\r\n    });\r\n    lineCount += output.split('\\n').length;\r\n    contentLength += output.length;\r\n\r\n    const outputMarkdown = (\r\n      <Markdown\r\n        allowHtml={allowHtml}\r\n        latex={latex}\r\n        refElements={outputRefElements}\r\n      >\r\n        {output}\r\n      </Markdown>\r\n    );\r\n\r\n    let inputMarkdown;\r\n\r\n    if (message.input && message.showInput) {\r\n      const { preparedContent: input, refElements: inputRefElements } =\r\n        prepareContent({\r\n          elements,\r\n          id: message.id,\r\n          content: message.input,\r\n          language:\r\n            typeof message.showInput === 'string'\r\n              ? message.showInput\r\n              : undefined,\r\n        });\r\n      lineCount += input.split('\\n').length;\r\n      contentLength += input.length;\r\n\r\n      inputMarkdown = (\r\n        <Markdown\r\n          allowHtml={allowHtml}\r\n          latex={latex}\r\n          refElements={inputRefElements}\r\n        >\r\n          {input}\r\n        </Markdown>\r\n      );\r\n    }\r\n\r\n    const markdownContent = (\r\n      <Typography\r\n        sx={{\r\n          width: '100%',\r\n          minHeight: '20px',\r\n          fontSize: '1rem',\r\n          lineHeight: '1.5rem',\r\n          fontFamily: (theme) => theme.typography.fontFamily,\r\n          fontWeight: isUser ? 500 : 300,\r\n        }}\r\n        component=\"div\"\r\n      >\r\n        {inputMarkdown}\r\n        {inputMarkdown && outputMarkdown ? <Divider sx={{ my: 1 }} /> : null}\r\n        {outputMarkdown}\r\n      </Typography>\r\n    );\r\n\r\n    const collapse =\r\n      lineCount > COLLAPSE_MIN_LINES || contentLength > COLLAPSE_MIN_LENGTH;\r\n\r\n    const messageContent = collapse ? (\r\n      <Collapse defaultExpandAll={preserveSize}>{markdownContent}</Collapse>\r\n    ) : (\r\n      markdownContent\r\n    );\r\n\r\n    return (\r\n      <Stack width=\"100%\" direction=\"row\">\r\n        <Box width=\"100%\" sx={{ minWidth: '100px' }}>\r\n          {output ? messageContent : null}\r\n          <InlinedElements elements={outputInlinedElements} />\r\n        </Box>\r\n      </Stack>\r\n    );\r\n  }\r\n);\r\n\r\nexport { MessageContent };\r\n","import { useToggle } from 'usehooks-ts';\r\n\r\nimport ExpandLess from '@mui/icons-material/ExpandLess';\r\nimport ExpandMore from '@mui/icons-material/ExpandMore';\r\nimport Box from '@mui/material/Box';\r\nimport MCollapse from '@mui/material/Collapse';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Stack from '@mui/material/Stack';\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\ninterface CollapseProps {\r\n  children: React.ReactNode;\r\n  defaultExpandAll?: boolean;\r\n}\r\n\r\nconst Collapse = ({\r\n  children,\r\n  defaultExpandAll = false\r\n}: CollapseProps): JSX.Element => {\r\n  const [expandAll, toggleExpandAll] = useToggle(defaultExpandAll);\r\n\r\n  const content = (\r\n    <Box height={expandAll ? 'auto' : 100} position=\"relative\">\r\n      <Box\r\n        position={expandAll ? 'relative' : 'absolute'}\r\n        top={0}\r\n        left={0}\r\n        right={0}\r\n        bottom={0}\r\n      >\r\n        {children}\r\n      </Box>\r\n    </Box>\r\n  );\r\n\r\n  return (\r\n    <Box>\r\n      <MCollapse in={expandAll} collapsedSize={100} timeout={0}>\r\n        {content}\r\n      </MCollapse>\r\n      <Stack direction=\"row\" justifyContent=\"end\">\r\n        <Tooltip title={expandAll ? 'Collapse' : 'Expand'}>\r\n          <IconButton onClick={toggleExpandAll}>\r\n            {expandAll ? <ExpandLess /> : <ExpandMore />}\r\n          </IconButton>\r\n        </Tooltip>\r\n      </Stack>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport { Collapse };\r\n","import type { IMessageElement } from 'client-types/';\r\n\r\nconst isForIdMatch = (id: string | number | undefined, forId: string) => {\r\n  if (!forId || !id) {\r\n    return false;\r\n  }\r\n\r\n  return forId === id.toString();\r\n};\r\n\r\nconst escapeRegExp = (string: string) => {\r\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#escaping\r\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\r\n};\r\n\r\nexport const prepareContent = ({\r\n  elements,\r\n  content,\r\n  id,\r\n  language\r\n}: {\r\n  elements: IMessageElement[];\r\n  content?: string;\r\n  id: string;\r\n  language?: string;\r\n}) => {\r\n  const elementNames = elements.map((e) => escapeRegExp(e.name));\r\n\r\n  // Sort by descending length to avoid matching substrings\r\n  elementNames.sort((a, b) => b.length - a.length);\r\n\r\n  const elementRegexp = elementNames.length\r\n    ? new RegExp(`(${elementNames.join('|')})`, 'g')\r\n    : undefined;\r\n\r\n  let preparedContent = content ? content.trim() : '';\r\n  const inlinedElements = elements.filter(\r\n    (e) => isForIdMatch(id, e?.forId) && e.display === 'inline'\r\n  );\r\n  const refElements: IMessageElement[] = [];\r\n\r\n  if (elementRegexp) {\r\n    preparedContent = preparedContent.replaceAll(elementRegexp, (match) => {\r\n      const element = elements.find((e) => {\r\n        const nameMatch = e.name === match;\r\n        const scopeMatch = isForIdMatch(id, e?.forId);\r\n        return nameMatch && scopeMatch;\r\n      });\r\n      const foundElement = !!element;\r\n\r\n      const inlined = element?.display === 'inline';\r\n      if (!foundElement) {\r\n        // Element reference does not exist, return plain text\r\n        return match;\r\n      } else if (inlined) {\r\n        // If element is inlined, add it to the list and return plain text\r\n        if (inlinedElements.indexOf(element) === -1) {\r\n          inlinedElements.push(element);\r\n        }\r\n        return match;\r\n      } else {\r\n        // Element is a reference, add it to the list and return link\r\n        refElements.push(element);\r\n        // spaces break markdown links. The address in the link is not used anyway\r\n        return `[${match}](${match.replaceAll(' ', '_')})`;\r\n      }\r\n    });\r\n  }\r\n\r\n  if (language) {\r\n    const prefix = `\\`\\`\\`${language}`;\r\n    const suffix = '```';\r\n    if (!preparedContent.startsWith('```')) {\r\n      preparedContent = `${prefix}\\n${preparedContent}\\n${suffix}`;\r\n    }\r\n  }\r\n  return {\r\n    preparedContent,\r\n    inlinedElements,\r\n    refElements\r\n  };\r\n};\r\n","import { createContext } from 'react';\r\n\r\nimport { IPlaygroundContext } from 'src/types/playgroundContext';\r\n\r\nconst defaultPlaygroundContext: IPlaygroundContext = {\r\n  setVariableName: () => undefined,\r\n  setFunctionIndex: () => undefined,\r\n  setPromptMode: () => undefined,\r\n  setPlayground: () => undefined,\r\n  onNotification: () => undefined,\r\n  promptMode: 'Formatted'\r\n};\r\n\r\nconst PlaygroundContext = createContext<IPlaygroundContext>(\r\n  defaultPlaygroundContext\r\n);\r\n\r\nexport { PlaygroundContext, defaultPlaygroundContext };\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { useContext, useRef, useState } from 'react';\r\nimport { ErrorBoundary } from 'src/ErrorBoundary';\r\nimport { useToggle } from 'usehooks-ts';\r\n\r\nimport RestoreIcon from '@mui/icons-material/Restore';\r\nimport { Chip } from '@mui/material';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Stack from '@mui/material/Stack';\r\nimport Tooltip from '@mui/material/Tooltip';\r\nimport { useTheme } from '@mui/material/styles';\r\nimport useMediaQuery from '@mui/material/useMediaQuery';\r\n\r\nimport { IPlayground } from 'src/types/playground';\r\nimport { IPlaygroundContext } from 'src/types/playgroundContext';\r\n\r\nimport ActionBar from './actionBar';\r\nimport BasicPromptPlayground from './basic';\r\nimport ChatPromptPlayground from './chat';\r\nimport FunctionModal from './editor/functionModal';\r\nimport VariableModal from './editor/variableModal';\r\nimport PlaygroundHeader from './header';\r\nimport ModelSettings from './modelSettings';\r\nimport SubmitButton from './submitButton';\r\n\r\ninterface Props {\r\n  context: IPlaygroundContext;\r\n}\r\n\r\nfunction _PromptPlayground() {\r\n  const { playground, setPlayground } = useContext(PlaygroundContext);\r\n  const [restoredTime, setRestoredTime] = useState(0);\r\n  const [isDrawerOpen, toggleDrawer] = useToggle(false);\r\n  const chatPromptScrollRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  const theme = useTheme();\r\n  const isSmallScreen = useMediaQuery(theme.breakpoints.down('md'));\r\n\r\n  const showToggleDrawerButton = isSmallScreen && !!playground?.providers;\r\n\r\n  const restore = () => {\r\n    if (playground?.generation) {\r\n      setPlayground((old?: IPlayground) => ({\r\n        ...old,\r\n        generation: old?.originalGeneration\r\n      }));\r\n      setRestoredTime((old) => old + 1);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setPlayground((old) => ({\r\n      ...old,\r\n      generation: undefined,\r\n      originalGeneration: undefined\r\n    }));\r\n  };\r\n\r\n  const generation = playground?.generation;\r\n\r\n  const isChat = generation?.type === 'CHAT';\r\n\r\n  const hasTemplate = false;\r\n\r\n  if (!generation) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <Dialog\r\n      open={!!generation}\r\n      fullScreen\r\n      PaperProps={{\r\n        style: {\r\n          backgroundColor: theme.palette.background.default,\r\n          backgroundImage: 'none'\r\n        }\r\n      }}\r\n      onClose={handleClose}\r\n      id=\"playground\"\r\n      aria-labelledby=\"playground\"\r\n      aria-describedby=\"playground\"\r\n    >\r\n      <DialogTitle sx={{ display: 'flex', flexDirection: 'column' }}>\r\n        <PlaygroundHeader\r\n          hasTemplate={hasTemplate}\r\n          showToggleDrawerButton={showToggleDrawerButton}\r\n          toggleDrawer={toggleDrawer}\r\n          handleClose={handleClose}\r\n        />\r\n      </DialogTitle>\r\n      <DialogContent sx={{ display: 'flex', direction: 'row', padding: 3 }}>\r\n        <ErrorBoundary prefix=\"Prompt Playground error\">\r\n          <Stack gap={3} width=\"100%\">\r\n            <Stack\r\n              direction=\"row\"\r\n              spacing={1.5}\r\n              sx={{\r\n                overflowY: 'auto',\r\n                paddingBottom: 2,\r\n                height: '100%'\r\n              }}\r\n            >\r\n              <FunctionModal />\r\n              <VariableModal />\r\n              {isChat ? (\r\n                <ChatPromptPlayground\r\n                  ref={chatPromptScrollRef}\r\n                  restoredTime={restoredTime}\r\n                  hasTemplate={hasTemplate}\r\n                  generation={generation}\r\n                />\r\n              ) : (\r\n                <BasicPromptPlayground\r\n                  restoredTime={restoredTime}\r\n                  hasTemplate={hasTemplate}\r\n                  generation={generation}\r\n                />\r\n              )}\r\n            </Stack>\r\n          </Stack>\r\n          <ModelSettings\r\n            isSmallScreen={isSmallScreen}\r\n            isDrawerOpen={isDrawerOpen}\r\n            toggleDrawer={toggleDrawer}\r\n          />\r\n        </ErrorBoundary>\r\n      </DialogContent>\r\n\r\n      <ActionBar>\r\n        {generation.tokenCount ? (\r\n          <Chip label={`${generation.tokenCount} tokens`} />\r\n        ) : null}\r\n        <Tooltip title=\"Restore original\">\r\n          <IconButton onClick={restore}>\r\n            <RestoreIcon />\r\n          </IconButton>\r\n        </Tooltip>\r\n        <SubmitButton\r\n          onSubmit={() => {\r\n            if (!chatPromptScrollRef?.current) return;\r\n\r\n            chatPromptScrollRef.current.scrollTop =\r\n              chatPromptScrollRef.current.scrollHeight;\r\n          }}\r\n        />\r\n      </ActionBar>\r\n    </Dialog>\r\n  );\r\n}\r\n\r\nconst PromptPlayground = ({ context }: Props) => {\r\n  return (\r\n    <PlaygroundContext.Provider value={context}>\r\n      <_PromptPlayground />\r\n    </PlaygroundContext.Provider>\r\n  );\r\n};\r\n\r\nexport { PromptPlayground };\r\n","import { PropsWithChildren } from 'react';\r\n\r\nimport Stack from '@mui/material/Stack';\r\n\r\nexport default function ActionBar({ children }: PropsWithChildren) {\r\n  return (\r\n    <Stack\r\n      direction=\"row\"\r\n      sx={{\r\n        backgroundColor: (theme) => theme.palette.background.paper,\r\n        padding: '16px 24px',\r\n        alignItems: 'center',\r\n        justifyContent: 'flex-end',\r\n        gap: 2\r\n      }}\r\n    >\r\n      {children}\r\n    </Stack>\r\n  );\r\n}\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { EditorState } from 'draft-js';\r\nimport { useContext } from 'react';\r\n\r\nimport Alert from '@mui/material/Alert';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport type { ICompletionGeneration } from 'client-types/';\r\n\r\nimport Completion from './editor/completion';\r\nimport FormattedEditor from './editor/formatted';\r\n\r\ninterface Props {\r\n  generation: ICompletionGeneration;\r\n  hasTemplate: boolean;\r\n  restoredTime: number;\r\n}\r\n\r\nexport default function BasicPromptPlayground({\r\n  generation,\r\n  restoredTime\r\n}: Props) {\r\n  const { promptMode, setPlayground } = useContext(PlaygroundContext);\r\n\r\n  const onFormattedChange = (nextState: EditorState) => {\r\n    const formatted = nextState.getCurrentContent().getPlainText();\r\n    setPlayground((old) => ({\r\n      ...old,\r\n      generation: {\r\n        ...old!.generation!,\r\n        formatted\r\n      }\r\n    }));\r\n  };\r\n\r\n  const renderFormatted = () => {\r\n    if (typeof generation.prompt === 'string') {\r\n      return (\r\n        <FormattedEditor\r\n          showTitle={true}\r\n          formatted={generation.prompt || ''}\r\n          inputs={generation.variables || {}}\r\n          format={'f-string'}\r\n          readOnly={false}\r\n          onChange={onFormattedChange}\r\n        />\r\n      );\r\n    } else {\r\n      return (\r\n        <Alert severity=\"error\">\r\n          Neither template or formatted prompt provided.\r\n        </Alert>\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Stack\r\n      flex={1}\r\n      key={restoredTime} // This will re-mount the component with restored prompt\r\n      width=\"100%\"\r\n    >\r\n      {promptMode === 'Formatted' ? renderFormatted() : null}\r\n      <Completion completion={generation.completion} />\r\n    </Stack>\r\n  );\r\n}\r\n","import { Editor, EditorState, Modifier, SelectionState } from 'draft-js';\r\nimport { OrderedSet } from 'immutable';\r\nimport { useEffect, useState } from 'react';\r\nimport EditorWrapper from 'src/playground/editor/EditorWrapper';\r\nimport { grey } from 'theme';\r\n\r\nimport ExpandLessIcon from '@mui/icons-material/ExpandLess';\r\nimport ExpandMoreIcon from '@mui/icons-material/ExpandMore';\r\nimport Box from '@mui/material/Box';\r\nimport Typography from '@mui/material/Box';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport 'draft-js/dist/Draft.css';\r\n\r\nimport MessageWrapper from './MessageWrapper';\r\n\r\ninterface Props {\r\n  completion?: string;\r\n  chatMode?: boolean;\r\n}\r\n\r\nexport default function Completion({ completion, chatMode }: Props) {\r\n  const [state, setState] = useState(EditorState.createEmpty());\r\n  const [isCompletionOpen, setCompletionOpen] = useState(true);\r\n\r\n  useEffect(() => {\r\n    let _state = EditorState.createEmpty();\r\n    if (completion) {\r\n      _state = insertCompletion(_state, completion);\r\n    }\r\n\r\n    setState(_state);\r\n    setCompletionOpen(true);\r\n  }, [completion]);\r\n\r\n  const insertCompletion = (state: EditorState, completion: string) => {\r\n    const contentState = state.getCurrentContent();\r\n\r\n    const blockMap = contentState.getBlockMap();\r\n    const key = blockMap.last().getKey();\r\n    const length = blockMap.last().getLength();\r\n    const selection = new SelectionState({\r\n      anchorKey: key,\r\n      anchorOffset: length,\r\n      focusKey: key,\r\n      focusOffset: length\r\n    });\r\n\r\n    const ncs = Modifier.insertText(\r\n      contentState,\r\n      selection,\r\n      completion,\r\n      OrderedSet.of('COMPLETION')\r\n    );\r\n    const es = EditorState.push(state, ncs, 'insert-characters');\r\n    return EditorState.forceSelection(es, ncs.getSelectionAfter());\r\n  };\r\n\r\n  const renderEditor = () => (\r\n    <EditorWrapper\r\n      className=\"completion-editor\"\r\n      clipboardValue={state.getCurrentContent().getPlainText()}\r\n      sxChildren={{\r\n        borderColor: (theme) => theme.palette.success.main,\r\n        '&:hover': {\r\n          borderColor: (theme) => theme.palette.success.main\r\n        }\r\n      }}\r\n    >\r\n      <Editor\r\n        editorState={state}\r\n        onChange={(nextState) => {\r\n          // Read only mode, force content but preserve selection\r\n          nextState = EditorState.push(\r\n            nextState,\r\n            state.getCurrentContent(),\r\n            'insert-characters'\r\n          );\r\n          setState(nextState);\r\n        }}\r\n      />\r\n    </EditorWrapper>\r\n  );\r\n\r\n  return !chatMode ? (\r\n    <Box marginTop={2}>\r\n      <Stack\r\n        sx={{\r\n          flexDirection: 'row',\r\n          alignItems: 'center',\r\n          justifyContent: 'space-between',\r\n          paddingRight: '6px'\r\n        }}\r\n      >\r\n        <Typography fontSize=\"14px\" fontWeight={700} color={grey[400]}>\r\n          Completion\r\n        </Typography>\r\n        <IconButton onClick={() => setCompletionOpen(!isCompletionOpen)}>\r\n          {isCompletionOpen ? <ExpandLessIcon /> : <ExpandMoreIcon />}\r\n        </IconButton>\r\n      </Stack>\r\n      <Box\r\n        sx={{\r\n          border: (theme) => `1px solid ${theme.palette.divider}`,\r\n          borderRadius: 1,\r\n          marginTop: 1\r\n        }}\r\n      />\r\n      <Box\r\n        sx={{\r\n          maxHeight: isCompletionOpen ? '220px' : '0px',\r\n          transition: 'max-height 0.5s ease-in-out',\r\n          overflow: 'auto',\r\n          marginTop: 2\r\n        }}\r\n      >\r\n        {renderEditor()}\r\n      </Box>\r\n    </Box>\r\n  ) : (\r\n    <MessageWrapper role=\"ASSISTANT\">{renderEditor()}</MessageWrapper>\r\n  );\r\n}\r\n","/**\n * MIT License\n * \n * Copyright (c) 2014-present, Lee Byron and other contributors.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\nvar DELETE = 'delete';\n\n// Constants describing the size of trie nodes.\nvar SHIFT = 5; // Resulted in best performance after ______?\nvar SIZE = 1 << SHIFT;\nvar MASK = SIZE - 1;\n\n// A consistent shared value representing \"not set\" which equals nothing other\n// than itself, and nothing that could be provided externally.\nvar NOT_SET = {};\n\n// Boolean references, Rough equivalent of `bool &`.\nfunction MakeRef() {\n  return { value: false };\n}\n\nfunction SetRef(ref) {\n  if (ref) {\n    ref.value = true;\n  }\n}\n\n// A function which returns a value representing an \"owner\" for transient writes\n// to tries. The return value will only ever equal itself, and will not equal\n// the return of any subsequent call of this function.\nfunction OwnerID() {}\n\nfunction ensureSize(iter) {\n  if (iter.size === undefined) {\n    iter.size = iter.__iterate(returnTrue);\n  }\n  return iter.size;\n}\n\nfunction wrapIndex(iter, index) {\n  // This implements \"is array index\" which the ECMAString spec defines as:\n  //\n  //     A String property name P is an array index if and only if\n  //     ToString(ToUint32(P)) is equal to P and ToUint32(P) is not equal\n  //     to 2^321.\n  //\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-array-exotic-objects\n  if (typeof index !== 'number') {\n    var uint32Index = index >>> 0; // N >>> 0 is shorthand for ToUint32\n    if ('' + uint32Index !== index || uint32Index === 4294967295) {\n      return NaN;\n    }\n    index = uint32Index;\n  }\n  return index < 0 ? ensureSize(iter) + index : index;\n}\n\nfunction returnTrue() {\n  return true;\n}\n\nfunction wholeSlice(begin, end, size) {\n  return (\n    ((begin === 0 && !isNeg(begin)) ||\n      (size !== undefined && begin <= -size)) &&\n    (end === undefined || (size !== undefined && end >= size))\n  );\n}\n\nfunction resolveBegin(begin, size) {\n  return resolveIndex(begin, size, 0);\n}\n\nfunction resolveEnd(end, size) {\n  return resolveIndex(end, size, size);\n}\n\nfunction resolveIndex(index, size, defaultIndex) {\n  // Sanitize indices using this shorthand for ToInt32(argument)\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n  return index === undefined\n    ? defaultIndex\n    : isNeg(index)\n    ? size === Infinity\n      ? size\n      : Math.max(0, size + index) | 0\n    : size === undefined || size === index\n    ? index\n    : Math.min(size, index) | 0;\n}\n\nfunction isNeg(value) {\n  // Account for -0 which is negative, but not less than 0.\n  return value < 0 || (value === 0 && 1 / value === -Infinity);\n}\n\nvar IS_COLLECTION_SYMBOL = '@@__IMMUTABLE_ITERABLE__@@';\n\nfunction isCollection(maybeCollection) {\n  return Boolean(maybeCollection && maybeCollection[IS_COLLECTION_SYMBOL]);\n}\n\nvar IS_KEYED_SYMBOL = '@@__IMMUTABLE_KEYED__@@';\n\nfunction isKeyed(maybeKeyed) {\n  return Boolean(maybeKeyed && maybeKeyed[IS_KEYED_SYMBOL]);\n}\n\nvar IS_INDEXED_SYMBOL = '@@__IMMUTABLE_INDEXED__@@';\n\nfunction isIndexed(maybeIndexed) {\n  return Boolean(maybeIndexed && maybeIndexed[IS_INDEXED_SYMBOL]);\n}\n\nfunction isAssociative(maybeAssociative) {\n  return isKeyed(maybeAssociative) || isIndexed(maybeAssociative);\n}\n\nvar Collection = function Collection(value) {\n  return isCollection(value) ? value : Seq(value);\n};\n\nvar KeyedCollection = /*@__PURE__*/(function (Collection) {\n  function KeyedCollection(value) {\n    return isKeyed(value) ? value : KeyedSeq(value);\n  }\n\n  if ( Collection ) KeyedCollection.__proto__ = Collection;\n  KeyedCollection.prototype = Object.create( Collection && Collection.prototype );\n  KeyedCollection.prototype.constructor = KeyedCollection;\n\n  return KeyedCollection;\n}(Collection));\n\nvar IndexedCollection = /*@__PURE__*/(function (Collection) {\n  function IndexedCollection(value) {\n    return isIndexed(value) ? value : IndexedSeq(value);\n  }\n\n  if ( Collection ) IndexedCollection.__proto__ = Collection;\n  IndexedCollection.prototype = Object.create( Collection && Collection.prototype );\n  IndexedCollection.prototype.constructor = IndexedCollection;\n\n  return IndexedCollection;\n}(Collection));\n\nvar SetCollection = /*@__PURE__*/(function (Collection) {\n  function SetCollection(value) {\n    return isCollection(value) && !isAssociative(value) ? value : SetSeq(value);\n  }\n\n  if ( Collection ) SetCollection.__proto__ = Collection;\n  SetCollection.prototype = Object.create( Collection && Collection.prototype );\n  SetCollection.prototype.constructor = SetCollection;\n\n  return SetCollection;\n}(Collection));\n\nCollection.Keyed = KeyedCollection;\nCollection.Indexed = IndexedCollection;\nCollection.Set = SetCollection;\n\nvar IS_SEQ_SYMBOL = '@@__IMMUTABLE_SEQ__@@';\n\nfunction isSeq(maybeSeq) {\n  return Boolean(maybeSeq && maybeSeq[IS_SEQ_SYMBOL]);\n}\n\nvar IS_RECORD_SYMBOL = '@@__IMMUTABLE_RECORD__@@';\n\nfunction isRecord(maybeRecord) {\n  return Boolean(maybeRecord && maybeRecord[IS_RECORD_SYMBOL]);\n}\n\nfunction isImmutable(maybeImmutable) {\n  return isCollection(maybeImmutable) || isRecord(maybeImmutable);\n}\n\nvar IS_ORDERED_SYMBOL = '@@__IMMUTABLE_ORDERED__@@';\n\nfunction isOrdered(maybeOrdered) {\n  return Boolean(maybeOrdered && maybeOrdered[IS_ORDERED_SYMBOL]);\n}\n\nvar ITERATE_KEYS = 0;\nvar ITERATE_VALUES = 1;\nvar ITERATE_ENTRIES = 2;\n\nvar REAL_ITERATOR_SYMBOL = typeof Symbol === 'function' && Symbol.iterator;\nvar FAUX_ITERATOR_SYMBOL = '@@iterator';\n\nvar ITERATOR_SYMBOL = REAL_ITERATOR_SYMBOL || FAUX_ITERATOR_SYMBOL;\n\nvar Iterator = function Iterator(next) {\n  this.next = next;\n};\n\nIterator.prototype.toString = function toString () {\n  return '[Iterator]';\n};\n\nIterator.KEYS = ITERATE_KEYS;\nIterator.VALUES = ITERATE_VALUES;\nIterator.ENTRIES = ITERATE_ENTRIES;\n\nIterator.prototype.inspect = Iterator.prototype.toSource = function () {\n  return this.toString();\n};\nIterator.prototype[ITERATOR_SYMBOL] = function () {\n  return this;\n};\n\nfunction iteratorValue(type, k, v, iteratorResult) {\n  var value = type === 0 ? k : type === 1 ? v : [k, v];\n  iteratorResult\n    ? (iteratorResult.value = value)\n    : (iteratorResult = {\n        value: value,\n        done: false,\n      });\n  return iteratorResult;\n}\n\nfunction iteratorDone() {\n  return { value: undefined, done: true };\n}\n\nfunction hasIterator(maybeIterable) {\n  if (Array.isArray(maybeIterable)) {\n    // IE11 trick as it does not support `Symbol.iterator`\n    return true;\n  }\n\n  return !!getIteratorFn(maybeIterable);\n}\n\nfunction isIterator(maybeIterator) {\n  return maybeIterator && typeof maybeIterator.next === 'function';\n}\n\nfunction getIterator(iterable) {\n  var iteratorFn = getIteratorFn(iterable);\n  return iteratorFn && iteratorFn.call(iterable);\n}\n\nfunction getIteratorFn(iterable) {\n  var iteratorFn =\n    iterable &&\n    ((REAL_ITERATOR_SYMBOL && iterable[REAL_ITERATOR_SYMBOL]) ||\n      iterable[FAUX_ITERATOR_SYMBOL]);\n  if (typeof iteratorFn === 'function') {\n    return iteratorFn;\n  }\n}\n\nfunction isEntriesIterable(maybeIterable) {\n  var iteratorFn = getIteratorFn(maybeIterable);\n  return iteratorFn && iteratorFn === maybeIterable.entries;\n}\n\nfunction isKeysIterable(maybeIterable) {\n  var iteratorFn = getIteratorFn(maybeIterable);\n  return iteratorFn && iteratorFn === maybeIterable.keys;\n}\n\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction isArrayLike(value) {\n  if (Array.isArray(value) || typeof value === 'string') {\n    return true;\n  }\n\n  return (\n    value &&\n    typeof value === 'object' &&\n    Number.isInteger(value.length) &&\n    value.length >= 0 &&\n    (value.length === 0\n      ? // Only {length: 0} is considered Array-like.\n        Object.keys(value).length === 1\n      : // An object is only Array-like if it has a property where the last value\n        // in the array-like may be found (which could be undefined).\n        value.hasOwnProperty(value.length - 1))\n  );\n}\n\nvar Seq = /*@__PURE__*/(function (Collection) {\n  function Seq(value) {\n    return value === undefined || value === null\n      ? emptySequence()\n      : isImmutable(value)\n      ? value.toSeq()\n      : seqFromValue(value);\n  }\n\n  if ( Collection ) Seq.__proto__ = Collection;\n  Seq.prototype = Object.create( Collection && Collection.prototype );\n  Seq.prototype.constructor = Seq;\n\n  Seq.prototype.toSeq = function toSeq () {\n    return this;\n  };\n\n  Seq.prototype.toString = function toString () {\n    return this.__toString('Seq {', '}');\n  };\n\n  Seq.prototype.cacheResult = function cacheResult () {\n    if (!this._cache && this.__iterateUncached) {\n      this._cache = this.entrySeq().toArray();\n      this.size = this._cache.length;\n    }\n    return this;\n  };\n\n  // abstract __iterateUncached(fn, reverse)\n\n  Seq.prototype.__iterate = function __iterate (fn, reverse) {\n    var cache = this._cache;\n    if (cache) {\n      var size = cache.length;\n      var i = 0;\n      while (i !== size) {\n        var entry = cache[reverse ? size - ++i : i++];\n        if (fn(entry[1], entry[0], this) === false) {\n          break;\n        }\n      }\n      return i;\n    }\n    return this.__iterateUncached(fn, reverse);\n  };\n\n  // abstract __iteratorUncached(type, reverse)\n\n  Seq.prototype.__iterator = function __iterator (type, reverse) {\n    var cache = this._cache;\n    if (cache) {\n      var size = cache.length;\n      var i = 0;\n      return new Iterator(function () {\n        if (i === size) {\n          return iteratorDone();\n        }\n        var entry = cache[reverse ? size - ++i : i++];\n        return iteratorValue(type, entry[0], entry[1]);\n      });\n    }\n    return this.__iteratorUncached(type, reverse);\n  };\n\n  return Seq;\n}(Collection));\n\nvar KeyedSeq = /*@__PURE__*/(function (Seq) {\n  function KeyedSeq(value) {\n    return value === undefined || value === null\n      ? emptySequence().toKeyedSeq()\n      : isCollection(value)\n      ? isKeyed(value)\n        ? value.toSeq()\n        : value.fromEntrySeq()\n      : isRecord(value)\n      ? value.toSeq()\n      : keyedSeqFromValue(value);\n  }\n\n  if ( Seq ) KeyedSeq.__proto__ = Seq;\n  KeyedSeq.prototype = Object.create( Seq && Seq.prototype );\n  KeyedSeq.prototype.constructor = KeyedSeq;\n\n  KeyedSeq.prototype.toKeyedSeq = function toKeyedSeq () {\n    return this;\n  };\n\n  return KeyedSeq;\n}(Seq));\n\nvar IndexedSeq = /*@__PURE__*/(function (Seq) {\n  function IndexedSeq(value) {\n    return value === undefined || value === null\n      ? emptySequence()\n      : isCollection(value)\n      ? isKeyed(value)\n        ? value.entrySeq()\n        : value.toIndexedSeq()\n      : isRecord(value)\n      ? value.toSeq().entrySeq()\n      : indexedSeqFromValue(value);\n  }\n\n  if ( Seq ) IndexedSeq.__proto__ = Seq;\n  IndexedSeq.prototype = Object.create( Seq && Seq.prototype );\n  IndexedSeq.prototype.constructor = IndexedSeq;\n\n  IndexedSeq.of = function of (/*...values*/) {\n    return IndexedSeq(arguments);\n  };\n\n  IndexedSeq.prototype.toIndexedSeq = function toIndexedSeq () {\n    return this;\n  };\n\n  IndexedSeq.prototype.toString = function toString () {\n    return this.__toString('Seq [', ']');\n  };\n\n  return IndexedSeq;\n}(Seq));\n\nvar SetSeq = /*@__PURE__*/(function (Seq) {\n  function SetSeq(value) {\n    return (\n      isCollection(value) && !isAssociative(value) ? value : IndexedSeq(value)\n    ).toSetSeq();\n  }\n\n  if ( Seq ) SetSeq.__proto__ = Seq;\n  SetSeq.prototype = Object.create( Seq && Seq.prototype );\n  SetSeq.prototype.constructor = SetSeq;\n\n  SetSeq.of = function of (/*...values*/) {\n    return SetSeq(arguments);\n  };\n\n  SetSeq.prototype.toSetSeq = function toSetSeq () {\n    return this;\n  };\n\n  return SetSeq;\n}(Seq));\n\nSeq.isSeq = isSeq;\nSeq.Keyed = KeyedSeq;\nSeq.Set = SetSeq;\nSeq.Indexed = IndexedSeq;\n\nSeq.prototype[IS_SEQ_SYMBOL] = true;\n\n// #pragma Root Sequences\n\nvar ArraySeq = /*@__PURE__*/(function (IndexedSeq) {\n  function ArraySeq(array) {\n    this._array = array;\n    this.size = array.length;\n  }\n\n  if ( IndexedSeq ) ArraySeq.__proto__ = IndexedSeq;\n  ArraySeq.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  ArraySeq.prototype.constructor = ArraySeq;\n\n  ArraySeq.prototype.get = function get (index, notSetValue) {\n    return this.has(index) ? this._array[wrapIndex(this, index)] : notSetValue;\n  };\n\n  ArraySeq.prototype.__iterate = function __iterate (fn, reverse) {\n    var array = this._array;\n    var size = array.length;\n    var i = 0;\n    while (i !== size) {\n      var ii = reverse ? size - ++i : i++;\n      if (fn(array[ii], ii, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  ArraySeq.prototype.__iterator = function __iterator (type, reverse) {\n    var array = this._array;\n    var size = array.length;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var ii = reverse ? size - ++i : i++;\n      return iteratorValue(type, ii, array[ii]);\n    });\n  };\n\n  return ArraySeq;\n}(IndexedSeq));\n\nvar ObjectSeq = /*@__PURE__*/(function (KeyedSeq) {\n  function ObjectSeq(object) {\n    var keys = Object.keys(object).concat(\n      Object.getOwnPropertySymbols ? Object.getOwnPropertySymbols(object) : []\n    );\n    this._object = object;\n    this._keys = keys;\n    this.size = keys.length;\n  }\n\n  if ( KeyedSeq ) ObjectSeq.__proto__ = KeyedSeq;\n  ObjectSeq.prototype = Object.create( KeyedSeq && KeyedSeq.prototype );\n  ObjectSeq.prototype.constructor = ObjectSeq;\n\n  ObjectSeq.prototype.get = function get (key, notSetValue) {\n    if (notSetValue !== undefined && !this.has(key)) {\n      return notSetValue;\n    }\n    return this._object[key];\n  };\n\n  ObjectSeq.prototype.has = function has (key) {\n    return hasOwnProperty.call(this._object, key);\n  };\n\n  ObjectSeq.prototype.__iterate = function __iterate (fn, reverse) {\n    var object = this._object;\n    var keys = this._keys;\n    var size = keys.length;\n    var i = 0;\n    while (i !== size) {\n      var key = keys[reverse ? size - ++i : i++];\n      if (fn(object[key], key, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  ObjectSeq.prototype.__iterator = function __iterator (type, reverse) {\n    var object = this._object;\n    var keys = this._keys;\n    var size = keys.length;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var key = keys[reverse ? size - ++i : i++];\n      return iteratorValue(type, key, object[key]);\n    });\n  };\n\n  return ObjectSeq;\n}(KeyedSeq));\nObjectSeq.prototype[IS_ORDERED_SYMBOL] = true;\n\nvar CollectionSeq = /*@__PURE__*/(function (IndexedSeq) {\n  function CollectionSeq(collection) {\n    this._collection = collection;\n    this.size = collection.length || collection.size;\n  }\n\n  if ( IndexedSeq ) CollectionSeq.__proto__ = IndexedSeq;\n  CollectionSeq.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  CollectionSeq.prototype.constructor = CollectionSeq;\n\n  CollectionSeq.prototype.__iterateUncached = function __iterateUncached (fn, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var collection = this._collection;\n    var iterator = getIterator(collection);\n    var iterations = 0;\n    if (isIterator(iterator)) {\n      var step;\n      while (!(step = iterator.next()).done) {\n        if (fn(step.value, iterations++, this) === false) {\n          break;\n        }\n      }\n    }\n    return iterations;\n  };\n\n  CollectionSeq.prototype.__iteratorUncached = function __iteratorUncached (type, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var collection = this._collection;\n    var iterator = getIterator(collection);\n    if (!isIterator(iterator)) {\n      return new Iterator(iteratorDone);\n    }\n    var iterations = 0;\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done ? step : iteratorValue(type, iterations++, step.value);\n    });\n  };\n\n  return CollectionSeq;\n}(IndexedSeq));\n\n// # pragma Helper functions\n\nvar EMPTY_SEQ;\n\nfunction emptySequence() {\n  return EMPTY_SEQ || (EMPTY_SEQ = new ArraySeq([]));\n}\n\nfunction keyedSeqFromValue(value) {\n  var seq = maybeIndexedSeqFromValue(value);\n  if (seq) {\n    return seq.fromEntrySeq();\n  }\n  if (typeof value === 'object') {\n    return new ObjectSeq(value);\n  }\n  throw new TypeError(\n    'Expected Array or collection object of [k, v] entries, or keyed object: ' +\n      value\n  );\n}\n\nfunction indexedSeqFromValue(value) {\n  var seq = maybeIndexedSeqFromValue(value);\n  if (seq) {\n    return seq;\n  }\n  throw new TypeError(\n    'Expected Array or collection object of values: ' + value\n  );\n}\n\nfunction seqFromValue(value) {\n  var seq = maybeIndexedSeqFromValue(value);\n  if (seq) {\n    return isEntriesIterable(value)\n      ? seq.fromEntrySeq()\n      : isKeysIterable(value)\n      ? seq.toSetSeq()\n      : seq;\n  }\n  if (typeof value === 'object') {\n    return new ObjectSeq(value);\n  }\n  throw new TypeError(\n    'Expected Array or collection object of values, or keyed object: ' + value\n  );\n}\n\nfunction maybeIndexedSeqFromValue(value) {\n  return isArrayLike(value)\n    ? new ArraySeq(value)\n    : hasIterator(value)\n    ? new CollectionSeq(value)\n    : undefined;\n}\n\nvar IS_MAP_SYMBOL = '@@__IMMUTABLE_MAP__@@';\n\nfunction isMap(maybeMap) {\n  return Boolean(maybeMap && maybeMap[IS_MAP_SYMBOL]);\n}\n\nfunction isOrderedMap(maybeOrderedMap) {\n  return isMap(maybeOrderedMap) && isOrdered(maybeOrderedMap);\n}\n\nfunction isValueObject(maybeValue) {\n  return Boolean(\n    maybeValue &&\n      typeof maybeValue.equals === 'function' &&\n      typeof maybeValue.hashCode === 'function'\n  );\n}\n\n/**\n * An extension of the \"same-value\" algorithm as [described for use by ES6 Map\n * and Set](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map#Key_equality)\n *\n * NaN is considered the same as NaN, however -0 and 0 are considered the same\n * value, which is different from the algorithm described by\n * [`Object.is`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is).\n *\n * This is extended further to allow Objects to describe the values they\n * represent, by way of `valueOf` or `equals` (and `hashCode`).\n *\n * Note: because of this extension, the key equality of Immutable.Map and the\n * value equality of Immutable.Set will differ from ES6 Map and Set.\n *\n * ### Defining custom values\n *\n * The easiest way to describe the value an object represents is by implementing\n * `valueOf`. For example, `Date` represents a value by returning a unix\n * timestamp for `valueOf`:\n *\n *     var date1 = new Date(1234567890000); // Fri Feb 13 2009 ...\n *     var date2 = new Date(1234567890000);\n *     date1.valueOf(); // 1234567890000\n *     assert( date1 !== date2 );\n *     assert( Immutable.is( date1, date2 ) );\n *\n * Note: overriding `valueOf` may have other implications if you use this object\n * where JavaScript expects a primitive, such as implicit string coercion.\n *\n * For more complex types, especially collections, implementing `valueOf` may\n * not be performant. An alternative is to implement `equals` and `hashCode`.\n *\n * `equals` takes another object, presumably of similar type, and returns true\n * if it is equal. Equality is symmetrical, so the same result should be\n * returned if this and the argument are flipped.\n *\n *     assert( a.equals(b) === b.equals(a) );\n *\n * `hashCode` returns a 32bit integer number representing the object which will\n * be used to determine how to store the value object in a Map or Set. You must\n * provide both or neither methods, one must not exist without the other.\n *\n * Also, an important relationship between these methods must be upheld: if two\n * values are equal, they *must* return the same hashCode. If the values are not\n * equal, they might have the same hashCode; this is called a hash collision,\n * and while undesirable for performance reasons, it is acceptable.\n *\n *     if (a.equals(b)) {\n *       assert( a.hashCode() === b.hashCode() );\n *     }\n *\n * All Immutable collections are Value Objects: they implement `equals()`\n * and `hashCode()`.\n */\nfunction is(valueA, valueB) {\n  if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n    return true;\n  }\n  if (!valueA || !valueB) {\n    return false;\n  }\n  if (\n    typeof valueA.valueOf === 'function' &&\n    typeof valueB.valueOf === 'function'\n  ) {\n    valueA = valueA.valueOf();\n    valueB = valueB.valueOf();\n    if (valueA === valueB || (valueA !== valueA && valueB !== valueB)) {\n      return true;\n    }\n    if (!valueA || !valueB) {\n      return false;\n    }\n  }\n  return !!(\n    isValueObject(valueA) &&\n    isValueObject(valueB) &&\n    valueA.equals(valueB)\n  );\n}\n\nvar imul =\n  typeof Math.imul === 'function' && Math.imul(0xffffffff, 2) === -2\n    ? Math.imul\n    : function imul(a, b) {\n        a |= 0; // int\n        b |= 0; // int\n        var c = a & 0xffff;\n        var d = b & 0xffff;\n        // Shift by 0 fixes the sign on the high part.\n        return (c * d + ((((a >>> 16) * d + c * (b >>> 16)) << 16) >>> 0)) | 0; // int\n      };\n\n// v8 has an optimization for storing 31-bit signed numbers.\n// Values which have either 00 or 11 as the high order bits qualify.\n// This function drops the highest order bit in a signed number, maintaining\n// the sign bit.\nfunction smi(i32) {\n  return ((i32 >>> 1) & 0x40000000) | (i32 & 0xbfffffff);\n}\n\nvar defaultValueOf = Object.prototype.valueOf;\n\nfunction hash(o) {\n  if (o == null) {\n    return hashNullish(o);\n  }\n\n  if (typeof o.hashCode === 'function') {\n    // Drop any high bits from accidentally long hash codes.\n    return smi(o.hashCode(o));\n  }\n\n  var v = valueOf(o);\n\n  if (v == null) {\n    return hashNullish(v);\n  }\n\n  switch (typeof v) {\n    case 'boolean':\n      // The hash values for built-in constants are a 1 value for each 5-byte\n      // shift region expect for the first, which encodes the value. This\n      // reduces the odds of a hash collision for these common values.\n      return v ? 0x42108421 : 0x42108420;\n    case 'number':\n      return hashNumber(v);\n    case 'string':\n      return v.length > STRING_HASH_CACHE_MIN_STRLEN\n        ? cachedHashString(v)\n        : hashString(v);\n    case 'object':\n    case 'function':\n      return hashJSObj(v);\n    case 'symbol':\n      return hashSymbol(v);\n    default:\n      if (typeof v.toString === 'function') {\n        return hashString(v.toString());\n      }\n      throw new Error('Value type ' + typeof v + ' cannot be hashed.');\n  }\n}\n\nfunction hashNullish(nullish) {\n  return nullish === null ? 0x42108422 : /* undefined */ 0x42108423;\n}\n\n// Compress arbitrarily large numbers into smi hashes.\nfunction hashNumber(n) {\n  if (n !== n || n === Infinity) {\n    return 0;\n  }\n  var hash = n | 0;\n  if (hash !== n) {\n    hash ^= n * 0xffffffff;\n  }\n  while (n > 0xffffffff) {\n    n /= 0xffffffff;\n    hash ^= n;\n  }\n  return smi(hash);\n}\n\nfunction cachedHashString(string) {\n  var hashed = stringHashCache[string];\n  if (hashed === undefined) {\n    hashed = hashString(string);\n    if (STRING_HASH_CACHE_SIZE === STRING_HASH_CACHE_MAX_SIZE) {\n      STRING_HASH_CACHE_SIZE = 0;\n      stringHashCache = {};\n    }\n    STRING_HASH_CACHE_SIZE++;\n    stringHashCache[string] = hashed;\n  }\n  return hashed;\n}\n\n// http://jsperf.com/hashing-strings\nfunction hashString(string) {\n  // This is the hash from JVM\n  // The hash code for a string is computed as\n  // s[0] * 31 ^ (n - 1) + s[1] * 31 ^ (n - 2) + ... + s[n - 1],\n  // where s[i] is the ith character of the string and n is the length of\n  // the string. We \"mod\" the result to make it between 0 (inclusive) and 2^31\n  // (exclusive) by dropping high bits.\n  var hashed = 0;\n  for (var ii = 0; ii < string.length; ii++) {\n    hashed = (31 * hashed + string.charCodeAt(ii)) | 0;\n  }\n  return smi(hashed);\n}\n\nfunction hashSymbol(sym) {\n  var hashed = symbolMap[sym];\n  if (hashed !== undefined) {\n    return hashed;\n  }\n\n  hashed = nextHash();\n\n  symbolMap[sym] = hashed;\n\n  return hashed;\n}\n\nfunction hashJSObj(obj) {\n  var hashed;\n  if (usingWeakMap) {\n    hashed = weakMap.get(obj);\n    if (hashed !== undefined) {\n      return hashed;\n    }\n  }\n\n  hashed = obj[UID_HASH_KEY];\n  if (hashed !== undefined) {\n    return hashed;\n  }\n\n  if (!canDefineProperty) {\n    hashed = obj.propertyIsEnumerable && obj.propertyIsEnumerable[UID_HASH_KEY];\n    if (hashed !== undefined) {\n      return hashed;\n    }\n\n    hashed = getIENodeHash(obj);\n    if (hashed !== undefined) {\n      return hashed;\n    }\n  }\n\n  hashed = nextHash();\n\n  if (usingWeakMap) {\n    weakMap.set(obj, hashed);\n  } else if (isExtensible !== undefined && isExtensible(obj) === false) {\n    throw new Error('Non-extensible objects are not allowed as keys.');\n  } else if (canDefineProperty) {\n    Object.defineProperty(obj, UID_HASH_KEY, {\n      enumerable: false,\n      configurable: false,\n      writable: false,\n      value: hashed,\n    });\n  } else if (\n    obj.propertyIsEnumerable !== undefined &&\n    obj.propertyIsEnumerable === obj.constructor.prototype.propertyIsEnumerable\n  ) {\n    // Since we can't define a non-enumerable property on the object\n    // we'll hijack one of the less-used non-enumerable properties to\n    // save our hash on it. Since this is a function it will not show up in\n    // `JSON.stringify` which is what we want.\n    obj.propertyIsEnumerable = function () {\n      return this.constructor.prototype.propertyIsEnumerable.apply(\n        this,\n        arguments\n      );\n    };\n    obj.propertyIsEnumerable[UID_HASH_KEY] = hashed;\n  } else if (obj.nodeType !== undefined) {\n    // At this point we couldn't get the IE `uniqueID` to use as a hash\n    // and we couldn't use a non-enumerable property to exploit the\n    // dontEnum bug so we simply add the `UID_HASH_KEY` on the node\n    // itself.\n    obj[UID_HASH_KEY] = hashed;\n  } else {\n    throw new Error('Unable to set a non-enumerable property on object.');\n  }\n\n  return hashed;\n}\n\n// Get references to ES5 object methods.\nvar isExtensible = Object.isExtensible;\n\n// True if Object.defineProperty works as expected. IE8 fails this test.\nvar canDefineProperty = (function () {\n  try {\n    Object.defineProperty({}, '@', {});\n    return true;\n  } catch (e) {\n    return false;\n  }\n})();\n\n// IE has a `uniqueID` property on DOM nodes. We can construct the hash from it\n// and avoid memory leaks from the IE cloneNode bug.\nfunction getIENodeHash(node) {\n  if (node && node.nodeType > 0) {\n    switch (node.nodeType) {\n      case 1: // Element\n        return node.uniqueID;\n      case 9: // Document\n        return node.documentElement && node.documentElement.uniqueID;\n    }\n  }\n}\n\nfunction valueOf(obj) {\n  return obj.valueOf !== defaultValueOf && typeof obj.valueOf === 'function'\n    ? obj.valueOf(obj)\n    : obj;\n}\n\nfunction nextHash() {\n  var nextHash = ++_objHashUID;\n  if (_objHashUID & 0x40000000) {\n    _objHashUID = 0;\n  }\n  return nextHash;\n}\n\n// If possible, use a WeakMap.\nvar usingWeakMap = typeof WeakMap === 'function';\nvar weakMap;\nif (usingWeakMap) {\n  weakMap = new WeakMap();\n}\n\nvar symbolMap = Object.create(null);\n\nvar _objHashUID = 0;\n\nvar UID_HASH_KEY = '__immutablehash__';\nif (typeof Symbol === 'function') {\n  UID_HASH_KEY = Symbol(UID_HASH_KEY);\n}\n\nvar STRING_HASH_CACHE_MIN_STRLEN = 16;\nvar STRING_HASH_CACHE_MAX_SIZE = 255;\nvar STRING_HASH_CACHE_SIZE = 0;\nvar stringHashCache = {};\n\nvar ToKeyedSequence = /*@__PURE__*/(function (KeyedSeq) {\n  function ToKeyedSequence(indexed, useKeys) {\n    this._iter = indexed;\n    this._useKeys = useKeys;\n    this.size = indexed.size;\n  }\n\n  if ( KeyedSeq ) ToKeyedSequence.__proto__ = KeyedSeq;\n  ToKeyedSequence.prototype = Object.create( KeyedSeq && KeyedSeq.prototype );\n  ToKeyedSequence.prototype.constructor = ToKeyedSequence;\n\n  ToKeyedSequence.prototype.get = function get (key, notSetValue) {\n    return this._iter.get(key, notSetValue);\n  };\n\n  ToKeyedSequence.prototype.has = function has (key) {\n    return this._iter.has(key);\n  };\n\n  ToKeyedSequence.prototype.valueSeq = function valueSeq () {\n    return this._iter.valueSeq();\n  };\n\n  ToKeyedSequence.prototype.reverse = function reverse () {\n    var this$1$1 = this;\n\n    var reversedSequence = reverseFactory(this, true);\n    if (!this._useKeys) {\n      reversedSequence.valueSeq = function () { return this$1$1._iter.toSeq().reverse(); };\n    }\n    return reversedSequence;\n  };\n\n  ToKeyedSequence.prototype.map = function map (mapper, context) {\n    var this$1$1 = this;\n\n    var mappedSequence = mapFactory(this, mapper, context);\n    if (!this._useKeys) {\n      mappedSequence.valueSeq = function () { return this$1$1._iter.toSeq().map(mapper, context); };\n    }\n    return mappedSequence;\n  };\n\n  ToKeyedSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    return this._iter.__iterate(function (v, k) { return fn(v, k, this$1$1); }, reverse);\n  };\n\n  ToKeyedSequence.prototype.__iterator = function __iterator (type, reverse) {\n    return this._iter.__iterator(type, reverse);\n  };\n\n  return ToKeyedSequence;\n}(KeyedSeq));\nToKeyedSequence.prototype[IS_ORDERED_SYMBOL] = true;\n\nvar ToIndexedSequence = /*@__PURE__*/(function (IndexedSeq) {\n  function ToIndexedSequence(iter) {\n    this._iter = iter;\n    this.size = iter.size;\n  }\n\n  if ( IndexedSeq ) ToIndexedSequence.__proto__ = IndexedSeq;\n  ToIndexedSequence.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  ToIndexedSequence.prototype.constructor = ToIndexedSequence;\n\n  ToIndexedSequence.prototype.includes = function includes (value) {\n    return this._iter.includes(value);\n  };\n\n  ToIndexedSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    var i = 0;\n    reverse && ensureSize(this);\n    return this._iter.__iterate(\n      function (v) { return fn(v, reverse ? this$1$1.size - ++i : i++, this$1$1); },\n      reverse\n    );\n  };\n\n  ToIndexedSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var this$1$1 = this;\n\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    var i = 0;\n    reverse && ensureSize(this);\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done\n        ? step\n        : iteratorValue(\n            type,\n            reverse ? this$1$1.size - ++i : i++,\n            step.value,\n            step\n          );\n    });\n  };\n\n  return ToIndexedSequence;\n}(IndexedSeq));\n\nvar ToSetSequence = /*@__PURE__*/(function (SetSeq) {\n  function ToSetSequence(iter) {\n    this._iter = iter;\n    this.size = iter.size;\n  }\n\n  if ( SetSeq ) ToSetSequence.__proto__ = SetSeq;\n  ToSetSequence.prototype = Object.create( SetSeq && SetSeq.prototype );\n  ToSetSequence.prototype.constructor = ToSetSequence;\n\n  ToSetSequence.prototype.has = function has (key) {\n    return this._iter.includes(key);\n  };\n\n  ToSetSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    return this._iter.__iterate(function (v) { return fn(v, v, this$1$1); }, reverse);\n  };\n\n  ToSetSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      return step.done\n        ? step\n        : iteratorValue(type, step.value, step.value, step);\n    });\n  };\n\n  return ToSetSequence;\n}(SetSeq));\n\nvar FromEntriesSequence = /*@__PURE__*/(function (KeyedSeq) {\n  function FromEntriesSequence(entries) {\n    this._iter = entries;\n    this.size = entries.size;\n  }\n\n  if ( KeyedSeq ) FromEntriesSequence.__proto__ = KeyedSeq;\n  FromEntriesSequence.prototype = Object.create( KeyedSeq && KeyedSeq.prototype );\n  FromEntriesSequence.prototype.constructor = FromEntriesSequence;\n\n  FromEntriesSequence.prototype.entrySeq = function entrySeq () {\n    return this._iter.toSeq();\n  };\n\n  FromEntriesSequence.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    return this._iter.__iterate(function (entry) {\n      // Check if entry exists first so array access doesn't throw for holes\n      // in the parent iteration.\n      if (entry) {\n        validateEntry(entry);\n        var indexedCollection = isCollection(entry);\n        return fn(\n          indexedCollection ? entry.get(1) : entry[1],\n          indexedCollection ? entry.get(0) : entry[0],\n          this$1$1\n        );\n      }\n    }, reverse);\n  };\n\n  FromEntriesSequence.prototype.__iterator = function __iterator (type, reverse) {\n    var iterator = this._iter.__iterator(ITERATE_VALUES, reverse);\n    return new Iterator(function () {\n      while (true) {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        // Check if entry exists first so array access doesn't throw for holes\n        // in the parent iteration.\n        if (entry) {\n          validateEntry(entry);\n          var indexedCollection = isCollection(entry);\n          return iteratorValue(\n            type,\n            indexedCollection ? entry.get(0) : entry[0],\n            indexedCollection ? entry.get(1) : entry[1],\n            step\n          );\n        }\n      }\n    });\n  };\n\n  return FromEntriesSequence;\n}(KeyedSeq));\n\nToIndexedSequence.prototype.cacheResult =\n  ToKeyedSequence.prototype.cacheResult =\n  ToSetSequence.prototype.cacheResult =\n  FromEntriesSequence.prototype.cacheResult =\n    cacheResultThrough;\n\nfunction flipFactory(collection) {\n  var flipSequence = makeSequence(collection);\n  flipSequence._iter = collection;\n  flipSequence.size = collection.size;\n  flipSequence.flip = function () { return collection; };\n  flipSequence.reverse = function () {\n    var reversedSequence = collection.reverse.apply(this); // super.reverse()\n    reversedSequence.flip = function () { return collection.reverse(); };\n    return reversedSequence;\n  };\n  flipSequence.has = function (key) { return collection.includes(key); };\n  flipSequence.includes = function (key) { return collection.has(key); };\n  flipSequence.cacheResult = cacheResultThrough;\n  flipSequence.__iterateUncached = function (fn, reverse) {\n    var this$1$1 = this;\n\n    return collection.__iterate(function (v, k) { return fn(k, v, this$1$1) !== false; }, reverse);\n  };\n  flipSequence.__iteratorUncached = function (type, reverse) {\n    if (type === ITERATE_ENTRIES) {\n      var iterator = collection.__iterator(type, reverse);\n      return new Iterator(function () {\n        var step = iterator.next();\n        if (!step.done) {\n          var k = step.value[0];\n          step.value[0] = step.value[1];\n          step.value[1] = k;\n        }\n        return step;\n      });\n    }\n    return collection.__iterator(\n      type === ITERATE_VALUES ? ITERATE_KEYS : ITERATE_VALUES,\n      reverse\n    );\n  };\n  return flipSequence;\n}\n\nfunction mapFactory(collection, mapper, context) {\n  var mappedSequence = makeSequence(collection);\n  mappedSequence.size = collection.size;\n  mappedSequence.has = function (key) { return collection.has(key); };\n  mappedSequence.get = function (key, notSetValue) {\n    var v = collection.get(key, NOT_SET);\n    return v === NOT_SET\n      ? notSetValue\n      : mapper.call(context, v, key, collection);\n  };\n  mappedSequence.__iterateUncached = function (fn, reverse) {\n    var this$1$1 = this;\n\n    return collection.__iterate(\n      function (v, k, c) { return fn(mapper.call(context, v, k, c), k, this$1$1) !== false; },\n      reverse\n    );\n  };\n  mappedSequence.__iteratorUncached = function (type, reverse) {\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      var key = entry[0];\n      return iteratorValue(\n        type,\n        key,\n        mapper.call(context, entry[1], key, collection),\n        step\n      );\n    });\n  };\n  return mappedSequence;\n}\n\nfunction reverseFactory(collection, useKeys) {\n  var this$1$1 = this;\n\n  var reversedSequence = makeSequence(collection);\n  reversedSequence._iter = collection;\n  reversedSequence.size = collection.size;\n  reversedSequence.reverse = function () { return collection; };\n  if (collection.flip) {\n    reversedSequence.flip = function () {\n      var flipSequence = flipFactory(collection);\n      flipSequence.reverse = function () { return collection.flip(); };\n      return flipSequence;\n    };\n  }\n  reversedSequence.get = function (key, notSetValue) { return collection.get(useKeys ? key : -1 - key, notSetValue); };\n  reversedSequence.has = function (key) { return collection.has(useKeys ? key : -1 - key); };\n  reversedSequence.includes = function (value) { return collection.includes(value); };\n  reversedSequence.cacheResult = cacheResultThrough;\n  reversedSequence.__iterate = function (fn, reverse) {\n    var this$1$1 = this;\n\n    var i = 0;\n    reverse && ensureSize(collection);\n    return collection.__iterate(\n      function (v, k) { return fn(v, useKeys ? k : reverse ? this$1$1.size - ++i : i++, this$1$1); },\n      !reverse\n    );\n  };\n  reversedSequence.__iterator = function (type, reverse) {\n    var i = 0;\n    reverse && ensureSize(collection);\n    var iterator = collection.__iterator(ITERATE_ENTRIES, !reverse);\n    return new Iterator(function () {\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      return iteratorValue(\n        type,\n        useKeys ? entry[0] : reverse ? this$1$1.size - ++i : i++,\n        entry[1],\n        step\n      );\n    });\n  };\n  return reversedSequence;\n}\n\nfunction filterFactory(collection, predicate, context, useKeys) {\n  var filterSequence = makeSequence(collection);\n  if (useKeys) {\n    filterSequence.has = function (key) {\n      var v = collection.get(key, NOT_SET);\n      return v !== NOT_SET && !!predicate.call(context, v, key, collection);\n    };\n    filterSequence.get = function (key, notSetValue) {\n      var v = collection.get(key, NOT_SET);\n      return v !== NOT_SET && predicate.call(context, v, key, collection)\n        ? v\n        : notSetValue;\n    };\n  }\n  filterSequence.__iterateUncached = function (fn, reverse) {\n    var this$1$1 = this;\n\n    var iterations = 0;\n    collection.__iterate(function (v, k, c) {\n      if (predicate.call(context, v, k, c)) {\n        iterations++;\n        return fn(v, useKeys ? k : iterations - 1, this$1$1);\n      }\n    }, reverse);\n    return iterations;\n  };\n  filterSequence.__iteratorUncached = function (type, reverse) {\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var iterations = 0;\n    return new Iterator(function () {\n      while (true) {\n        var step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n        var entry = step.value;\n        var key = entry[0];\n        var value = entry[1];\n        if (predicate.call(context, value, key, collection)) {\n          return iteratorValue(type, useKeys ? key : iterations++, value, step);\n        }\n      }\n    });\n  };\n  return filterSequence;\n}\n\nfunction countByFactory(collection, grouper, context) {\n  var groups = Map().asMutable();\n  collection.__iterate(function (v, k) {\n    groups.update(grouper.call(context, v, k, collection), 0, function (a) { return a + 1; });\n  });\n  return groups.asImmutable();\n}\n\nfunction groupByFactory(collection, grouper, context) {\n  var isKeyedIter = isKeyed(collection);\n  var groups = (isOrdered(collection) ? OrderedMap() : Map()).asMutable();\n  collection.__iterate(function (v, k) {\n    groups.update(\n      grouper.call(context, v, k, collection),\n      function (a) { return ((a = a || []), a.push(isKeyedIter ? [k, v] : v), a); }\n    );\n  });\n  var coerce = collectionClass(collection);\n  return groups.map(function (arr) { return reify(collection, coerce(arr)); }).asImmutable();\n}\n\nfunction partitionFactory(collection, predicate, context) {\n  var isKeyedIter = isKeyed(collection);\n  var groups = [[], []];\n  collection.__iterate(function (v, k) {\n    groups[predicate.call(context, v, k, collection) ? 1 : 0].push(\n      isKeyedIter ? [k, v] : v\n    );\n  });\n  var coerce = collectionClass(collection);\n  return groups.map(function (arr) { return reify(collection, coerce(arr)); });\n}\n\nfunction sliceFactory(collection, begin, end, useKeys) {\n  var originalSize = collection.size;\n\n  if (wholeSlice(begin, end, originalSize)) {\n    return collection;\n  }\n\n  var resolvedBegin = resolveBegin(begin, originalSize);\n  var resolvedEnd = resolveEnd(end, originalSize);\n\n  // begin or end will be NaN if they were provided as negative numbers and\n  // this collection's size is unknown. In that case, cache first so there is\n  // a known size and these do not resolve to NaN.\n  if (resolvedBegin !== resolvedBegin || resolvedEnd !== resolvedEnd) {\n    return sliceFactory(collection.toSeq().cacheResult(), begin, end, useKeys);\n  }\n\n  // Note: resolvedEnd is undefined when the original sequence's length is\n  // unknown and this slice did not supply an end and should contain all\n  // elements after resolvedBegin.\n  // In that case, resolvedSize will be NaN and sliceSize will remain undefined.\n  var resolvedSize = resolvedEnd - resolvedBegin;\n  var sliceSize;\n  if (resolvedSize === resolvedSize) {\n    sliceSize = resolvedSize < 0 ? 0 : resolvedSize;\n  }\n\n  var sliceSeq = makeSequence(collection);\n\n  // If collection.size is undefined, the size of the realized sliceSeq is\n  // unknown at this point unless the number of items to slice is 0\n  sliceSeq.size =\n    sliceSize === 0 ? sliceSize : (collection.size && sliceSize) || undefined;\n\n  if (!useKeys && isSeq(collection) && sliceSize >= 0) {\n    sliceSeq.get = function (index, notSetValue) {\n      index = wrapIndex(this, index);\n      return index >= 0 && index < sliceSize\n        ? collection.get(index + resolvedBegin, notSetValue)\n        : notSetValue;\n    };\n  }\n\n  sliceSeq.__iterateUncached = function (fn, reverse) {\n    var this$1$1 = this;\n\n    if (sliceSize === 0) {\n      return 0;\n    }\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var skipped = 0;\n    var isSkipping = true;\n    var iterations = 0;\n    collection.__iterate(function (v, k) {\n      if (!(isSkipping && (isSkipping = skipped++ < resolvedBegin))) {\n        iterations++;\n        return (\n          fn(v, useKeys ? k : iterations - 1, this$1$1) !== false &&\n          iterations !== sliceSize\n        );\n      }\n    });\n    return iterations;\n  };\n\n  sliceSeq.__iteratorUncached = function (type, reverse) {\n    if (sliceSize !== 0 && reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    // Don't bother instantiating parent iterator if taking 0.\n    if (sliceSize === 0) {\n      return new Iterator(iteratorDone);\n    }\n    var iterator = collection.__iterator(type, reverse);\n    var skipped = 0;\n    var iterations = 0;\n    return new Iterator(function () {\n      while (skipped++ < resolvedBegin) {\n        iterator.next();\n      }\n      if (++iterations > sliceSize) {\n        return iteratorDone();\n      }\n      var step = iterator.next();\n      if (useKeys || type === ITERATE_VALUES || step.done) {\n        return step;\n      }\n      if (type === ITERATE_KEYS) {\n        return iteratorValue(type, iterations - 1, undefined, step);\n      }\n      return iteratorValue(type, iterations - 1, step.value[1], step);\n    });\n  };\n\n  return sliceSeq;\n}\n\nfunction takeWhileFactory(collection, predicate, context) {\n  var takeSequence = makeSequence(collection);\n  takeSequence.__iterateUncached = function (fn, reverse) {\n    var this$1$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var iterations = 0;\n    collection.__iterate(\n      function (v, k, c) { return predicate.call(context, v, k, c) && ++iterations && fn(v, k, this$1$1); }\n    );\n    return iterations;\n  };\n  takeSequence.__iteratorUncached = function (type, reverse) {\n    var this$1$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var iterating = true;\n    return new Iterator(function () {\n      if (!iterating) {\n        return iteratorDone();\n      }\n      var step = iterator.next();\n      if (step.done) {\n        return step;\n      }\n      var entry = step.value;\n      var k = entry[0];\n      var v = entry[1];\n      if (!predicate.call(context, v, k, this$1$1)) {\n        iterating = false;\n        return iteratorDone();\n      }\n      return type === ITERATE_ENTRIES ? step : iteratorValue(type, k, v, step);\n    });\n  };\n  return takeSequence;\n}\n\nfunction skipWhileFactory(collection, predicate, context, useKeys) {\n  var skipSequence = makeSequence(collection);\n  skipSequence.__iterateUncached = function (fn, reverse) {\n    var this$1$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var isSkipping = true;\n    var iterations = 0;\n    collection.__iterate(function (v, k, c) {\n      if (!(isSkipping && (isSkipping = predicate.call(context, v, k, c)))) {\n        iterations++;\n        return fn(v, useKeys ? k : iterations - 1, this$1$1);\n      }\n    });\n    return iterations;\n  };\n  skipSequence.__iteratorUncached = function (type, reverse) {\n    var this$1$1 = this;\n\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(ITERATE_ENTRIES, reverse);\n    var skipping = true;\n    var iterations = 0;\n    return new Iterator(function () {\n      var step;\n      var k;\n      var v;\n      do {\n        step = iterator.next();\n        if (step.done) {\n          if (useKeys || type === ITERATE_VALUES) {\n            return step;\n          }\n          if (type === ITERATE_KEYS) {\n            return iteratorValue(type, iterations++, undefined, step);\n          }\n          return iteratorValue(type, iterations++, step.value[1], step);\n        }\n        var entry = step.value;\n        k = entry[0];\n        v = entry[1];\n        skipping && (skipping = predicate.call(context, v, k, this$1$1));\n      } while (skipping);\n      return type === ITERATE_ENTRIES ? step : iteratorValue(type, k, v, step);\n    });\n  };\n  return skipSequence;\n}\n\nfunction concatFactory(collection, values) {\n  var isKeyedCollection = isKeyed(collection);\n  var iters = [collection]\n    .concat(values)\n    .map(function (v) {\n      if (!isCollection(v)) {\n        v = isKeyedCollection\n          ? keyedSeqFromValue(v)\n          : indexedSeqFromValue(Array.isArray(v) ? v : [v]);\n      } else if (isKeyedCollection) {\n        v = KeyedCollection(v);\n      }\n      return v;\n    })\n    .filter(function (v) { return v.size !== 0; });\n\n  if (iters.length === 0) {\n    return collection;\n  }\n\n  if (iters.length === 1) {\n    var singleton = iters[0];\n    if (\n      singleton === collection ||\n      (isKeyedCollection && isKeyed(singleton)) ||\n      (isIndexed(collection) && isIndexed(singleton))\n    ) {\n      return singleton;\n    }\n  }\n\n  var concatSeq = new ArraySeq(iters);\n  if (isKeyedCollection) {\n    concatSeq = concatSeq.toKeyedSeq();\n  } else if (!isIndexed(collection)) {\n    concatSeq = concatSeq.toSetSeq();\n  }\n  concatSeq = concatSeq.flatten(true);\n  concatSeq.size = iters.reduce(function (sum, seq) {\n    if (sum !== undefined) {\n      var size = seq.size;\n      if (size !== undefined) {\n        return sum + size;\n      }\n    }\n  }, 0);\n  return concatSeq;\n}\n\nfunction flattenFactory(collection, depth, useKeys) {\n  var flatSequence = makeSequence(collection);\n  flatSequence.__iterateUncached = function (fn, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterate(fn, reverse);\n    }\n    var iterations = 0;\n    var stopped = false;\n    function flatDeep(iter, currentDepth) {\n      iter.__iterate(function (v, k) {\n        if ((!depth || currentDepth < depth) && isCollection(v)) {\n          flatDeep(v, currentDepth + 1);\n        } else {\n          iterations++;\n          if (fn(v, useKeys ? k : iterations - 1, flatSequence) === false) {\n            stopped = true;\n          }\n        }\n        return !stopped;\n      }, reverse);\n    }\n    flatDeep(collection, 0);\n    return iterations;\n  };\n  flatSequence.__iteratorUncached = function (type, reverse) {\n    if (reverse) {\n      return this.cacheResult().__iterator(type, reverse);\n    }\n    var iterator = collection.__iterator(type, reverse);\n    var stack = [];\n    var iterations = 0;\n    return new Iterator(function () {\n      while (iterator) {\n        var step = iterator.next();\n        if (step.done !== false) {\n          iterator = stack.pop();\n          continue;\n        }\n        var v = step.value;\n        if (type === ITERATE_ENTRIES) {\n          v = v[1];\n        }\n        if ((!depth || stack.length < depth) && isCollection(v)) {\n          stack.push(iterator);\n          iterator = v.__iterator(type, reverse);\n        } else {\n          return useKeys ? step : iteratorValue(type, iterations++, v, step);\n        }\n      }\n      return iteratorDone();\n    });\n  };\n  return flatSequence;\n}\n\nfunction flatMapFactory(collection, mapper, context) {\n  var coerce = collectionClass(collection);\n  return collection\n    .toSeq()\n    .map(function (v, k) { return coerce(mapper.call(context, v, k, collection)); })\n    .flatten(true);\n}\n\nfunction interposeFactory(collection, separator) {\n  var interposedSequence = makeSequence(collection);\n  interposedSequence.size = collection.size && collection.size * 2 - 1;\n  interposedSequence.__iterateUncached = function (fn, reverse) {\n    var this$1$1 = this;\n\n    var iterations = 0;\n    collection.__iterate(\n      function (v) { return (!iterations || fn(separator, iterations++, this$1$1) !== false) &&\n        fn(v, iterations++, this$1$1) !== false; },\n      reverse\n    );\n    return iterations;\n  };\n  interposedSequence.__iteratorUncached = function (type, reverse) {\n    var iterator = collection.__iterator(ITERATE_VALUES, reverse);\n    var iterations = 0;\n    var step;\n    return new Iterator(function () {\n      if (!step || iterations % 2) {\n        step = iterator.next();\n        if (step.done) {\n          return step;\n        }\n      }\n      return iterations % 2\n        ? iteratorValue(type, iterations++, separator)\n        : iteratorValue(type, iterations++, step.value, step);\n    });\n  };\n  return interposedSequence;\n}\n\nfunction sortFactory(collection, comparator, mapper) {\n  if (!comparator) {\n    comparator = defaultComparator;\n  }\n  var isKeyedCollection = isKeyed(collection);\n  var index = 0;\n  var entries = collection\n    .toSeq()\n    .map(function (v, k) { return [k, v, index++, mapper ? mapper(v, k, collection) : v]; })\n    .valueSeq()\n    .toArray();\n  entries\n    .sort(function (a, b) { return comparator(a[3], b[3]) || a[2] - b[2]; })\n    .forEach(\n      isKeyedCollection\n        ? function (v, i) {\n            entries[i].length = 2;\n          }\n        : function (v, i) {\n            entries[i] = v[1];\n          }\n    );\n  return isKeyedCollection\n    ? KeyedSeq(entries)\n    : isIndexed(collection)\n    ? IndexedSeq(entries)\n    : SetSeq(entries);\n}\n\nfunction maxFactory(collection, comparator, mapper) {\n  if (!comparator) {\n    comparator = defaultComparator;\n  }\n  if (mapper) {\n    var entry = collection\n      .toSeq()\n      .map(function (v, k) { return [v, mapper(v, k, collection)]; })\n      .reduce(function (a, b) { return (maxCompare(comparator, a[1], b[1]) ? b : a); });\n    return entry && entry[0];\n  }\n  return collection.reduce(function (a, b) { return (maxCompare(comparator, a, b) ? b : a); });\n}\n\nfunction maxCompare(comparator, a, b) {\n  var comp = comparator(b, a);\n  // b is considered the new max if the comparator declares them equal, but\n  // they are not equal and b is in fact a nullish value.\n  return (\n    (comp === 0 && b !== a && (b === undefined || b === null || b !== b)) ||\n    comp > 0\n  );\n}\n\nfunction zipWithFactory(keyIter, zipper, iters, zipAll) {\n  var zipSequence = makeSequence(keyIter);\n  var sizes = new ArraySeq(iters).map(function (i) { return i.size; });\n  zipSequence.size = zipAll ? sizes.max() : sizes.min();\n  // Note: this a generic base implementation of __iterate in terms of\n  // __iterator which may be more generically useful in the future.\n  zipSequence.__iterate = function (fn, reverse) {\n    /* generic:\n    var iterator = this.__iterator(ITERATE_ENTRIES, reverse);\n    var step;\n    var iterations = 0;\n    while (!(step = iterator.next()).done) {\n      iterations++;\n      if (fn(step.value[1], step.value[0], this) === false) {\n        break;\n      }\n    }\n    return iterations;\n    */\n    // indexed:\n    var iterator = this.__iterator(ITERATE_VALUES, reverse);\n    var step;\n    var iterations = 0;\n    while (!(step = iterator.next()).done) {\n      if (fn(step.value, iterations++, this) === false) {\n        break;\n      }\n    }\n    return iterations;\n  };\n  zipSequence.__iteratorUncached = function (type, reverse) {\n    var iterators = iters.map(\n      function (i) { return ((i = Collection(i)), getIterator(reverse ? i.reverse() : i)); }\n    );\n    var iterations = 0;\n    var isDone = false;\n    return new Iterator(function () {\n      var steps;\n      if (!isDone) {\n        steps = iterators.map(function (i) { return i.next(); });\n        isDone = zipAll ? steps.every(function (s) { return s.done; }) : steps.some(function (s) { return s.done; });\n      }\n      if (isDone) {\n        return iteratorDone();\n      }\n      return iteratorValue(\n        type,\n        iterations++,\n        zipper.apply(\n          null,\n          steps.map(function (s) { return s.value; })\n        )\n      );\n    });\n  };\n  return zipSequence;\n}\n\n// #pragma Helper Functions\n\nfunction reify(iter, seq) {\n  return iter === seq ? iter : isSeq(iter) ? seq : iter.constructor(seq);\n}\n\nfunction validateEntry(entry) {\n  if (entry !== Object(entry)) {\n    throw new TypeError('Expected [K, V] tuple: ' + entry);\n  }\n}\n\nfunction collectionClass(collection) {\n  return isKeyed(collection)\n    ? KeyedCollection\n    : isIndexed(collection)\n    ? IndexedCollection\n    : SetCollection;\n}\n\nfunction makeSequence(collection) {\n  return Object.create(\n    (isKeyed(collection)\n      ? KeyedSeq\n      : isIndexed(collection)\n      ? IndexedSeq\n      : SetSeq\n    ).prototype\n  );\n}\n\nfunction cacheResultThrough() {\n  if (this._iter.cacheResult) {\n    this._iter.cacheResult();\n    this.size = this._iter.size;\n    return this;\n  }\n  return Seq.prototype.cacheResult.call(this);\n}\n\nfunction defaultComparator(a, b) {\n  if (a === undefined && b === undefined) {\n    return 0;\n  }\n\n  if (a === undefined) {\n    return 1;\n  }\n\n  if (b === undefined) {\n    return -1;\n  }\n\n  return a > b ? 1 : a < b ? -1 : 0;\n}\n\nfunction arrCopy(arr, offset) {\n  offset = offset || 0;\n  var len = Math.max(0, arr.length - offset);\n  var newArr = new Array(len);\n  for (var ii = 0; ii < len; ii++) {\n    newArr[ii] = arr[ii + offset];\n  }\n  return newArr;\n}\n\nfunction invariant(condition, error) {\n  if (!condition) { throw new Error(error); }\n}\n\nfunction assertNotInfinite(size) {\n  invariant(\n    size !== Infinity,\n    'Cannot perform this action with an infinite size.'\n  );\n}\n\nfunction coerceKeyPath(keyPath) {\n  if (isArrayLike(keyPath) && typeof keyPath !== 'string') {\n    return keyPath;\n  }\n  if (isOrdered(keyPath)) {\n    return keyPath.toArray();\n  }\n  throw new TypeError(\n    'Invalid keyPath: expected Ordered Collection or Array: ' + keyPath\n  );\n}\n\nvar toString = Object.prototype.toString;\n\nfunction isPlainObject(value) {\n  // The base prototype's toString deals with Argument objects and native namespaces like Math\n  if (\n    !value ||\n    typeof value !== 'object' ||\n    toString.call(value) !== '[object Object]'\n  ) {\n    return false;\n  }\n\n  var proto = Object.getPrototypeOf(value);\n  if (proto === null) {\n    return true;\n  }\n\n  // Iteratively going up the prototype chain is needed for cross-realm environments (differing contexts, iframes, etc)\n  var parentProto = proto;\n  var nextProto = Object.getPrototypeOf(proto);\n  while (nextProto !== null) {\n    parentProto = nextProto;\n    nextProto = Object.getPrototypeOf(parentProto);\n  }\n  return parentProto === proto;\n}\n\n/**\n * Returns true if the value is a potentially-persistent data structure, either\n * provided by Immutable.js or a plain Array or Object.\n */\nfunction isDataStructure(value) {\n  return (\n    typeof value === 'object' &&\n    (isImmutable(value) || Array.isArray(value) || isPlainObject(value))\n  );\n}\n\nfunction quoteString(value) {\n  try {\n    return typeof value === 'string' ? JSON.stringify(value) : String(value);\n  } catch (_ignoreError) {\n    return JSON.stringify(value);\n  }\n}\n\nfunction has(collection, key) {\n  return isImmutable(collection)\n    ? collection.has(key)\n    : isDataStructure(collection) && hasOwnProperty.call(collection, key);\n}\n\nfunction get(collection, key, notSetValue) {\n  return isImmutable(collection)\n    ? collection.get(key, notSetValue)\n    : !has(collection, key)\n    ? notSetValue\n    : typeof collection.get === 'function'\n    ? collection.get(key)\n    : collection[key];\n}\n\nfunction shallowCopy(from) {\n  if (Array.isArray(from)) {\n    return arrCopy(from);\n  }\n  var to = {};\n  for (var key in from) {\n    if (hasOwnProperty.call(from, key)) {\n      to[key] = from[key];\n    }\n  }\n  return to;\n}\n\nfunction remove(collection, key) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot update non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    if (!collection.remove) {\n      throw new TypeError(\n        'Cannot update immutable value without .remove() method: ' + collection\n      );\n    }\n    return collection.remove(key);\n  }\n  if (!hasOwnProperty.call(collection, key)) {\n    return collection;\n  }\n  var collectionCopy = shallowCopy(collection);\n  if (Array.isArray(collectionCopy)) {\n    collectionCopy.splice(key, 1);\n  } else {\n    delete collectionCopy[key];\n  }\n  return collectionCopy;\n}\n\nfunction set(collection, key, value) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot update non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    if (!collection.set) {\n      throw new TypeError(\n        'Cannot update immutable value without .set() method: ' + collection\n      );\n    }\n    return collection.set(key, value);\n  }\n  if (hasOwnProperty.call(collection, key) && value === collection[key]) {\n    return collection;\n  }\n  var collectionCopy = shallowCopy(collection);\n  collectionCopy[key] = value;\n  return collectionCopy;\n}\n\nfunction updateIn$1(collection, keyPath, notSetValue, updater) {\n  if (!updater) {\n    updater = notSetValue;\n    notSetValue = undefined;\n  }\n  var updatedValue = updateInDeeply(\n    isImmutable(collection),\n    collection,\n    coerceKeyPath(keyPath),\n    0,\n    notSetValue,\n    updater\n  );\n  return updatedValue === NOT_SET ? notSetValue : updatedValue;\n}\n\nfunction updateInDeeply(\n  inImmutable,\n  existing,\n  keyPath,\n  i,\n  notSetValue,\n  updater\n) {\n  var wasNotSet = existing === NOT_SET;\n  if (i === keyPath.length) {\n    var existingValue = wasNotSet ? notSetValue : existing;\n    var newValue = updater(existingValue);\n    return newValue === existingValue ? existing : newValue;\n  }\n  if (!wasNotSet && !isDataStructure(existing)) {\n    throw new TypeError(\n      'Cannot update within non-data-structure value in path [' +\n        keyPath.slice(0, i).map(quoteString) +\n        ']: ' +\n        existing\n    );\n  }\n  var key = keyPath[i];\n  var nextExisting = wasNotSet ? NOT_SET : get(existing, key, NOT_SET);\n  var nextUpdated = updateInDeeply(\n    nextExisting === NOT_SET ? inImmutable : isImmutable(nextExisting),\n    nextExisting,\n    keyPath,\n    i + 1,\n    notSetValue,\n    updater\n  );\n  return nextUpdated === nextExisting\n    ? existing\n    : nextUpdated === NOT_SET\n    ? remove(existing, key)\n    : set(\n        wasNotSet ? (inImmutable ? emptyMap() : {}) : existing,\n        key,\n        nextUpdated\n      );\n}\n\nfunction setIn$1(collection, keyPath, value) {\n  return updateIn$1(collection, keyPath, NOT_SET, function () { return value; });\n}\n\nfunction setIn(keyPath, v) {\n  return setIn$1(this, keyPath, v);\n}\n\nfunction removeIn(collection, keyPath) {\n  return updateIn$1(collection, keyPath, function () { return NOT_SET; });\n}\n\nfunction deleteIn(keyPath) {\n  return removeIn(this, keyPath);\n}\n\nfunction update$1(collection, key, notSetValue, updater) {\n  return updateIn$1(collection, [key], notSetValue, updater);\n}\n\nfunction update(key, notSetValue, updater) {\n  return arguments.length === 1\n    ? key(this)\n    : update$1(this, key, notSetValue, updater);\n}\n\nfunction updateIn(keyPath, notSetValue, updater) {\n  return updateIn$1(this, keyPath, notSetValue, updater);\n}\n\nfunction merge$1() {\n  var iters = [], len = arguments.length;\n  while ( len-- ) iters[ len ] = arguments[ len ];\n\n  return mergeIntoKeyedWith(this, iters);\n}\n\nfunction mergeWith$1(merger) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  if (typeof merger !== 'function') {\n    throw new TypeError('Invalid merger function: ' + merger);\n  }\n  return mergeIntoKeyedWith(this, iters, merger);\n}\n\nfunction mergeIntoKeyedWith(collection, collections, merger) {\n  var iters = [];\n  for (var ii = 0; ii < collections.length; ii++) {\n    var collection$1 = KeyedCollection(collections[ii]);\n    if (collection$1.size !== 0) {\n      iters.push(collection$1);\n    }\n  }\n  if (iters.length === 0) {\n    return collection;\n  }\n  if (\n    collection.toSeq().size === 0 &&\n    !collection.__ownerID &&\n    iters.length === 1\n  ) {\n    return collection.constructor(iters[0]);\n  }\n  return collection.withMutations(function (collection) {\n    var mergeIntoCollection = merger\n      ? function (value, key) {\n          update$1(collection, key, NOT_SET, function (oldVal) { return oldVal === NOT_SET ? value : merger(oldVal, value, key); }\n          );\n        }\n      : function (value, key) {\n          collection.set(key, value);\n        };\n    for (var ii = 0; ii < iters.length; ii++) {\n      iters[ii].forEach(mergeIntoCollection);\n    }\n  });\n}\n\nfunction merge(collection) {\n  var sources = [], len = arguments.length - 1;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n  return mergeWithSources(collection, sources);\n}\n\nfunction mergeWith(merger, collection) {\n  var sources = [], len = arguments.length - 2;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 2 ];\n\n  return mergeWithSources(collection, sources, merger);\n}\n\nfunction mergeDeep$1(collection) {\n  var sources = [], len = arguments.length - 1;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 1 ];\n\n  return mergeDeepWithSources(collection, sources);\n}\n\nfunction mergeDeepWith$1(merger, collection) {\n  var sources = [], len = arguments.length - 2;\n  while ( len-- > 0 ) sources[ len ] = arguments[ len + 2 ];\n\n  return mergeDeepWithSources(collection, sources, merger);\n}\n\nfunction mergeDeepWithSources(collection, sources, merger) {\n  return mergeWithSources(collection, sources, deepMergerWith(merger));\n}\n\nfunction mergeWithSources(collection, sources, merger) {\n  if (!isDataStructure(collection)) {\n    throw new TypeError(\n      'Cannot merge into non-data-structure value: ' + collection\n    );\n  }\n  if (isImmutable(collection)) {\n    return typeof merger === 'function' && collection.mergeWith\n      ? collection.mergeWith.apply(collection, [ merger ].concat( sources ))\n      : collection.merge\n      ? collection.merge.apply(collection, sources)\n      : collection.concat.apply(collection, sources);\n  }\n  var isArray = Array.isArray(collection);\n  var merged = collection;\n  var Collection = isArray ? IndexedCollection : KeyedCollection;\n  var mergeItem = isArray\n    ? function (value) {\n        // Copy on write\n        if (merged === collection) {\n          merged = shallowCopy(merged);\n        }\n        merged.push(value);\n      }\n    : function (value, key) {\n        var hasVal = hasOwnProperty.call(merged, key);\n        var nextVal =\n          hasVal && merger ? merger(merged[key], value, key) : value;\n        if (!hasVal || nextVal !== merged[key]) {\n          // Copy on write\n          if (merged === collection) {\n            merged = shallowCopy(merged);\n          }\n          merged[key] = nextVal;\n        }\n      };\n  for (var i = 0; i < sources.length; i++) {\n    Collection(sources[i]).forEach(mergeItem);\n  }\n  return merged;\n}\n\nfunction deepMergerWith(merger) {\n  function deepMerger(oldValue, newValue, key) {\n    return isDataStructure(oldValue) &&\n      isDataStructure(newValue) &&\n      areMergeable(oldValue, newValue)\n      ? mergeWithSources(oldValue, [newValue], deepMerger)\n      : merger\n      ? merger(oldValue, newValue, key)\n      : newValue;\n  }\n  return deepMerger;\n}\n\n/**\n * It's unclear what the desired behavior is for merging two collections that\n * fall into separate categories between keyed, indexed, or set-like, so we only\n * consider them mergeable if they fall into the same category.\n */\nfunction areMergeable(oldDataStructure, newDataStructure) {\n  var oldSeq = Seq(oldDataStructure);\n  var newSeq = Seq(newDataStructure);\n  // This logic assumes that a sequence can only fall into one of the three\n  // categories mentioned above (since there's no `isSetLike()` method).\n  return (\n    isIndexed(oldSeq) === isIndexed(newSeq) &&\n    isKeyed(oldSeq) === isKeyed(newSeq)\n  );\n}\n\nfunction mergeDeep() {\n  var iters = [], len = arguments.length;\n  while ( len-- ) iters[ len ] = arguments[ len ];\n\n  return mergeDeepWithSources(this, iters);\n}\n\nfunction mergeDeepWith(merger) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return mergeDeepWithSources(this, iters, merger);\n}\n\nfunction mergeIn(keyPath) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return updateIn$1(this, keyPath, emptyMap(), function (m) { return mergeWithSources(m, iters); });\n}\n\nfunction mergeDeepIn(keyPath) {\n  var iters = [], len = arguments.length - 1;\n  while ( len-- > 0 ) iters[ len ] = arguments[ len + 1 ];\n\n  return updateIn$1(this, keyPath, emptyMap(), function (m) { return mergeDeepWithSources(m, iters); }\n  );\n}\n\nfunction withMutations(fn) {\n  var mutable = this.asMutable();\n  fn(mutable);\n  return mutable.wasAltered() ? mutable.__ensureOwner(this.__ownerID) : this;\n}\n\nfunction asMutable() {\n  return this.__ownerID ? this : this.__ensureOwner(new OwnerID());\n}\n\nfunction asImmutable() {\n  return this.__ensureOwner();\n}\n\nfunction wasAltered() {\n  return this.__altered;\n}\n\nvar Map = /*@__PURE__*/(function (KeyedCollection) {\n  function Map(value) {\n    return value === undefined || value === null\n      ? emptyMap()\n      : isMap(value) && !isOrdered(value)\n      ? value\n      : emptyMap().withMutations(function (map) {\n          var iter = KeyedCollection(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function (v, k) { return map.set(k, v); });\n        });\n  }\n\n  if ( KeyedCollection ) Map.__proto__ = KeyedCollection;\n  Map.prototype = Object.create( KeyedCollection && KeyedCollection.prototype );\n  Map.prototype.constructor = Map;\n\n  Map.of = function of () {\n    var keyValues = [], len = arguments.length;\n    while ( len-- ) keyValues[ len ] = arguments[ len ];\n\n    return emptyMap().withMutations(function (map) {\n      for (var i = 0; i < keyValues.length; i += 2) {\n        if (i + 1 >= keyValues.length) {\n          throw new Error('Missing value for key: ' + keyValues[i]);\n        }\n        map.set(keyValues[i], keyValues[i + 1]);\n      }\n    });\n  };\n\n  Map.prototype.toString = function toString () {\n    return this.__toString('Map {', '}');\n  };\n\n  // @pragma Access\n\n  Map.prototype.get = function get (k, notSetValue) {\n    return this._root\n      ? this._root.get(0, undefined, k, notSetValue)\n      : notSetValue;\n  };\n\n  // @pragma Modification\n\n  Map.prototype.set = function set (k, v) {\n    return updateMap(this, k, v);\n  };\n\n  Map.prototype.remove = function remove (k) {\n    return updateMap(this, k, NOT_SET);\n  };\n\n  Map.prototype.deleteAll = function deleteAll (keys) {\n    var collection = Collection(keys);\n\n    if (collection.size === 0) {\n      return this;\n    }\n\n    return this.withMutations(function (map) {\n      collection.forEach(function (key) { return map.remove(key); });\n    });\n  };\n\n  Map.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._root = null;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyMap();\n  };\n\n  // @pragma Composition\n\n  Map.prototype.sort = function sort (comparator) {\n    // Late binding\n    return OrderedMap(sortFactory(this, comparator));\n  };\n\n  Map.prototype.sortBy = function sortBy (mapper, comparator) {\n    // Late binding\n    return OrderedMap(sortFactory(this, comparator, mapper));\n  };\n\n  Map.prototype.map = function map (mapper, context) {\n    var this$1$1 = this;\n\n    return this.withMutations(function (map) {\n      map.forEach(function (value, key) {\n        map.set(key, mapper.call(context, value, key, this$1$1));\n      });\n    });\n  };\n\n  // @pragma Mutability\n\n  Map.prototype.__iterator = function __iterator (type, reverse) {\n    return new MapIterator(this, type, reverse);\n  };\n\n  Map.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    var iterations = 0;\n    this._root &&\n      this._root.iterate(function (entry) {\n        iterations++;\n        return fn(entry[1], entry[0], this$1$1);\n      }, reverse);\n    return iterations;\n  };\n\n  Map.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyMap();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeMap(this.size, this._root, ownerID, this.__hash);\n  };\n\n  return Map;\n}(KeyedCollection));\n\nMap.isMap = isMap;\n\nvar MapPrototype = Map.prototype;\nMapPrototype[IS_MAP_SYMBOL] = true;\nMapPrototype[DELETE] = MapPrototype.remove;\nMapPrototype.removeAll = MapPrototype.deleteAll;\nMapPrototype.setIn = setIn;\nMapPrototype.removeIn = MapPrototype.deleteIn = deleteIn;\nMapPrototype.update = update;\nMapPrototype.updateIn = updateIn;\nMapPrototype.merge = MapPrototype.concat = merge$1;\nMapPrototype.mergeWith = mergeWith$1;\nMapPrototype.mergeDeep = mergeDeep;\nMapPrototype.mergeDeepWith = mergeDeepWith;\nMapPrototype.mergeIn = mergeIn;\nMapPrototype.mergeDeepIn = mergeDeepIn;\nMapPrototype.withMutations = withMutations;\nMapPrototype.wasAltered = wasAltered;\nMapPrototype.asImmutable = asImmutable;\nMapPrototype['@@transducer/init'] = MapPrototype.asMutable = asMutable;\nMapPrototype['@@transducer/step'] = function (result, arr) {\n  return result.set(arr[0], arr[1]);\n};\nMapPrototype['@@transducer/result'] = function (obj) {\n  return obj.asImmutable();\n};\n\n// #pragma Trie Nodes\n\nvar ArrayMapNode = function ArrayMapNode(ownerID, entries) {\n  this.ownerID = ownerID;\n  this.entries = entries;\n};\n\nArrayMapNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  var entries = this.entries;\n  for (var ii = 0, len = entries.length; ii < len; ii++) {\n    if (is(key, entries[ii][0])) {\n      return entries[ii][1];\n    }\n  }\n  return notSetValue;\n};\n\nArrayMapNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  var removed = value === NOT_SET;\n\n  var entries = this.entries;\n  var idx = 0;\n  var len = entries.length;\n  for (; idx < len; idx++) {\n    if (is(key, entries[idx][0])) {\n      break;\n    }\n  }\n  var exists = idx < len;\n\n  if (exists ? entries[idx][1] === value : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n  (removed || !exists) && SetRef(didChangeSize);\n\n  if (removed && entries.length === 1) {\n    return; // undefined\n  }\n\n  if (!exists && !removed && entries.length >= MAX_ARRAY_MAP_SIZE) {\n    return createNodes(ownerID, entries, key, value);\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newEntries = isEditable ? entries : arrCopy(entries);\n\n  if (exists) {\n    if (removed) {\n      idx === len - 1\n        ? newEntries.pop()\n        : (newEntries[idx] = newEntries.pop());\n    } else {\n      newEntries[idx] = [key, value];\n    }\n  } else {\n    newEntries.push([key, value]);\n  }\n\n  if (isEditable) {\n    this.entries = newEntries;\n    return this;\n  }\n\n  return new ArrayMapNode(ownerID, newEntries);\n};\n\nvar BitmapIndexedNode = function BitmapIndexedNode(ownerID, bitmap, nodes) {\n  this.ownerID = ownerID;\n  this.bitmap = bitmap;\n  this.nodes = nodes;\n};\n\nBitmapIndexedNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var bit = 1 << ((shift === 0 ? keyHash : keyHash >>> shift) & MASK);\n  var bitmap = this.bitmap;\n  return (bitmap & bit) === 0\n    ? notSetValue\n    : this.nodes[popCount(bitmap & (bit - 1))].get(\n        shift + SHIFT,\n        keyHash,\n        key,\n        notSetValue\n      );\n};\n\nBitmapIndexedNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var keyHashFrag = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var bit = 1 << keyHashFrag;\n  var bitmap = this.bitmap;\n  var exists = (bitmap & bit) !== 0;\n\n  if (!exists && value === NOT_SET) {\n    return this;\n  }\n\n  var idx = popCount(bitmap & (bit - 1));\n  var nodes = this.nodes;\n  var node = exists ? nodes[idx] : undefined;\n  var newNode = updateNode(\n    node,\n    ownerID,\n    shift + SHIFT,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n\n  if (newNode === node) {\n    return this;\n  }\n\n  if (!exists && newNode && nodes.length >= MAX_BITMAP_INDEXED_SIZE) {\n    return expandNodes(ownerID, nodes, bitmap, keyHashFrag, newNode);\n  }\n\n  if (\n    exists &&\n    !newNode &&\n    nodes.length === 2 &&\n    isLeafNode(nodes[idx ^ 1])\n  ) {\n    return nodes[idx ^ 1];\n  }\n\n  if (exists && newNode && nodes.length === 1 && isLeafNode(newNode)) {\n    return newNode;\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newBitmap = exists ? (newNode ? bitmap : bitmap ^ bit) : bitmap | bit;\n  var newNodes = exists\n    ? newNode\n      ? setAt(nodes, idx, newNode, isEditable)\n      : spliceOut(nodes, idx, isEditable)\n    : spliceIn(nodes, idx, newNode, isEditable);\n\n  if (isEditable) {\n    this.bitmap = newBitmap;\n    this.nodes = newNodes;\n    return this;\n  }\n\n  return new BitmapIndexedNode(ownerID, newBitmap, newNodes);\n};\n\nvar HashArrayMapNode = function HashArrayMapNode(ownerID, count, nodes) {\n  this.ownerID = ownerID;\n  this.count = count;\n  this.nodes = nodes;\n};\n\nHashArrayMapNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var node = this.nodes[idx];\n  return node\n    ? node.get(shift + SHIFT, keyHash, key, notSetValue)\n    : notSetValue;\n};\n\nHashArrayMapNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n  var idx = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n  var removed = value === NOT_SET;\n  var nodes = this.nodes;\n  var node = nodes[idx];\n\n  if (removed && !node) {\n    return this;\n  }\n\n  var newNode = updateNode(\n    node,\n    ownerID,\n    shift + SHIFT,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n  if (newNode === node) {\n    return this;\n  }\n\n  var newCount = this.count;\n  if (!node) {\n    newCount++;\n  } else if (!newNode) {\n    newCount--;\n    if (newCount < MIN_HASH_ARRAY_MAP_SIZE) {\n      return packNodes(ownerID, nodes, newCount, idx);\n    }\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newNodes = setAt(nodes, idx, newNode, isEditable);\n\n  if (isEditable) {\n    this.count = newCount;\n    this.nodes = newNodes;\n    return this;\n  }\n\n  return new HashArrayMapNode(ownerID, newCount, newNodes);\n};\n\nvar HashCollisionNode = function HashCollisionNode(ownerID, keyHash, entries) {\n  this.ownerID = ownerID;\n  this.keyHash = keyHash;\n  this.entries = entries;\n};\n\nHashCollisionNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  var entries = this.entries;\n  for (var ii = 0, len = entries.length; ii < len; ii++) {\n    if (is(key, entries[ii][0])) {\n      return entries[ii][1];\n    }\n  }\n  return notSetValue;\n};\n\nHashCollisionNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  if (keyHash === undefined) {\n    keyHash = hash(key);\n  }\n\n  var removed = value === NOT_SET;\n\n  if (keyHash !== this.keyHash) {\n    if (removed) {\n      return this;\n    }\n    SetRef(didAlter);\n    SetRef(didChangeSize);\n    return mergeIntoNode(this, ownerID, shift, keyHash, [key, value]);\n  }\n\n  var entries = this.entries;\n  var idx = 0;\n  var len = entries.length;\n  for (; idx < len; idx++) {\n    if (is(key, entries[idx][0])) {\n      break;\n    }\n  }\n  var exists = idx < len;\n\n  if (exists ? entries[idx][1] === value : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n  (removed || !exists) && SetRef(didChangeSize);\n\n  if (removed && len === 2) {\n    return new ValueNode(ownerID, this.keyHash, entries[idx ^ 1]);\n  }\n\n  var isEditable = ownerID && ownerID === this.ownerID;\n  var newEntries = isEditable ? entries : arrCopy(entries);\n\n  if (exists) {\n    if (removed) {\n      idx === len - 1\n        ? newEntries.pop()\n        : (newEntries[idx] = newEntries.pop());\n    } else {\n      newEntries[idx] = [key, value];\n    }\n  } else {\n    newEntries.push([key, value]);\n  }\n\n  if (isEditable) {\n    this.entries = newEntries;\n    return this;\n  }\n\n  return new HashCollisionNode(ownerID, this.keyHash, newEntries);\n};\n\nvar ValueNode = function ValueNode(ownerID, keyHash, entry) {\n  this.ownerID = ownerID;\n  this.keyHash = keyHash;\n  this.entry = entry;\n};\n\nValueNode.prototype.get = function get (shift, keyHash, key, notSetValue) {\n  return is(key, this.entry[0]) ? this.entry[1] : notSetValue;\n};\n\nValueNode.prototype.update = function update (ownerID, shift, keyHash, key, value, didChangeSize, didAlter) {\n  var removed = value === NOT_SET;\n  var keyMatch = is(key, this.entry[0]);\n  if (keyMatch ? value === this.entry[1] : removed) {\n    return this;\n  }\n\n  SetRef(didAlter);\n\n  if (removed) {\n    SetRef(didChangeSize);\n    return; // undefined\n  }\n\n  if (keyMatch) {\n    if (ownerID && ownerID === this.ownerID) {\n      this.entry[1] = value;\n      return this;\n    }\n    return new ValueNode(ownerID, this.keyHash, [key, value]);\n  }\n\n  SetRef(didChangeSize);\n  return mergeIntoNode(this, ownerID, shift, hash(key), [key, value]);\n};\n\n// #pragma Iterators\n\nArrayMapNode.prototype.iterate = HashCollisionNode.prototype.iterate =\n  function (fn, reverse) {\n    var entries = this.entries;\n    for (var ii = 0, maxIndex = entries.length - 1; ii <= maxIndex; ii++) {\n      if (fn(entries[reverse ? maxIndex - ii : ii]) === false) {\n        return false;\n      }\n    }\n  };\n\nBitmapIndexedNode.prototype.iterate = HashArrayMapNode.prototype.iterate =\n  function (fn, reverse) {\n    var nodes = this.nodes;\n    for (var ii = 0, maxIndex = nodes.length - 1; ii <= maxIndex; ii++) {\n      var node = nodes[reverse ? maxIndex - ii : ii];\n      if (node && node.iterate(fn, reverse) === false) {\n        return false;\n      }\n    }\n  };\n\n// eslint-disable-next-line no-unused-vars\nValueNode.prototype.iterate = function (fn, reverse) {\n  return fn(this.entry);\n};\n\nvar MapIterator = /*@__PURE__*/(function (Iterator) {\n  function MapIterator(map, type, reverse) {\n    this._type = type;\n    this._reverse = reverse;\n    this._stack = map._root && mapIteratorFrame(map._root);\n  }\n\n  if ( Iterator ) MapIterator.__proto__ = Iterator;\n  MapIterator.prototype = Object.create( Iterator && Iterator.prototype );\n  MapIterator.prototype.constructor = MapIterator;\n\n  MapIterator.prototype.next = function next () {\n    var type = this._type;\n    var stack = this._stack;\n    while (stack) {\n      var node = stack.node;\n      var index = stack.index++;\n      var maxIndex = (void 0);\n      if (node.entry) {\n        if (index === 0) {\n          return mapIteratorValue(type, node.entry);\n        }\n      } else if (node.entries) {\n        maxIndex = node.entries.length - 1;\n        if (index <= maxIndex) {\n          return mapIteratorValue(\n            type,\n            node.entries[this._reverse ? maxIndex - index : index]\n          );\n        }\n      } else {\n        maxIndex = node.nodes.length - 1;\n        if (index <= maxIndex) {\n          var subNode = node.nodes[this._reverse ? maxIndex - index : index];\n          if (subNode) {\n            if (subNode.entry) {\n              return mapIteratorValue(type, subNode.entry);\n            }\n            stack = this._stack = mapIteratorFrame(subNode, stack);\n          }\n          continue;\n        }\n      }\n      stack = this._stack = this._stack.__prev;\n    }\n    return iteratorDone();\n  };\n\n  return MapIterator;\n}(Iterator));\n\nfunction mapIteratorValue(type, entry) {\n  return iteratorValue(type, entry[0], entry[1]);\n}\n\nfunction mapIteratorFrame(node, prev) {\n  return {\n    node: node,\n    index: 0,\n    __prev: prev,\n  };\n}\n\nfunction makeMap(size, root, ownerID, hash) {\n  var map = Object.create(MapPrototype);\n  map.size = size;\n  map._root = root;\n  map.__ownerID = ownerID;\n  map.__hash = hash;\n  map.__altered = false;\n  return map;\n}\n\nvar EMPTY_MAP;\nfunction emptyMap() {\n  return EMPTY_MAP || (EMPTY_MAP = makeMap(0));\n}\n\nfunction updateMap(map, k, v) {\n  var newRoot;\n  var newSize;\n  if (!map._root) {\n    if (v === NOT_SET) {\n      return map;\n    }\n    newSize = 1;\n    newRoot = new ArrayMapNode(map.__ownerID, [[k, v]]);\n  } else {\n    var didChangeSize = MakeRef();\n    var didAlter = MakeRef();\n    newRoot = updateNode(\n      map._root,\n      map.__ownerID,\n      0,\n      undefined,\n      k,\n      v,\n      didChangeSize,\n      didAlter\n    );\n    if (!didAlter.value) {\n      return map;\n    }\n    newSize = map.size + (didChangeSize.value ? (v === NOT_SET ? -1 : 1) : 0);\n  }\n  if (map.__ownerID) {\n    map.size = newSize;\n    map._root = newRoot;\n    map.__hash = undefined;\n    map.__altered = true;\n    return map;\n  }\n  return newRoot ? makeMap(newSize, newRoot) : emptyMap();\n}\n\nfunction updateNode(\n  node,\n  ownerID,\n  shift,\n  keyHash,\n  key,\n  value,\n  didChangeSize,\n  didAlter\n) {\n  if (!node) {\n    if (value === NOT_SET) {\n      return node;\n    }\n    SetRef(didAlter);\n    SetRef(didChangeSize);\n    return new ValueNode(ownerID, keyHash, [key, value]);\n  }\n  return node.update(\n    ownerID,\n    shift,\n    keyHash,\n    key,\n    value,\n    didChangeSize,\n    didAlter\n  );\n}\n\nfunction isLeafNode(node) {\n  return (\n    node.constructor === ValueNode || node.constructor === HashCollisionNode\n  );\n}\n\nfunction mergeIntoNode(node, ownerID, shift, keyHash, entry) {\n  if (node.keyHash === keyHash) {\n    return new HashCollisionNode(ownerID, keyHash, [node.entry, entry]);\n  }\n\n  var idx1 = (shift === 0 ? node.keyHash : node.keyHash >>> shift) & MASK;\n  var idx2 = (shift === 0 ? keyHash : keyHash >>> shift) & MASK;\n\n  var newNode;\n  var nodes =\n    idx1 === idx2\n      ? [mergeIntoNode(node, ownerID, shift + SHIFT, keyHash, entry)]\n      : ((newNode = new ValueNode(ownerID, keyHash, entry)),\n        idx1 < idx2 ? [node, newNode] : [newNode, node]);\n\n  return new BitmapIndexedNode(ownerID, (1 << idx1) | (1 << idx2), nodes);\n}\n\nfunction createNodes(ownerID, entries, key, value) {\n  if (!ownerID) {\n    ownerID = new OwnerID();\n  }\n  var node = new ValueNode(ownerID, hash(key), [key, value]);\n  for (var ii = 0; ii < entries.length; ii++) {\n    var entry = entries[ii];\n    node = node.update(ownerID, 0, undefined, entry[0], entry[1]);\n  }\n  return node;\n}\n\nfunction packNodes(ownerID, nodes, count, excluding) {\n  var bitmap = 0;\n  var packedII = 0;\n  var packedNodes = new Array(count);\n  for (var ii = 0, bit = 1, len = nodes.length; ii < len; ii++, bit <<= 1) {\n    var node = nodes[ii];\n    if (node !== undefined && ii !== excluding) {\n      bitmap |= bit;\n      packedNodes[packedII++] = node;\n    }\n  }\n  return new BitmapIndexedNode(ownerID, bitmap, packedNodes);\n}\n\nfunction expandNodes(ownerID, nodes, bitmap, including, node) {\n  var count = 0;\n  var expandedNodes = new Array(SIZE);\n  for (var ii = 0; bitmap !== 0; ii++, bitmap >>>= 1) {\n    expandedNodes[ii] = bitmap & 1 ? nodes[count++] : undefined;\n  }\n  expandedNodes[including] = node;\n  return new HashArrayMapNode(ownerID, count + 1, expandedNodes);\n}\n\nfunction popCount(x) {\n  x -= (x >> 1) & 0x55555555;\n  x = (x & 0x33333333) + ((x >> 2) & 0x33333333);\n  x = (x + (x >> 4)) & 0x0f0f0f0f;\n  x += x >> 8;\n  x += x >> 16;\n  return x & 0x7f;\n}\n\nfunction setAt(array, idx, val, canEdit) {\n  var newArray = canEdit ? array : arrCopy(array);\n  newArray[idx] = val;\n  return newArray;\n}\n\nfunction spliceIn(array, idx, val, canEdit) {\n  var newLen = array.length + 1;\n  if (canEdit && idx + 1 === newLen) {\n    array[idx] = val;\n    return array;\n  }\n  var newArray = new Array(newLen);\n  var after = 0;\n  for (var ii = 0; ii < newLen; ii++) {\n    if (ii === idx) {\n      newArray[ii] = val;\n      after = -1;\n    } else {\n      newArray[ii] = array[ii + after];\n    }\n  }\n  return newArray;\n}\n\nfunction spliceOut(array, idx, canEdit) {\n  var newLen = array.length - 1;\n  if (canEdit && idx === newLen) {\n    array.pop();\n    return array;\n  }\n  var newArray = new Array(newLen);\n  var after = 0;\n  for (var ii = 0; ii < newLen; ii++) {\n    if (ii === idx) {\n      after = 1;\n    }\n    newArray[ii] = array[ii + after];\n  }\n  return newArray;\n}\n\nvar MAX_ARRAY_MAP_SIZE = SIZE / 4;\nvar MAX_BITMAP_INDEXED_SIZE = SIZE / 2;\nvar MIN_HASH_ARRAY_MAP_SIZE = SIZE / 4;\n\nvar IS_LIST_SYMBOL = '@@__IMMUTABLE_LIST__@@';\n\nfunction isList(maybeList) {\n  return Boolean(maybeList && maybeList[IS_LIST_SYMBOL]);\n}\n\nvar List = /*@__PURE__*/(function (IndexedCollection) {\n  function List(value) {\n    var empty = emptyList();\n    if (value === undefined || value === null) {\n      return empty;\n    }\n    if (isList(value)) {\n      return value;\n    }\n    var iter = IndexedCollection(value);\n    var size = iter.size;\n    if (size === 0) {\n      return empty;\n    }\n    assertNotInfinite(size);\n    if (size > 0 && size < SIZE) {\n      return makeList(0, size, SHIFT, null, new VNode(iter.toArray()));\n    }\n    return empty.withMutations(function (list) {\n      list.setSize(size);\n      iter.forEach(function (v, i) { return list.set(i, v); });\n    });\n  }\n\n  if ( IndexedCollection ) List.__proto__ = IndexedCollection;\n  List.prototype = Object.create( IndexedCollection && IndexedCollection.prototype );\n  List.prototype.constructor = List;\n\n  List.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  List.prototype.toString = function toString () {\n    return this.__toString('List [', ']');\n  };\n\n  // @pragma Access\n\n  List.prototype.get = function get (index, notSetValue) {\n    index = wrapIndex(this, index);\n    if (index >= 0 && index < this.size) {\n      index += this._origin;\n      var node = listNodeFor(this, index);\n      return node && node.array[index & MASK];\n    }\n    return notSetValue;\n  };\n\n  // @pragma Modification\n\n  List.prototype.set = function set (index, value) {\n    return updateList(this, index, value);\n  };\n\n  List.prototype.remove = function remove (index) {\n    return !this.has(index)\n      ? this\n      : index === 0\n      ? this.shift()\n      : index === this.size - 1\n      ? this.pop()\n      : this.splice(index, 1);\n  };\n\n  List.prototype.insert = function insert (index, value) {\n    return this.splice(index, 0, value);\n  };\n\n  List.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = this._origin = this._capacity = 0;\n      this._level = SHIFT;\n      this._root = this._tail = this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyList();\n  };\n\n  List.prototype.push = function push (/*...values*/) {\n    var values = arguments;\n    var oldSize = this.size;\n    return this.withMutations(function (list) {\n      setListBounds(list, 0, oldSize + values.length);\n      for (var ii = 0; ii < values.length; ii++) {\n        list.set(oldSize + ii, values[ii]);\n      }\n    });\n  };\n\n  List.prototype.pop = function pop () {\n    return setListBounds(this, 0, -1);\n  };\n\n  List.prototype.unshift = function unshift (/*...values*/) {\n    var values = arguments;\n    return this.withMutations(function (list) {\n      setListBounds(list, -values.length);\n      for (var ii = 0; ii < values.length; ii++) {\n        list.set(ii, values[ii]);\n      }\n    });\n  };\n\n  List.prototype.shift = function shift () {\n    return setListBounds(this, 1);\n  };\n\n  // @pragma Composition\n\n  List.prototype.concat = function concat (/*...collections*/) {\n    var arguments$1 = arguments;\n\n    var seqs = [];\n    for (var i = 0; i < arguments.length; i++) {\n      var argument = arguments$1[i];\n      var seq = IndexedCollection(\n        typeof argument !== 'string' && hasIterator(argument)\n          ? argument\n          : [argument]\n      );\n      if (seq.size !== 0) {\n        seqs.push(seq);\n      }\n    }\n    if (seqs.length === 0) {\n      return this;\n    }\n    if (this.size === 0 && !this.__ownerID && seqs.length === 1) {\n      return this.constructor(seqs[0]);\n    }\n    return this.withMutations(function (list) {\n      seqs.forEach(function (seq) { return seq.forEach(function (value) { return list.push(value); }); });\n    });\n  };\n\n  List.prototype.setSize = function setSize (size) {\n    return setListBounds(this, 0, size);\n  };\n\n  List.prototype.map = function map (mapper, context) {\n    var this$1$1 = this;\n\n    return this.withMutations(function (list) {\n      for (var i = 0; i < this$1$1.size; i++) {\n        list.set(i, mapper.call(context, list.get(i), i, this$1$1));\n      }\n    });\n  };\n\n  // @pragma Iteration\n\n  List.prototype.slice = function slice (begin, end) {\n    var size = this.size;\n    if (wholeSlice(begin, end, size)) {\n      return this;\n    }\n    return setListBounds(\n      this,\n      resolveBegin(begin, size),\n      resolveEnd(end, size)\n    );\n  };\n\n  List.prototype.__iterator = function __iterator (type, reverse) {\n    var index = reverse ? this.size : 0;\n    var values = iterateList(this, reverse);\n    return new Iterator(function () {\n      var value = values();\n      return value === DONE\n        ? iteratorDone()\n        : iteratorValue(type, reverse ? --index : index++, value);\n    });\n  };\n\n  List.prototype.__iterate = function __iterate (fn, reverse) {\n    var index = reverse ? this.size : 0;\n    var values = iterateList(this, reverse);\n    var value;\n    while ((value = values()) !== DONE) {\n      if (fn(value, reverse ? --index : index++, this) === false) {\n        break;\n      }\n    }\n    return index;\n  };\n\n  List.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyList();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeList(\n      this._origin,\n      this._capacity,\n      this._level,\n      this._root,\n      this._tail,\n      ownerID,\n      this.__hash\n    );\n  };\n\n  return List;\n}(IndexedCollection));\n\nList.isList = isList;\n\nvar ListPrototype = List.prototype;\nListPrototype[IS_LIST_SYMBOL] = true;\nListPrototype[DELETE] = ListPrototype.remove;\nListPrototype.merge = ListPrototype.concat;\nListPrototype.setIn = setIn;\nListPrototype.deleteIn = ListPrototype.removeIn = deleteIn;\nListPrototype.update = update;\nListPrototype.updateIn = updateIn;\nListPrototype.mergeIn = mergeIn;\nListPrototype.mergeDeepIn = mergeDeepIn;\nListPrototype.withMutations = withMutations;\nListPrototype.wasAltered = wasAltered;\nListPrototype.asImmutable = asImmutable;\nListPrototype['@@transducer/init'] = ListPrototype.asMutable = asMutable;\nListPrototype['@@transducer/step'] = function (result, arr) {\n  return result.push(arr);\n};\nListPrototype['@@transducer/result'] = function (obj) {\n  return obj.asImmutable();\n};\n\nvar VNode = function VNode(array, ownerID) {\n  this.array = array;\n  this.ownerID = ownerID;\n};\n\n// TODO: seems like these methods are very similar\n\nVNode.prototype.removeBefore = function removeBefore (ownerID, level, index) {\n  if (index === level ? 1 << level : this.array.length === 0) {\n    return this;\n  }\n  var originIndex = (index >>> level) & MASK;\n  if (originIndex >= this.array.length) {\n    return new VNode([], ownerID);\n  }\n  var removingFirst = originIndex === 0;\n  var newChild;\n  if (level > 0) {\n    var oldChild = this.array[originIndex];\n    newChild =\n      oldChild && oldChild.removeBefore(ownerID, level - SHIFT, index);\n    if (newChild === oldChild && removingFirst) {\n      return this;\n    }\n  }\n  if (removingFirst && !newChild) {\n    return this;\n  }\n  var editable = editableVNode(this, ownerID);\n  if (!removingFirst) {\n    for (var ii = 0; ii < originIndex; ii++) {\n      editable.array[ii] = undefined;\n    }\n  }\n  if (newChild) {\n    editable.array[originIndex] = newChild;\n  }\n  return editable;\n};\n\nVNode.prototype.removeAfter = function removeAfter (ownerID, level, index) {\n  if (index === (level ? 1 << level : 0) || this.array.length === 0) {\n    return this;\n  }\n  var sizeIndex = ((index - 1) >>> level) & MASK;\n  if (sizeIndex >= this.array.length) {\n    return this;\n  }\n\n  var newChild;\n  if (level > 0) {\n    var oldChild = this.array[sizeIndex];\n    newChild =\n      oldChild && oldChild.removeAfter(ownerID, level - SHIFT, index);\n    if (newChild === oldChild && sizeIndex === this.array.length - 1) {\n      return this;\n    }\n  }\n\n  var editable = editableVNode(this, ownerID);\n  editable.array.splice(sizeIndex + 1);\n  if (newChild) {\n    editable.array[sizeIndex] = newChild;\n  }\n  return editable;\n};\n\nvar DONE = {};\n\nfunction iterateList(list, reverse) {\n  var left = list._origin;\n  var right = list._capacity;\n  var tailPos = getTailOffset(right);\n  var tail = list._tail;\n\n  return iterateNodeOrLeaf(list._root, list._level, 0);\n\n  function iterateNodeOrLeaf(node, level, offset) {\n    return level === 0\n      ? iterateLeaf(node, offset)\n      : iterateNode(node, level, offset);\n  }\n\n  function iterateLeaf(node, offset) {\n    var array = offset === tailPos ? tail && tail.array : node && node.array;\n    var from = offset > left ? 0 : left - offset;\n    var to = right - offset;\n    if (to > SIZE) {\n      to = SIZE;\n    }\n    return function () {\n      if (from === to) {\n        return DONE;\n      }\n      var idx = reverse ? --to : from++;\n      return array && array[idx];\n    };\n  }\n\n  function iterateNode(node, level, offset) {\n    var values;\n    var array = node && node.array;\n    var from = offset > left ? 0 : (left - offset) >> level;\n    var to = ((right - offset) >> level) + 1;\n    if (to > SIZE) {\n      to = SIZE;\n    }\n    return function () {\n      while (true) {\n        if (values) {\n          var value = values();\n          if (value !== DONE) {\n            return value;\n          }\n          values = null;\n        }\n        if (from === to) {\n          return DONE;\n        }\n        var idx = reverse ? --to : from++;\n        values = iterateNodeOrLeaf(\n          array && array[idx],\n          level - SHIFT,\n          offset + (idx << level)\n        );\n      }\n    };\n  }\n}\n\nfunction makeList(origin, capacity, level, root, tail, ownerID, hash) {\n  var list = Object.create(ListPrototype);\n  list.size = capacity - origin;\n  list._origin = origin;\n  list._capacity = capacity;\n  list._level = level;\n  list._root = root;\n  list._tail = tail;\n  list.__ownerID = ownerID;\n  list.__hash = hash;\n  list.__altered = false;\n  return list;\n}\n\nvar EMPTY_LIST;\nfunction emptyList() {\n  return EMPTY_LIST || (EMPTY_LIST = makeList(0, 0, SHIFT));\n}\n\nfunction updateList(list, index, value) {\n  index = wrapIndex(list, index);\n\n  if (index !== index) {\n    return list;\n  }\n\n  if (index >= list.size || index < 0) {\n    return list.withMutations(function (list) {\n      index < 0\n        ? setListBounds(list, index).set(0, value)\n        : setListBounds(list, 0, index + 1).set(index, value);\n    });\n  }\n\n  index += list._origin;\n\n  var newTail = list._tail;\n  var newRoot = list._root;\n  var didAlter = MakeRef();\n  if (index >= getTailOffset(list._capacity)) {\n    newTail = updateVNode(newTail, list.__ownerID, 0, index, value, didAlter);\n  } else {\n    newRoot = updateVNode(\n      newRoot,\n      list.__ownerID,\n      list._level,\n      index,\n      value,\n      didAlter\n    );\n  }\n\n  if (!didAlter.value) {\n    return list;\n  }\n\n  if (list.__ownerID) {\n    list._root = newRoot;\n    list._tail = newTail;\n    list.__hash = undefined;\n    list.__altered = true;\n    return list;\n  }\n  return makeList(list._origin, list._capacity, list._level, newRoot, newTail);\n}\n\nfunction updateVNode(node, ownerID, level, index, value, didAlter) {\n  var idx = (index >>> level) & MASK;\n  var nodeHas = node && idx < node.array.length;\n  if (!nodeHas && value === undefined) {\n    return node;\n  }\n\n  var newNode;\n\n  if (level > 0) {\n    var lowerNode = node && node.array[idx];\n    var newLowerNode = updateVNode(\n      lowerNode,\n      ownerID,\n      level - SHIFT,\n      index,\n      value,\n      didAlter\n    );\n    if (newLowerNode === lowerNode) {\n      return node;\n    }\n    newNode = editableVNode(node, ownerID);\n    newNode.array[idx] = newLowerNode;\n    return newNode;\n  }\n\n  if (nodeHas && node.array[idx] === value) {\n    return node;\n  }\n\n  if (didAlter) {\n    SetRef(didAlter);\n  }\n\n  newNode = editableVNode(node, ownerID);\n  if (value === undefined && idx === newNode.array.length - 1) {\n    newNode.array.pop();\n  } else {\n    newNode.array[idx] = value;\n  }\n  return newNode;\n}\n\nfunction editableVNode(node, ownerID) {\n  if (ownerID && node && ownerID === node.ownerID) {\n    return node;\n  }\n  return new VNode(node ? node.array.slice() : [], ownerID);\n}\n\nfunction listNodeFor(list, rawIndex) {\n  if (rawIndex >= getTailOffset(list._capacity)) {\n    return list._tail;\n  }\n  if (rawIndex < 1 << (list._level + SHIFT)) {\n    var node = list._root;\n    var level = list._level;\n    while (node && level > 0) {\n      node = node.array[(rawIndex >>> level) & MASK];\n      level -= SHIFT;\n    }\n    return node;\n  }\n}\n\nfunction setListBounds(list, begin, end) {\n  // Sanitize begin & end using this shorthand for ToInt32(argument)\n  // http://www.ecma-international.org/ecma-262/6.0/#sec-toint32\n  if (begin !== undefined) {\n    begin |= 0;\n  }\n  if (end !== undefined) {\n    end |= 0;\n  }\n  var owner = list.__ownerID || new OwnerID();\n  var oldOrigin = list._origin;\n  var oldCapacity = list._capacity;\n  var newOrigin = oldOrigin + begin;\n  var newCapacity =\n    end === undefined\n      ? oldCapacity\n      : end < 0\n      ? oldCapacity + end\n      : oldOrigin + end;\n  if (newOrigin === oldOrigin && newCapacity === oldCapacity) {\n    return list;\n  }\n\n  // If it's going to end after it starts, it's empty.\n  if (newOrigin >= newCapacity) {\n    return list.clear();\n  }\n\n  var newLevel = list._level;\n  var newRoot = list._root;\n\n  // New origin might need creating a higher root.\n  var offsetShift = 0;\n  while (newOrigin + offsetShift < 0) {\n    newRoot = new VNode(\n      newRoot && newRoot.array.length ? [undefined, newRoot] : [],\n      owner\n    );\n    newLevel += SHIFT;\n    offsetShift += 1 << newLevel;\n  }\n  if (offsetShift) {\n    newOrigin += offsetShift;\n    oldOrigin += offsetShift;\n    newCapacity += offsetShift;\n    oldCapacity += offsetShift;\n  }\n\n  var oldTailOffset = getTailOffset(oldCapacity);\n  var newTailOffset = getTailOffset(newCapacity);\n\n  // New size might need creating a higher root.\n  while (newTailOffset >= 1 << (newLevel + SHIFT)) {\n    newRoot = new VNode(\n      newRoot && newRoot.array.length ? [newRoot] : [],\n      owner\n    );\n    newLevel += SHIFT;\n  }\n\n  // Locate or create the new tail.\n  var oldTail = list._tail;\n  var newTail =\n    newTailOffset < oldTailOffset\n      ? listNodeFor(list, newCapacity - 1)\n      : newTailOffset > oldTailOffset\n      ? new VNode([], owner)\n      : oldTail;\n\n  // Merge Tail into tree.\n  if (\n    oldTail &&\n    newTailOffset > oldTailOffset &&\n    newOrigin < oldCapacity &&\n    oldTail.array.length\n  ) {\n    newRoot = editableVNode(newRoot, owner);\n    var node = newRoot;\n    for (var level = newLevel; level > SHIFT; level -= SHIFT) {\n      var idx = (oldTailOffset >>> level) & MASK;\n      node = node.array[idx] = editableVNode(node.array[idx], owner);\n    }\n    node.array[(oldTailOffset >>> SHIFT) & MASK] = oldTail;\n  }\n\n  // If the size has been reduced, there's a chance the tail needs to be trimmed.\n  if (newCapacity < oldCapacity) {\n    newTail = newTail && newTail.removeAfter(owner, 0, newCapacity);\n  }\n\n  // If the new origin is within the tail, then we do not need a root.\n  if (newOrigin >= newTailOffset) {\n    newOrigin -= newTailOffset;\n    newCapacity -= newTailOffset;\n    newLevel = SHIFT;\n    newRoot = null;\n    newTail = newTail && newTail.removeBefore(owner, 0, newOrigin);\n\n    // Otherwise, if the root has been trimmed, garbage collect.\n  } else if (newOrigin > oldOrigin || newTailOffset < oldTailOffset) {\n    offsetShift = 0;\n\n    // Identify the new top root node of the subtree of the old root.\n    while (newRoot) {\n      var beginIndex = (newOrigin >>> newLevel) & MASK;\n      if ((beginIndex !== newTailOffset >>> newLevel) & MASK) {\n        break;\n      }\n      if (beginIndex) {\n        offsetShift += (1 << newLevel) * beginIndex;\n      }\n      newLevel -= SHIFT;\n      newRoot = newRoot.array[beginIndex];\n    }\n\n    // Trim the new sides of the new root.\n    if (newRoot && newOrigin > oldOrigin) {\n      newRoot = newRoot.removeBefore(owner, newLevel, newOrigin - offsetShift);\n    }\n    if (newRoot && newTailOffset < oldTailOffset) {\n      newRoot = newRoot.removeAfter(\n        owner,\n        newLevel,\n        newTailOffset - offsetShift\n      );\n    }\n    if (offsetShift) {\n      newOrigin -= offsetShift;\n      newCapacity -= offsetShift;\n    }\n  }\n\n  if (list.__ownerID) {\n    list.size = newCapacity - newOrigin;\n    list._origin = newOrigin;\n    list._capacity = newCapacity;\n    list._level = newLevel;\n    list._root = newRoot;\n    list._tail = newTail;\n    list.__hash = undefined;\n    list.__altered = true;\n    return list;\n  }\n  return makeList(newOrigin, newCapacity, newLevel, newRoot, newTail);\n}\n\nfunction getTailOffset(size) {\n  return size < SIZE ? 0 : ((size - 1) >>> SHIFT) << SHIFT;\n}\n\nvar OrderedMap = /*@__PURE__*/(function (Map) {\n  function OrderedMap(value) {\n    return value === undefined || value === null\n      ? emptyOrderedMap()\n      : isOrderedMap(value)\n      ? value\n      : emptyOrderedMap().withMutations(function (map) {\n          var iter = KeyedCollection(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function (v, k) { return map.set(k, v); });\n        });\n  }\n\n  if ( Map ) OrderedMap.__proto__ = Map;\n  OrderedMap.prototype = Object.create( Map && Map.prototype );\n  OrderedMap.prototype.constructor = OrderedMap;\n\n  OrderedMap.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  OrderedMap.prototype.toString = function toString () {\n    return this.__toString('OrderedMap {', '}');\n  };\n\n  // @pragma Access\n\n  OrderedMap.prototype.get = function get (k, notSetValue) {\n    var index = this._map.get(k);\n    return index !== undefined ? this._list.get(index)[1] : notSetValue;\n  };\n\n  // @pragma Modification\n\n  OrderedMap.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._map.clear();\n      this._list.clear();\n      this.__altered = true;\n      return this;\n    }\n    return emptyOrderedMap();\n  };\n\n  OrderedMap.prototype.set = function set (k, v) {\n    return updateOrderedMap(this, k, v);\n  };\n\n  OrderedMap.prototype.remove = function remove (k) {\n    return updateOrderedMap(this, k, NOT_SET);\n  };\n\n  OrderedMap.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    return this._list.__iterate(\n      function (entry) { return entry && fn(entry[1], entry[0], this$1$1); },\n      reverse\n    );\n  };\n\n  OrderedMap.prototype.__iterator = function __iterator (type, reverse) {\n    return this._list.fromEntrySeq().__iterator(type, reverse);\n  };\n\n  OrderedMap.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    var newMap = this._map.__ensureOwner(ownerID);\n    var newList = this._list.__ensureOwner(ownerID);\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyOrderedMap();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      this._map = newMap;\n      this._list = newList;\n      return this;\n    }\n    return makeOrderedMap(newMap, newList, ownerID, this.__hash);\n  };\n\n  return OrderedMap;\n}(Map));\n\nOrderedMap.isOrderedMap = isOrderedMap;\n\nOrderedMap.prototype[IS_ORDERED_SYMBOL] = true;\nOrderedMap.prototype[DELETE] = OrderedMap.prototype.remove;\n\nfunction makeOrderedMap(map, list, ownerID, hash) {\n  var omap = Object.create(OrderedMap.prototype);\n  omap.size = map ? map.size : 0;\n  omap._map = map;\n  omap._list = list;\n  omap.__ownerID = ownerID;\n  omap.__hash = hash;\n  omap.__altered = false;\n  return omap;\n}\n\nvar EMPTY_ORDERED_MAP;\nfunction emptyOrderedMap() {\n  return (\n    EMPTY_ORDERED_MAP ||\n    (EMPTY_ORDERED_MAP = makeOrderedMap(emptyMap(), emptyList()))\n  );\n}\n\nfunction updateOrderedMap(omap, k, v) {\n  var map = omap._map;\n  var list = omap._list;\n  var i = map.get(k);\n  var has = i !== undefined;\n  var newMap;\n  var newList;\n  if (v === NOT_SET) {\n    // removed\n    if (!has) {\n      return omap;\n    }\n    if (list.size >= SIZE && list.size >= map.size * 2) {\n      newList = list.filter(function (entry, idx) { return entry !== undefined && i !== idx; });\n      newMap = newList\n        .toKeyedSeq()\n        .map(function (entry) { return entry[0]; })\n        .flip()\n        .toMap();\n      if (omap.__ownerID) {\n        newMap.__ownerID = newList.__ownerID = omap.__ownerID;\n      }\n    } else {\n      newMap = map.remove(k);\n      newList = i === list.size - 1 ? list.pop() : list.set(i, undefined);\n    }\n  } else if (has) {\n    if (v === list.get(i)[1]) {\n      return omap;\n    }\n    newMap = map;\n    newList = list.set(i, [k, v]);\n  } else {\n    newMap = map.set(k, list.size);\n    newList = list.set(list.size, [k, v]);\n  }\n  if (omap.__ownerID) {\n    omap.size = newMap.size;\n    omap._map = newMap;\n    omap._list = newList;\n    omap.__hash = undefined;\n    omap.__altered = true;\n    return omap;\n  }\n  return makeOrderedMap(newMap, newList);\n}\n\nvar IS_STACK_SYMBOL = '@@__IMMUTABLE_STACK__@@';\n\nfunction isStack(maybeStack) {\n  return Boolean(maybeStack && maybeStack[IS_STACK_SYMBOL]);\n}\n\nvar Stack = /*@__PURE__*/(function (IndexedCollection) {\n  function Stack(value) {\n    return value === undefined || value === null\n      ? emptyStack()\n      : isStack(value)\n      ? value\n      : emptyStack().pushAll(value);\n  }\n\n  if ( IndexedCollection ) Stack.__proto__ = IndexedCollection;\n  Stack.prototype = Object.create( IndexedCollection && IndexedCollection.prototype );\n  Stack.prototype.constructor = Stack;\n\n  Stack.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  Stack.prototype.toString = function toString () {\n    return this.__toString('Stack [', ']');\n  };\n\n  // @pragma Access\n\n  Stack.prototype.get = function get (index, notSetValue) {\n    var head = this._head;\n    index = wrapIndex(this, index);\n    while (head && index--) {\n      head = head.next;\n    }\n    return head ? head.value : notSetValue;\n  };\n\n  Stack.prototype.peek = function peek () {\n    return this._head && this._head.value;\n  };\n\n  // @pragma Modification\n\n  Stack.prototype.push = function push (/*...values*/) {\n    var arguments$1 = arguments;\n\n    if (arguments.length === 0) {\n      return this;\n    }\n    var newSize = this.size + arguments.length;\n    var head = this._head;\n    for (var ii = arguments.length - 1; ii >= 0; ii--) {\n      head = {\n        value: arguments$1[ii],\n        next: head,\n      };\n    }\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  Stack.prototype.pushAll = function pushAll (iter) {\n    iter = IndexedCollection(iter);\n    if (iter.size === 0) {\n      return this;\n    }\n    if (this.size === 0 && isStack(iter)) {\n      return iter;\n    }\n    assertNotInfinite(iter.size);\n    var newSize = this.size;\n    var head = this._head;\n    iter.__iterate(function (value) {\n      newSize++;\n      head = {\n        value: value,\n        next: head,\n      };\n    }, /* reverse */ true);\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  Stack.prototype.pop = function pop () {\n    return this.slice(1);\n  };\n\n  Stack.prototype.clear = function clear () {\n    if (this.size === 0) {\n      return this;\n    }\n    if (this.__ownerID) {\n      this.size = 0;\n      this._head = undefined;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return emptyStack();\n  };\n\n  Stack.prototype.slice = function slice (begin, end) {\n    if (wholeSlice(begin, end, this.size)) {\n      return this;\n    }\n    var resolvedBegin = resolveBegin(begin, this.size);\n    var resolvedEnd = resolveEnd(end, this.size);\n    if (resolvedEnd !== this.size) {\n      // super.slice(begin, end);\n      return IndexedCollection.prototype.slice.call(this, begin, end);\n    }\n    var newSize = this.size - resolvedBegin;\n    var head = this._head;\n    while (resolvedBegin--) {\n      head = head.next;\n    }\n    if (this.__ownerID) {\n      this.size = newSize;\n      this._head = head;\n      this.__hash = undefined;\n      this.__altered = true;\n      return this;\n    }\n    return makeStack(newSize, head);\n  };\n\n  // @pragma Mutability\n\n  Stack.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    if (!ownerID) {\n      if (this.size === 0) {\n        return emptyStack();\n      }\n      this.__ownerID = ownerID;\n      this.__altered = false;\n      return this;\n    }\n    return makeStack(this.size, this._head, ownerID, this.__hash);\n  };\n\n  // @pragma Iteration\n\n  Stack.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    if (reverse) {\n      return new ArraySeq(this.toArray()).__iterate(\n        function (v, k) { return fn(v, k, this$1$1); },\n        reverse\n      );\n    }\n    var iterations = 0;\n    var node = this._head;\n    while (node) {\n      if (fn(node.value, iterations++, this) === false) {\n        break;\n      }\n      node = node.next;\n    }\n    return iterations;\n  };\n\n  Stack.prototype.__iterator = function __iterator (type, reverse) {\n    if (reverse) {\n      return new ArraySeq(this.toArray()).__iterator(type, reverse);\n    }\n    var iterations = 0;\n    var node = this._head;\n    return new Iterator(function () {\n      if (node) {\n        var value = node.value;\n        node = node.next;\n        return iteratorValue(type, iterations++, value);\n      }\n      return iteratorDone();\n    });\n  };\n\n  return Stack;\n}(IndexedCollection));\n\nStack.isStack = isStack;\n\nvar StackPrototype = Stack.prototype;\nStackPrototype[IS_STACK_SYMBOL] = true;\nStackPrototype.shift = StackPrototype.pop;\nStackPrototype.unshift = StackPrototype.push;\nStackPrototype.unshiftAll = StackPrototype.pushAll;\nStackPrototype.withMutations = withMutations;\nStackPrototype.wasAltered = wasAltered;\nStackPrototype.asImmutable = asImmutable;\nStackPrototype['@@transducer/init'] = StackPrototype.asMutable = asMutable;\nStackPrototype['@@transducer/step'] = function (result, arr) {\n  return result.unshift(arr);\n};\nStackPrototype['@@transducer/result'] = function (obj) {\n  return obj.asImmutable();\n};\n\nfunction makeStack(size, head, ownerID, hash) {\n  var map = Object.create(StackPrototype);\n  map.size = size;\n  map._head = head;\n  map.__ownerID = ownerID;\n  map.__hash = hash;\n  map.__altered = false;\n  return map;\n}\n\nvar EMPTY_STACK;\nfunction emptyStack() {\n  return EMPTY_STACK || (EMPTY_STACK = makeStack(0));\n}\n\nvar IS_SET_SYMBOL = '@@__IMMUTABLE_SET__@@';\n\nfunction isSet(maybeSet) {\n  return Boolean(maybeSet && maybeSet[IS_SET_SYMBOL]);\n}\n\nfunction isOrderedSet(maybeOrderedSet) {\n  return isSet(maybeOrderedSet) && isOrdered(maybeOrderedSet);\n}\n\nfunction deepEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (\n    !isCollection(b) ||\n    (a.size !== undefined && b.size !== undefined && a.size !== b.size) ||\n    (a.__hash !== undefined &&\n      b.__hash !== undefined &&\n      a.__hash !== b.__hash) ||\n    isKeyed(a) !== isKeyed(b) ||\n    isIndexed(a) !== isIndexed(b) ||\n    isOrdered(a) !== isOrdered(b)\n  ) {\n    return false;\n  }\n\n  if (a.size === 0 && b.size === 0) {\n    return true;\n  }\n\n  var notAssociative = !isAssociative(a);\n\n  if (isOrdered(a)) {\n    var entries = a.entries();\n    return (\n      b.every(function (v, k) {\n        var entry = entries.next().value;\n        return entry && is(entry[1], v) && (notAssociative || is(entry[0], k));\n      }) && entries.next().done\n    );\n  }\n\n  var flipped = false;\n\n  if (a.size === undefined) {\n    if (b.size === undefined) {\n      if (typeof a.cacheResult === 'function') {\n        a.cacheResult();\n      }\n    } else {\n      flipped = true;\n      var _ = a;\n      a = b;\n      b = _;\n    }\n  }\n\n  var allEqual = true;\n  var bSize = b.__iterate(function (v, k) {\n    if (\n      notAssociative\n        ? !a.has(v)\n        : flipped\n        ? !is(v, a.get(k, NOT_SET))\n        : !is(a.get(k, NOT_SET), v)\n    ) {\n      allEqual = false;\n      return false;\n    }\n  });\n\n  return allEqual && a.size === bSize;\n}\n\nfunction mixin(ctor, methods) {\n  var keyCopier = function (key) {\n    ctor.prototype[key] = methods[key];\n  };\n  Object.keys(methods).forEach(keyCopier);\n  Object.getOwnPropertySymbols &&\n    Object.getOwnPropertySymbols(methods).forEach(keyCopier);\n  return ctor;\n}\n\nfunction toJS(value) {\n  if (!value || typeof value !== 'object') {\n    return value;\n  }\n  if (!isCollection(value)) {\n    if (!isDataStructure(value)) {\n      return value;\n    }\n    value = Seq(value);\n  }\n  if (isKeyed(value)) {\n    var result$1 = {};\n    value.__iterate(function (v, k) {\n      result$1[k] = toJS(v);\n    });\n    return result$1;\n  }\n  var result = [];\n  value.__iterate(function (v) {\n    result.push(toJS(v));\n  });\n  return result;\n}\n\nvar Set = /*@__PURE__*/(function (SetCollection) {\n  function Set(value) {\n    return value === undefined || value === null\n      ? emptySet()\n      : isSet(value) && !isOrdered(value)\n      ? value\n      : emptySet().withMutations(function (set) {\n          var iter = SetCollection(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function (v) { return set.add(v); });\n        });\n  }\n\n  if ( SetCollection ) Set.__proto__ = SetCollection;\n  Set.prototype = Object.create( SetCollection && SetCollection.prototype );\n  Set.prototype.constructor = Set;\n\n  Set.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  Set.fromKeys = function fromKeys (value) {\n    return this(KeyedCollection(value).keySeq());\n  };\n\n  Set.intersect = function intersect (sets) {\n    sets = Collection(sets).toArray();\n    return sets.length\n      ? SetPrototype.intersect.apply(Set(sets.pop()), sets)\n      : emptySet();\n  };\n\n  Set.union = function union (sets) {\n    sets = Collection(sets).toArray();\n    return sets.length\n      ? SetPrototype.union.apply(Set(sets.pop()), sets)\n      : emptySet();\n  };\n\n  Set.prototype.toString = function toString () {\n    return this.__toString('Set {', '}');\n  };\n\n  // @pragma Access\n\n  Set.prototype.has = function has (value) {\n    return this._map.has(value);\n  };\n\n  // @pragma Modification\n\n  Set.prototype.add = function add (value) {\n    return updateSet(this, this._map.set(value, value));\n  };\n\n  Set.prototype.remove = function remove (value) {\n    return updateSet(this, this._map.remove(value));\n  };\n\n  Set.prototype.clear = function clear () {\n    return updateSet(this, this._map.clear());\n  };\n\n  // @pragma Composition\n\n  Set.prototype.map = function map (mapper, context) {\n    var this$1$1 = this;\n\n    // keep track if the set is altered by the map function\n    var didChanges = false;\n\n    var newMap = updateSet(\n      this,\n      this._map.mapEntries(function (ref) {\n        var v = ref[1];\n\n        var mapped = mapper.call(context, v, v, this$1$1);\n\n        if (mapped !== v) {\n          didChanges = true;\n        }\n\n        return [mapped, mapped];\n      }, context)\n    );\n\n    return didChanges ? newMap : this;\n  };\n\n  Set.prototype.union = function union () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    iters = iters.filter(function (x) { return x.size !== 0; });\n    if (iters.length === 0) {\n      return this;\n    }\n    if (this.size === 0 && !this.__ownerID && iters.length === 1) {\n      return this.constructor(iters[0]);\n    }\n    return this.withMutations(function (set) {\n      for (var ii = 0; ii < iters.length; ii++) {\n        if (typeof iters[ii] === 'string') {\n          set.add(iters[ii]);\n        } else {\n          SetCollection(iters[ii]).forEach(function (value) { return set.add(value); });\n        }\n      }\n    });\n  };\n\n  Set.prototype.intersect = function intersect () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    if (iters.length === 0) {\n      return this;\n    }\n    iters = iters.map(function (iter) { return SetCollection(iter); });\n    var toRemove = [];\n    this.forEach(function (value) {\n      if (!iters.every(function (iter) { return iter.includes(value); })) {\n        toRemove.push(value);\n      }\n    });\n    return this.withMutations(function (set) {\n      toRemove.forEach(function (value) {\n        set.remove(value);\n      });\n    });\n  };\n\n  Set.prototype.subtract = function subtract () {\n    var iters = [], len = arguments.length;\n    while ( len-- ) iters[ len ] = arguments[ len ];\n\n    if (iters.length === 0) {\n      return this;\n    }\n    iters = iters.map(function (iter) { return SetCollection(iter); });\n    var toRemove = [];\n    this.forEach(function (value) {\n      if (iters.some(function (iter) { return iter.includes(value); })) {\n        toRemove.push(value);\n      }\n    });\n    return this.withMutations(function (set) {\n      toRemove.forEach(function (value) {\n        set.remove(value);\n      });\n    });\n  };\n\n  Set.prototype.sort = function sort (comparator) {\n    // Late binding\n    return OrderedSet(sortFactory(this, comparator));\n  };\n\n  Set.prototype.sortBy = function sortBy (mapper, comparator) {\n    // Late binding\n    return OrderedSet(sortFactory(this, comparator, mapper));\n  };\n\n  Set.prototype.wasAltered = function wasAltered () {\n    return this._map.wasAltered();\n  };\n\n  Set.prototype.__iterate = function __iterate (fn, reverse) {\n    var this$1$1 = this;\n\n    return this._map.__iterate(function (k) { return fn(k, k, this$1$1); }, reverse);\n  };\n\n  Set.prototype.__iterator = function __iterator (type, reverse) {\n    return this._map.__iterator(type, reverse);\n  };\n\n  Set.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n    if (ownerID === this.__ownerID) {\n      return this;\n    }\n    var newMap = this._map.__ensureOwner(ownerID);\n    if (!ownerID) {\n      if (this.size === 0) {\n        return this.__empty();\n      }\n      this.__ownerID = ownerID;\n      this._map = newMap;\n      return this;\n    }\n    return this.__make(newMap, ownerID);\n  };\n\n  return Set;\n}(SetCollection));\n\nSet.isSet = isSet;\n\nvar SetPrototype = Set.prototype;\nSetPrototype[IS_SET_SYMBOL] = true;\nSetPrototype[DELETE] = SetPrototype.remove;\nSetPrototype.merge = SetPrototype.concat = SetPrototype.union;\nSetPrototype.withMutations = withMutations;\nSetPrototype.asImmutable = asImmutable;\nSetPrototype['@@transducer/init'] = SetPrototype.asMutable = asMutable;\nSetPrototype['@@transducer/step'] = function (result, arr) {\n  return result.add(arr);\n};\nSetPrototype['@@transducer/result'] = function (obj) {\n  return obj.asImmutable();\n};\n\nSetPrototype.__empty = emptySet;\nSetPrototype.__make = makeSet;\n\nfunction updateSet(set, newMap) {\n  if (set.__ownerID) {\n    set.size = newMap.size;\n    set._map = newMap;\n    return set;\n  }\n  return newMap === set._map\n    ? set\n    : newMap.size === 0\n    ? set.__empty()\n    : set.__make(newMap);\n}\n\nfunction makeSet(map, ownerID) {\n  var set = Object.create(SetPrototype);\n  set.size = map ? map.size : 0;\n  set._map = map;\n  set.__ownerID = ownerID;\n  return set;\n}\n\nvar EMPTY_SET;\nfunction emptySet() {\n  return EMPTY_SET || (EMPTY_SET = makeSet(emptyMap()));\n}\n\n/**\n * Returns a lazy seq of nums from start (inclusive) to end\n * (exclusive), by step, where start defaults to 0, step to 1, and end to\n * infinity. When start is equal to end, returns empty list.\n */\nvar Range = /*@__PURE__*/(function (IndexedSeq) {\n  function Range(start, end, step) {\n    if (!(this instanceof Range)) {\n      return new Range(start, end, step);\n    }\n    invariant(step !== 0, 'Cannot step a Range by 0');\n    start = start || 0;\n    if (end === undefined) {\n      end = Infinity;\n    }\n    step = step === undefined ? 1 : Math.abs(step);\n    if (end < start) {\n      step = -step;\n    }\n    this._start = start;\n    this._end = end;\n    this._step = step;\n    this.size = Math.max(0, Math.ceil((end - start) / step - 1) + 1);\n    if (this.size === 0) {\n      if (EMPTY_RANGE) {\n        return EMPTY_RANGE;\n      }\n      EMPTY_RANGE = this;\n    }\n  }\n\n  if ( IndexedSeq ) Range.__proto__ = IndexedSeq;\n  Range.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  Range.prototype.constructor = Range;\n\n  Range.prototype.toString = function toString () {\n    if (this.size === 0) {\n      return 'Range []';\n    }\n    return (\n      'Range [ ' +\n      this._start +\n      '...' +\n      this._end +\n      (this._step !== 1 ? ' by ' + this._step : '') +\n      ' ]'\n    );\n  };\n\n  Range.prototype.get = function get (index, notSetValue) {\n    return this.has(index)\n      ? this._start + wrapIndex(this, index) * this._step\n      : notSetValue;\n  };\n\n  Range.prototype.includes = function includes (searchValue) {\n    var possibleIndex = (searchValue - this._start) / this._step;\n    return (\n      possibleIndex >= 0 &&\n      possibleIndex < this.size &&\n      possibleIndex === Math.floor(possibleIndex)\n    );\n  };\n\n  Range.prototype.slice = function slice (begin, end) {\n    if (wholeSlice(begin, end, this.size)) {\n      return this;\n    }\n    begin = resolveBegin(begin, this.size);\n    end = resolveEnd(end, this.size);\n    if (end <= begin) {\n      return new Range(0, 0);\n    }\n    return new Range(\n      this.get(begin, this._end),\n      this.get(end, this._end),\n      this._step\n    );\n  };\n\n  Range.prototype.indexOf = function indexOf (searchValue) {\n    var offsetValue = searchValue - this._start;\n    if (offsetValue % this._step === 0) {\n      var index = offsetValue / this._step;\n      if (index >= 0 && index < this.size) {\n        return index;\n      }\n    }\n    return -1;\n  };\n\n  Range.prototype.lastIndexOf = function lastIndexOf (searchValue) {\n    return this.indexOf(searchValue);\n  };\n\n  Range.prototype.__iterate = function __iterate (fn, reverse) {\n    var size = this.size;\n    var step = this._step;\n    var value = reverse ? this._start + (size - 1) * step : this._start;\n    var i = 0;\n    while (i !== size) {\n      if (fn(value, reverse ? size - ++i : i++, this) === false) {\n        break;\n      }\n      value += reverse ? -step : step;\n    }\n    return i;\n  };\n\n  Range.prototype.__iterator = function __iterator (type, reverse) {\n    var size = this.size;\n    var step = this._step;\n    var value = reverse ? this._start + (size - 1) * step : this._start;\n    var i = 0;\n    return new Iterator(function () {\n      if (i === size) {\n        return iteratorDone();\n      }\n      var v = value;\n      value += reverse ? -step : step;\n      return iteratorValue(type, reverse ? size - ++i : i++, v);\n    });\n  };\n\n  Range.prototype.equals = function equals (other) {\n    return other instanceof Range\n      ? this._start === other._start &&\n          this._end === other._end &&\n          this._step === other._step\n      : deepEqual(this, other);\n  };\n\n  return Range;\n}(IndexedSeq));\n\nvar EMPTY_RANGE;\n\nfunction getIn$1(collection, searchKeyPath, notSetValue) {\n  var keyPath = coerceKeyPath(searchKeyPath);\n  var i = 0;\n  while (i !== keyPath.length) {\n    collection = get(collection, keyPath[i++], NOT_SET);\n    if (collection === NOT_SET) {\n      return notSetValue;\n    }\n  }\n  return collection;\n}\n\nfunction getIn(searchKeyPath, notSetValue) {\n  return getIn$1(this, searchKeyPath, notSetValue);\n}\n\nfunction hasIn$1(collection, keyPath) {\n  return getIn$1(collection, keyPath, NOT_SET) !== NOT_SET;\n}\n\nfunction hasIn(searchKeyPath) {\n  return hasIn$1(this, searchKeyPath);\n}\n\nfunction toObject() {\n  assertNotInfinite(this.size);\n  var object = {};\n  this.__iterate(function (v, k) {\n    object[k] = v;\n  });\n  return object;\n}\n\n// Note: all of these methods are deprecated.\nCollection.isIterable = isCollection;\nCollection.isKeyed = isKeyed;\nCollection.isIndexed = isIndexed;\nCollection.isAssociative = isAssociative;\nCollection.isOrdered = isOrdered;\n\nCollection.Iterator = Iterator;\n\nmixin(Collection, {\n  // ### Conversion to other types\n\n  toArray: function toArray() {\n    assertNotInfinite(this.size);\n    var array = new Array(this.size || 0);\n    var useTuples = isKeyed(this);\n    var i = 0;\n    this.__iterate(function (v, k) {\n      // Keyed collections produce an array of tuples.\n      array[i++] = useTuples ? [k, v] : v;\n    });\n    return array;\n  },\n\n  toIndexedSeq: function toIndexedSeq() {\n    return new ToIndexedSequence(this);\n  },\n\n  toJS: function toJS$1() {\n    return toJS(this);\n  },\n\n  toKeyedSeq: function toKeyedSeq() {\n    return new ToKeyedSequence(this, true);\n  },\n\n  toMap: function toMap() {\n    // Use Late Binding here to solve the circular dependency.\n    return Map(this.toKeyedSeq());\n  },\n\n  toObject: toObject,\n\n  toOrderedMap: function toOrderedMap() {\n    // Use Late Binding here to solve the circular dependency.\n    return OrderedMap(this.toKeyedSeq());\n  },\n\n  toOrderedSet: function toOrderedSet() {\n    // Use Late Binding here to solve the circular dependency.\n    return OrderedSet(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toSet: function toSet() {\n    // Use Late Binding here to solve the circular dependency.\n    return Set(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toSetSeq: function toSetSeq() {\n    return new ToSetSequence(this);\n  },\n\n  toSeq: function toSeq() {\n    return isIndexed(this)\n      ? this.toIndexedSeq()\n      : isKeyed(this)\n      ? this.toKeyedSeq()\n      : this.toSetSeq();\n  },\n\n  toStack: function toStack() {\n    // Use Late Binding here to solve the circular dependency.\n    return Stack(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  toList: function toList() {\n    // Use Late Binding here to solve the circular dependency.\n    return List(isKeyed(this) ? this.valueSeq() : this);\n  },\n\n  // ### Common JavaScript methods and properties\n\n  toString: function toString() {\n    return '[Collection]';\n  },\n\n  __toString: function __toString(head, tail) {\n    if (this.size === 0) {\n      return head + tail;\n    }\n    return (\n      head +\n      ' ' +\n      this.toSeq().map(this.__toStringMapper).join(', ') +\n      ' ' +\n      tail\n    );\n  },\n\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  concat: function concat() {\n    var values = [], len = arguments.length;\n    while ( len-- ) values[ len ] = arguments[ len ];\n\n    return reify(this, concatFactory(this, values));\n  },\n\n  includes: function includes(searchValue) {\n    return this.some(function (value) { return is(value, searchValue); });\n  },\n\n  entries: function entries() {\n    return this.__iterator(ITERATE_ENTRIES);\n  },\n\n  every: function every(predicate, context) {\n    assertNotInfinite(this.size);\n    var returnValue = true;\n    this.__iterate(function (v, k, c) {\n      if (!predicate.call(context, v, k, c)) {\n        returnValue = false;\n        return false;\n      }\n    });\n    return returnValue;\n  },\n\n  filter: function filter(predicate, context) {\n    return reify(this, filterFactory(this, predicate, context, true));\n  },\n\n  partition: function partition(predicate, context) {\n    return partitionFactory(this, predicate, context);\n  },\n\n  find: function find(predicate, context, notSetValue) {\n    var entry = this.findEntry(predicate, context);\n    return entry ? entry[1] : notSetValue;\n  },\n\n  forEach: function forEach(sideEffect, context) {\n    assertNotInfinite(this.size);\n    return this.__iterate(context ? sideEffect.bind(context) : sideEffect);\n  },\n\n  join: function join(separator) {\n    assertNotInfinite(this.size);\n    separator = separator !== undefined ? '' + separator : ',';\n    var joined = '';\n    var isFirst = true;\n    this.__iterate(function (v) {\n      isFirst ? (isFirst = false) : (joined += separator);\n      joined += v !== null && v !== undefined ? v.toString() : '';\n    });\n    return joined;\n  },\n\n  keys: function keys() {\n    return this.__iterator(ITERATE_KEYS);\n  },\n\n  map: function map(mapper, context) {\n    return reify(this, mapFactory(this, mapper, context));\n  },\n\n  reduce: function reduce$1(reducer, initialReduction, context) {\n    return reduce(\n      this,\n      reducer,\n      initialReduction,\n      context,\n      arguments.length < 2,\n      false\n    );\n  },\n\n  reduceRight: function reduceRight(reducer, initialReduction, context) {\n    return reduce(\n      this,\n      reducer,\n      initialReduction,\n      context,\n      arguments.length < 2,\n      true\n    );\n  },\n\n  reverse: function reverse() {\n    return reify(this, reverseFactory(this, true));\n  },\n\n  slice: function slice(begin, end) {\n    return reify(this, sliceFactory(this, begin, end, true));\n  },\n\n  some: function some(predicate, context) {\n    assertNotInfinite(this.size);\n    var returnValue = false;\n    this.__iterate(function (v, k, c) {\n      if (predicate.call(context, v, k, c)) {\n        returnValue = true;\n        return false;\n      }\n    });\n    return returnValue;\n  },\n\n  sort: function sort(comparator) {\n    return reify(this, sortFactory(this, comparator));\n  },\n\n  values: function values() {\n    return this.__iterator(ITERATE_VALUES);\n  },\n\n  // ### More sequential methods\n\n  butLast: function butLast() {\n    return this.slice(0, -1);\n  },\n\n  isEmpty: function isEmpty() {\n    return this.size !== undefined ? this.size === 0 : !this.some(function () { return true; });\n  },\n\n  count: function count(predicate, context) {\n    return ensureSize(\n      predicate ? this.toSeq().filter(predicate, context) : this\n    );\n  },\n\n  countBy: function countBy(grouper, context) {\n    return countByFactory(this, grouper, context);\n  },\n\n  equals: function equals(other) {\n    return deepEqual(this, other);\n  },\n\n  entrySeq: function entrySeq() {\n    var collection = this;\n    if (collection._cache) {\n      // We cache as an entries array, so we can just return the cache!\n      return new ArraySeq(collection._cache);\n    }\n    var entriesSequence = collection.toSeq().map(entryMapper).toIndexedSeq();\n    entriesSequence.fromEntrySeq = function () { return collection.toSeq(); };\n    return entriesSequence;\n  },\n\n  filterNot: function filterNot(predicate, context) {\n    return this.filter(not(predicate), context);\n  },\n\n  findEntry: function findEntry(predicate, context, notSetValue) {\n    var found = notSetValue;\n    this.__iterate(function (v, k, c) {\n      if (predicate.call(context, v, k, c)) {\n        found = [k, v];\n        return false;\n      }\n    });\n    return found;\n  },\n\n  findKey: function findKey(predicate, context) {\n    var entry = this.findEntry(predicate, context);\n    return entry && entry[0];\n  },\n\n  findLast: function findLast(predicate, context, notSetValue) {\n    return this.toKeyedSeq().reverse().find(predicate, context, notSetValue);\n  },\n\n  findLastEntry: function findLastEntry(predicate, context, notSetValue) {\n    return this.toKeyedSeq()\n      .reverse()\n      .findEntry(predicate, context, notSetValue);\n  },\n\n  findLastKey: function findLastKey(predicate, context) {\n    return this.toKeyedSeq().reverse().findKey(predicate, context);\n  },\n\n  first: function first(notSetValue) {\n    return this.find(returnTrue, null, notSetValue);\n  },\n\n  flatMap: function flatMap(mapper, context) {\n    return reify(this, flatMapFactory(this, mapper, context));\n  },\n\n  flatten: function flatten(depth) {\n    return reify(this, flattenFactory(this, depth, true));\n  },\n\n  fromEntrySeq: function fromEntrySeq() {\n    return new FromEntriesSequence(this);\n  },\n\n  get: function get(searchKey, notSetValue) {\n    return this.find(function (_, key) { return is(key, searchKey); }, undefined, notSetValue);\n  },\n\n  getIn: getIn,\n\n  groupBy: function groupBy(grouper, context) {\n    return groupByFactory(this, grouper, context);\n  },\n\n  has: function has(searchKey) {\n    return this.get(searchKey, NOT_SET) !== NOT_SET;\n  },\n\n  hasIn: hasIn,\n\n  isSubset: function isSubset(iter) {\n    iter = typeof iter.includes === 'function' ? iter : Collection(iter);\n    return this.every(function (value) { return iter.includes(value); });\n  },\n\n  isSuperset: function isSuperset(iter) {\n    iter = typeof iter.isSubset === 'function' ? iter : Collection(iter);\n    return iter.isSubset(this);\n  },\n\n  keyOf: function keyOf(searchValue) {\n    return this.findKey(function (value) { return is(value, searchValue); });\n  },\n\n  keySeq: function keySeq() {\n    return this.toSeq().map(keyMapper).toIndexedSeq();\n  },\n\n  last: function last(notSetValue) {\n    return this.toSeq().reverse().first(notSetValue);\n  },\n\n  lastKeyOf: function lastKeyOf(searchValue) {\n    return this.toKeyedSeq().reverse().keyOf(searchValue);\n  },\n\n  max: function max(comparator) {\n    return maxFactory(this, comparator);\n  },\n\n  maxBy: function maxBy(mapper, comparator) {\n    return maxFactory(this, comparator, mapper);\n  },\n\n  min: function min(comparator) {\n    return maxFactory(\n      this,\n      comparator ? neg(comparator) : defaultNegComparator\n    );\n  },\n\n  minBy: function minBy(mapper, comparator) {\n    return maxFactory(\n      this,\n      comparator ? neg(comparator) : defaultNegComparator,\n      mapper\n    );\n  },\n\n  rest: function rest() {\n    return this.slice(1);\n  },\n\n  skip: function skip(amount) {\n    return amount === 0 ? this : this.slice(Math.max(0, amount));\n  },\n\n  skipLast: function skipLast(amount) {\n    return amount === 0 ? this : this.slice(0, -Math.max(0, amount));\n  },\n\n  skipWhile: function skipWhile(predicate, context) {\n    return reify(this, skipWhileFactory(this, predicate, context, true));\n  },\n\n  skipUntil: function skipUntil(predicate, context) {\n    return this.skipWhile(not(predicate), context);\n  },\n\n  sortBy: function sortBy(mapper, comparator) {\n    return reify(this, sortFactory(this, comparator, mapper));\n  },\n\n  take: function take(amount) {\n    return this.slice(0, Math.max(0, amount));\n  },\n\n  takeLast: function takeLast(amount) {\n    return this.slice(-Math.max(0, amount));\n  },\n\n  takeWhile: function takeWhile(predicate, context) {\n    return reify(this, takeWhileFactory(this, predicate, context));\n  },\n\n  takeUntil: function takeUntil(predicate, context) {\n    return this.takeWhile(not(predicate), context);\n  },\n\n  update: function update(fn) {\n    return fn(this);\n  },\n\n  valueSeq: function valueSeq() {\n    return this.toIndexedSeq();\n  },\n\n  // ### Hashable Object\n\n  hashCode: function hashCode() {\n    return this.__hash || (this.__hash = hashCollection(this));\n  },\n\n  // ### Internal\n\n  // abstract __iterate(fn, reverse)\n\n  // abstract __iterator(type, reverse)\n});\n\nvar CollectionPrototype = Collection.prototype;\nCollectionPrototype[IS_COLLECTION_SYMBOL] = true;\nCollectionPrototype[ITERATOR_SYMBOL] = CollectionPrototype.values;\nCollectionPrototype.toJSON = CollectionPrototype.toArray;\nCollectionPrototype.__toStringMapper = quoteString;\nCollectionPrototype.inspect = CollectionPrototype.toSource = function () {\n  return this.toString();\n};\nCollectionPrototype.chain = CollectionPrototype.flatMap;\nCollectionPrototype.contains = CollectionPrototype.includes;\n\nmixin(KeyedCollection, {\n  // ### More sequential methods\n\n  flip: function flip() {\n    return reify(this, flipFactory(this));\n  },\n\n  mapEntries: function mapEntries(mapper, context) {\n    var this$1$1 = this;\n\n    var iterations = 0;\n    return reify(\n      this,\n      this.toSeq()\n        .map(function (v, k) { return mapper.call(context, [k, v], iterations++, this$1$1); })\n        .fromEntrySeq()\n    );\n  },\n\n  mapKeys: function mapKeys(mapper, context) {\n    var this$1$1 = this;\n\n    return reify(\n      this,\n      this.toSeq()\n        .flip()\n        .map(function (k, v) { return mapper.call(context, k, v, this$1$1); })\n        .flip()\n    );\n  },\n});\n\nvar KeyedCollectionPrototype = KeyedCollection.prototype;\nKeyedCollectionPrototype[IS_KEYED_SYMBOL] = true;\nKeyedCollectionPrototype[ITERATOR_SYMBOL] = CollectionPrototype.entries;\nKeyedCollectionPrototype.toJSON = toObject;\nKeyedCollectionPrototype.__toStringMapper = function (v, k) { return quoteString(k) + ': ' + quoteString(v); };\n\nmixin(IndexedCollection, {\n  // ### Conversion to other types\n\n  toKeyedSeq: function toKeyedSeq() {\n    return new ToKeyedSequence(this, false);\n  },\n\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  filter: function filter(predicate, context) {\n    return reify(this, filterFactory(this, predicate, context, false));\n  },\n\n  findIndex: function findIndex(predicate, context) {\n    var entry = this.findEntry(predicate, context);\n    return entry ? entry[0] : -1;\n  },\n\n  indexOf: function indexOf(searchValue) {\n    var key = this.keyOf(searchValue);\n    return key === undefined ? -1 : key;\n  },\n\n  lastIndexOf: function lastIndexOf(searchValue) {\n    var key = this.lastKeyOf(searchValue);\n    return key === undefined ? -1 : key;\n  },\n\n  reverse: function reverse() {\n    return reify(this, reverseFactory(this, false));\n  },\n\n  slice: function slice(begin, end) {\n    return reify(this, sliceFactory(this, begin, end, false));\n  },\n\n  splice: function splice(index, removeNum /*, ...values*/) {\n    var numArgs = arguments.length;\n    removeNum = Math.max(removeNum || 0, 0);\n    if (numArgs === 0 || (numArgs === 2 && !removeNum)) {\n      return this;\n    }\n    // If index is negative, it should resolve relative to the size of the\n    // collection. However size may be expensive to compute if not cached, so\n    // only call count() if the number is in fact negative.\n    index = resolveBegin(index, index < 0 ? this.count() : this.size);\n    var spliced = this.slice(0, index);\n    return reify(\n      this,\n      numArgs === 1\n        ? spliced\n        : spliced.concat(arrCopy(arguments, 2), this.slice(index + removeNum))\n    );\n  },\n\n  // ### More collection methods\n\n  findLastIndex: function findLastIndex(predicate, context) {\n    var entry = this.findLastEntry(predicate, context);\n    return entry ? entry[0] : -1;\n  },\n\n  first: function first(notSetValue) {\n    return this.get(0, notSetValue);\n  },\n\n  flatten: function flatten(depth) {\n    return reify(this, flattenFactory(this, depth, false));\n  },\n\n  get: function get(index, notSetValue) {\n    index = wrapIndex(this, index);\n    return index < 0 ||\n      this.size === Infinity ||\n      (this.size !== undefined && index > this.size)\n      ? notSetValue\n      : this.find(function (_, key) { return key === index; }, undefined, notSetValue);\n  },\n\n  has: function has(index) {\n    index = wrapIndex(this, index);\n    return (\n      index >= 0 &&\n      (this.size !== undefined\n        ? this.size === Infinity || index < this.size\n        : this.indexOf(index) !== -1)\n    );\n  },\n\n  interpose: function interpose(separator) {\n    return reify(this, interposeFactory(this, separator));\n  },\n\n  interleave: function interleave(/*...collections*/) {\n    var collections = [this].concat(arrCopy(arguments));\n    var zipped = zipWithFactory(this.toSeq(), IndexedSeq.of, collections);\n    var interleaved = zipped.flatten(true);\n    if (zipped.size) {\n      interleaved.size = zipped.size * collections.length;\n    }\n    return reify(this, interleaved);\n  },\n\n  keySeq: function keySeq() {\n    return Range(0, this.size);\n  },\n\n  last: function last(notSetValue) {\n    return this.get(-1, notSetValue);\n  },\n\n  skipWhile: function skipWhile(predicate, context) {\n    return reify(this, skipWhileFactory(this, predicate, context, false));\n  },\n\n  zip: function zip(/*, ...collections */) {\n    var collections = [this].concat(arrCopy(arguments));\n    return reify(this, zipWithFactory(this, defaultZipper, collections));\n  },\n\n  zipAll: function zipAll(/*, ...collections */) {\n    var collections = [this].concat(arrCopy(arguments));\n    return reify(this, zipWithFactory(this, defaultZipper, collections, true));\n  },\n\n  zipWith: function zipWith(zipper /*, ...collections */) {\n    var collections = arrCopy(arguments);\n    collections[0] = this;\n    return reify(this, zipWithFactory(this, zipper, collections));\n  },\n});\n\nvar IndexedCollectionPrototype = IndexedCollection.prototype;\nIndexedCollectionPrototype[IS_INDEXED_SYMBOL] = true;\nIndexedCollectionPrototype[IS_ORDERED_SYMBOL] = true;\n\nmixin(SetCollection, {\n  // ### ES6 Collection methods (ES6 Array and Map)\n\n  get: function get(value, notSetValue) {\n    return this.has(value) ? value : notSetValue;\n  },\n\n  includes: function includes(value) {\n    return this.has(value);\n  },\n\n  // ### More sequential methods\n\n  keySeq: function keySeq() {\n    return this.valueSeq();\n  },\n});\n\nvar SetCollectionPrototype = SetCollection.prototype;\nSetCollectionPrototype.has = CollectionPrototype.includes;\nSetCollectionPrototype.contains = SetCollectionPrototype.includes;\nSetCollectionPrototype.keys = SetCollectionPrototype.values;\n\n// Mixin subclasses\n\nmixin(KeyedSeq, KeyedCollectionPrototype);\nmixin(IndexedSeq, IndexedCollectionPrototype);\nmixin(SetSeq, SetCollectionPrototype);\n\n// #pragma Helper functions\n\nfunction reduce(collection, reducer, reduction, context, useFirst, reverse) {\n  assertNotInfinite(collection.size);\n  collection.__iterate(function (v, k, c) {\n    if (useFirst) {\n      useFirst = false;\n      reduction = v;\n    } else {\n      reduction = reducer.call(context, reduction, v, k, c);\n    }\n  }, reverse);\n  return reduction;\n}\n\nfunction keyMapper(v, k) {\n  return k;\n}\n\nfunction entryMapper(v, k) {\n  return [k, v];\n}\n\nfunction not(predicate) {\n  return function () {\n    return !predicate.apply(this, arguments);\n  };\n}\n\nfunction neg(predicate) {\n  return function () {\n    return -predicate.apply(this, arguments);\n  };\n}\n\nfunction defaultZipper() {\n  return arrCopy(arguments);\n}\n\nfunction defaultNegComparator(a, b) {\n  return a < b ? 1 : a > b ? -1 : 0;\n}\n\nfunction hashCollection(collection) {\n  if (collection.size === Infinity) {\n    return 0;\n  }\n  var ordered = isOrdered(collection);\n  var keyed = isKeyed(collection);\n  var h = ordered ? 1 : 0;\n  var size = collection.__iterate(\n    keyed\n      ? ordered\n        ? function (v, k) {\n            h = (31 * h + hashMerge(hash(v), hash(k))) | 0;\n          }\n        : function (v, k) {\n            h = (h + hashMerge(hash(v), hash(k))) | 0;\n          }\n      : ordered\n      ? function (v) {\n          h = (31 * h + hash(v)) | 0;\n        }\n      : function (v) {\n          h = (h + hash(v)) | 0;\n        }\n  );\n  return murmurHashOfSize(size, h);\n}\n\nfunction murmurHashOfSize(size, h) {\n  h = imul(h, 0xcc9e2d51);\n  h = imul((h << 15) | (h >>> -15), 0x1b873593);\n  h = imul((h << 13) | (h >>> -13), 5);\n  h = ((h + 0xe6546b64) | 0) ^ size;\n  h = imul(h ^ (h >>> 16), 0x85ebca6b);\n  h = imul(h ^ (h >>> 13), 0xc2b2ae35);\n  h = smi(h ^ (h >>> 16));\n  return h;\n}\n\nfunction hashMerge(a, b) {\n  return (a ^ (b + 0x9e3779b9 + (a << 6) + (a >> 2))) | 0; // int\n}\n\nvar OrderedSet = /*@__PURE__*/(function (Set) {\n  function OrderedSet(value) {\n    return value === undefined || value === null\n      ? emptyOrderedSet()\n      : isOrderedSet(value)\n      ? value\n      : emptyOrderedSet().withMutations(function (set) {\n          var iter = SetCollection(value);\n          assertNotInfinite(iter.size);\n          iter.forEach(function (v) { return set.add(v); });\n        });\n  }\n\n  if ( Set ) OrderedSet.__proto__ = Set;\n  OrderedSet.prototype = Object.create( Set && Set.prototype );\n  OrderedSet.prototype.constructor = OrderedSet;\n\n  OrderedSet.of = function of (/*...values*/) {\n    return this(arguments);\n  };\n\n  OrderedSet.fromKeys = function fromKeys (value) {\n    return this(KeyedCollection(value).keySeq());\n  };\n\n  OrderedSet.prototype.toString = function toString () {\n    return this.__toString('OrderedSet {', '}');\n  };\n\n  return OrderedSet;\n}(Set));\n\nOrderedSet.isOrderedSet = isOrderedSet;\n\nvar OrderedSetPrototype = OrderedSet.prototype;\nOrderedSetPrototype[IS_ORDERED_SYMBOL] = true;\nOrderedSetPrototype.zip = IndexedCollectionPrototype.zip;\nOrderedSetPrototype.zipWith = IndexedCollectionPrototype.zipWith;\nOrderedSetPrototype.zipAll = IndexedCollectionPrototype.zipAll;\n\nOrderedSetPrototype.__empty = emptyOrderedSet;\nOrderedSetPrototype.__make = makeOrderedSet;\n\nfunction makeOrderedSet(map, ownerID) {\n  var set = Object.create(OrderedSetPrototype);\n  set.size = map ? map.size : 0;\n  set._map = map;\n  set.__ownerID = ownerID;\n  return set;\n}\n\nvar EMPTY_ORDERED_SET;\nfunction emptyOrderedSet() {\n  return (\n    EMPTY_ORDERED_SET || (EMPTY_ORDERED_SET = makeOrderedSet(emptyOrderedMap()))\n  );\n}\n\nvar PairSorting = {\n  LeftThenRight: -1,\n  RightThenLeft: +1,\n};\n\nfunction throwOnInvalidDefaultValues(defaultValues) {\n  if (isRecord(defaultValues)) {\n    throw new Error(\n      'Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.'\n    );\n  }\n\n  if (isImmutable(defaultValues)) {\n    throw new Error(\n      'Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.'\n    );\n  }\n\n  if (defaultValues === null || typeof defaultValues !== 'object') {\n    throw new Error(\n      'Can not call `Record` with a non-object as default values. Use a plain javascript object instead.'\n    );\n  }\n}\n\nvar Record = function Record(defaultValues, name) {\n  var hasInitialized;\n\n  throwOnInvalidDefaultValues(defaultValues);\n\n  var RecordType = function Record(values) {\n    var this$1$1 = this;\n\n    if (values instanceof RecordType) {\n      return values;\n    }\n    if (!(this instanceof RecordType)) {\n      return new RecordType(values);\n    }\n    if (!hasInitialized) {\n      hasInitialized = true;\n      var keys = Object.keys(defaultValues);\n      var indices = (RecordTypePrototype._indices = {});\n      // Deprecated: left to attempt not to break any external code which\n      // relies on a ._name property existing on record instances.\n      // Use Record.getDescriptiveName() instead\n      RecordTypePrototype._name = name;\n      RecordTypePrototype._keys = keys;\n      RecordTypePrototype._defaultValues = defaultValues;\n      for (var i = 0; i < keys.length; i++) {\n        var propName = keys[i];\n        indices[propName] = i;\n        if (RecordTypePrototype[propName]) {\n          /* eslint-disable no-console */\n          typeof console === 'object' &&\n            console.warn &&\n            console.warn(\n              'Cannot define ' +\n                recordName(this) +\n                ' with property \"' +\n                propName +\n                '\" since that property name is part of the Record API.'\n            );\n          /* eslint-enable no-console */\n        } else {\n          setProp(RecordTypePrototype, propName);\n        }\n      }\n    }\n    this.__ownerID = undefined;\n    this._values = List().withMutations(function (l) {\n      l.setSize(this$1$1._keys.length);\n      KeyedCollection(values).forEach(function (v, k) {\n        l.set(this$1$1._indices[k], v === this$1$1._defaultValues[k] ? undefined : v);\n      });\n    });\n    return this;\n  };\n\n  var RecordTypePrototype = (RecordType.prototype =\n    Object.create(RecordPrototype));\n  RecordTypePrototype.constructor = RecordType;\n\n  if (name) {\n    RecordType.displayName = name;\n  }\n\n  return RecordType;\n};\n\nRecord.prototype.toString = function toString () {\n  var str = recordName(this) + ' { ';\n  var keys = this._keys;\n  var k;\n  for (var i = 0, l = keys.length; i !== l; i++) {\n    k = keys[i];\n    str += (i ? ', ' : '') + k + ': ' + quoteString(this.get(k));\n  }\n  return str + ' }';\n};\n\nRecord.prototype.equals = function equals (other) {\n  return (\n    this === other ||\n    (isRecord(other) && recordSeq(this).equals(recordSeq(other)))\n  );\n};\n\nRecord.prototype.hashCode = function hashCode () {\n  return recordSeq(this).hashCode();\n};\n\n// @pragma Access\n\nRecord.prototype.has = function has (k) {\n  return this._indices.hasOwnProperty(k);\n};\n\nRecord.prototype.get = function get (k, notSetValue) {\n  if (!this.has(k)) {\n    return notSetValue;\n  }\n  var index = this._indices[k];\n  var value = this._values.get(index);\n  return value === undefined ? this._defaultValues[k] : value;\n};\n\n// @pragma Modification\n\nRecord.prototype.set = function set (k, v) {\n  if (this.has(k)) {\n    var newValues = this._values.set(\n      this._indices[k],\n      v === this._defaultValues[k] ? undefined : v\n    );\n    if (newValues !== this._values && !this.__ownerID) {\n      return makeRecord(this, newValues);\n    }\n  }\n  return this;\n};\n\nRecord.prototype.remove = function remove (k) {\n  return this.set(k);\n};\n\nRecord.prototype.clear = function clear () {\n  var newValues = this._values.clear().setSize(this._keys.length);\n\n  return this.__ownerID ? this : makeRecord(this, newValues);\n};\n\nRecord.prototype.wasAltered = function wasAltered () {\n  return this._values.wasAltered();\n};\n\nRecord.prototype.toSeq = function toSeq () {\n  return recordSeq(this);\n};\n\nRecord.prototype.toJS = function toJS$1 () {\n  return toJS(this);\n};\n\nRecord.prototype.entries = function entries () {\n  return this.__iterator(ITERATE_ENTRIES);\n};\n\nRecord.prototype.__iterator = function __iterator (type, reverse) {\n  return recordSeq(this).__iterator(type, reverse);\n};\n\nRecord.prototype.__iterate = function __iterate (fn, reverse) {\n  return recordSeq(this).__iterate(fn, reverse);\n};\n\nRecord.prototype.__ensureOwner = function __ensureOwner (ownerID) {\n  if (ownerID === this.__ownerID) {\n    return this;\n  }\n  var newValues = this._values.__ensureOwner(ownerID);\n  if (!ownerID) {\n    this.__ownerID = ownerID;\n    this._values = newValues;\n    return this;\n  }\n  return makeRecord(this, newValues, ownerID);\n};\n\nRecord.isRecord = isRecord;\nRecord.getDescriptiveName = recordName;\nvar RecordPrototype = Record.prototype;\nRecordPrototype[IS_RECORD_SYMBOL] = true;\nRecordPrototype[DELETE] = RecordPrototype.remove;\nRecordPrototype.deleteIn = RecordPrototype.removeIn = deleteIn;\nRecordPrototype.getIn = getIn;\nRecordPrototype.hasIn = CollectionPrototype.hasIn;\nRecordPrototype.merge = merge$1;\nRecordPrototype.mergeWith = mergeWith$1;\nRecordPrototype.mergeIn = mergeIn;\nRecordPrototype.mergeDeep = mergeDeep;\nRecordPrototype.mergeDeepWith = mergeDeepWith;\nRecordPrototype.mergeDeepIn = mergeDeepIn;\nRecordPrototype.setIn = setIn;\nRecordPrototype.update = update;\nRecordPrototype.updateIn = updateIn;\nRecordPrototype.withMutations = withMutations;\nRecordPrototype.asMutable = asMutable;\nRecordPrototype.asImmutable = asImmutable;\nRecordPrototype[ITERATOR_SYMBOL] = RecordPrototype.entries;\nRecordPrototype.toJSON = RecordPrototype.toObject =\n  CollectionPrototype.toObject;\nRecordPrototype.inspect = RecordPrototype.toSource = function () {\n  return this.toString();\n};\n\nfunction makeRecord(likeRecord, values, ownerID) {\n  var record = Object.create(Object.getPrototypeOf(likeRecord));\n  record._values = values;\n  record.__ownerID = ownerID;\n  return record;\n}\n\nfunction recordName(record) {\n  return record.constructor.displayName || record.constructor.name || 'Record';\n}\n\nfunction recordSeq(record) {\n  return keyedSeqFromValue(record._keys.map(function (k) { return [k, record.get(k)]; }));\n}\n\nfunction setProp(prototype, name) {\n  try {\n    Object.defineProperty(prototype, name, {\n      get: function () {\n        return this.get(name);\n      },\n      set: function (value) {\n        invariant(this.__ownerID, 'Cannot set on an immutable record.');\n        this.set(name, value);\n      },\n    });\n  } catch (error) {\n    // Object.defineProperty failed. Probably IE8.\n  }\n}\n\n/**\n * Returns a lazy Seq of `value` repeated `times` times. When `times` is\n * undefined, returns an infinite sequence of `value`.\n */\nvar Repeat = /*@__PURE__*/(function (IndexedSeq) {\n  function Repeat(value, times) {\n    if (!(this instanceof Repeat)) {\n      return new Repeat(value, times);\n    }\n    this._value = value;\n    this.size = times === undefined ? Infinity : Math.max(0, times);\n    if (this.size === 0) {\n      if (EMPTY_REPEAT) {\n        return EMPTY_REPEAT;\n      }\n      EMPTY_REPEAT = this;\n    }\n  }\n\n  if ( IndexedSeq ) Repeat.__proto__ = IndexedSeq;\n  Repeat.prototype = Object.create( IndexedSeq && IndexedSeq.prototype );\n  Repeat.prototype.constructor = Repeat;\n\n  Repeat.prototype.toString = function toString () {\n    if (this.size === 0) {\n      return 'Repeat []';\n    }\n    return 'Repeat [ ' + this._value + ' ' + this.size + ' times ]';\n  };\n\n  Repeat.prototype.get = function get (index, notSetValue) {\n    return this.has(index) ? this._value : notSetValue;\n  };\n\n  Repeat.prototype.includes = function includes (searchValue) {\n    return is(this._value, searchValue);\n  };\n\n  Repeat.prototype.slice = function slice (begin, end) {\n    var size = this.size;\n    return wholeSlice(begin, end, size)\n      ? this\n      : new Repeat(\n          this._value,\n          resolveEnd(end, size) - resolveBegin(begin, size)\n        );\n  };\n\n  Repeat.prototype.reverse = function reverse () {\n    return this;\n  };\n\n  Repeat.prototype.indexOf = function indexOf (searchValue) {\n    if (is(this._value, searchValue)) {\n      return 0;\n    }\n    return -1;\n  };\n\n  Repeat.prototype.lastIndexOf = function lastIndexOf (searchValue) {\n    if (is(this._value, searchValue)) {\n      return this.size;\n    }\n    return -1;\n  };\n\n  Repeat.prototype.__iterate = function __iterate (fn, reverse) {\n    var size = this.size;\n    var i = 0;\n    while (i !== size) {\n      if (fn(this._value, reverse ? size - ++i : i++, this) === false) {\n        break;\n      }\n    }\n    return i;\n  };\n\n  Repeat.prototype.__iterator = function __iterator (type, reverse) {\n    var this$1$1 = this;\n\n    var size = this.size;\n    var i = 0;\n    return new Iterator(function () { return i === size\n        ? iteratorDone()\n        : iteratorValue(type, reverse ? size - ++i : i++, this$1$1._value); }\n    );\n  };\n\n  Repeat.prototype.equals = function equals (other) {\n    return other instanceof Repeat\n      ? is(this._value, other._value)\n      : deepEqual(other);\n  };\n\n  return Repeat;\n}(IndexedSeq));\n\nvar EMPTY_REPEAT;\n\nfunction fromJS(value, converter) {\n  return fromJSWith(\n    [],\n    converter || defaultConverter,\n    value,\n    '',\n    converter && converter.length > 2 ? [] : undefined,\n    { '': value }\n  );\n}\n\nfunction fromJSWith(stack, converter, value, key, keyPath, parentValue) {\n  if (\n    typeof value !== 'string' &&\n    !isImmutable(value) &&\n    (isArrayLike(value) || hasIterator(value) || isPlainObject(value))\n  ) {\n    if (~stack.indexOf(value)) {\n      throw new TypeError('Cannot convert circular structure to Immutable');\n    }\n    stack.push(value);\n    keyPath && key !== '' && keyPath.push(key);\n    var converted = converter.call(\n      parentValue,\n      key,\n      Seq(value).map(function (v, k) { return fromJSWith(stack, converter, v, k, keyPath, value); }\n      ),\n      keyPath && keyPath.slice()\n    );\n    stack.pop();\n    keyPath && keyPath.pop();\n    return converted;\n  }\n  return value;\n}\n\nfunction defaultConverter(k, v) {\n  // Effectively the opposite of \"Collection.toSeq()\"\n  return isIndexed(v) ? v.toList() : isKeyed(v) ? v.toMap() : v.toSet();\n}\n\nvar version = \"4.3.5\";\n\nvar Immutable = {\n  version: version,\n\n  Collection: Collection,\n  // Note: Iterable is deprecated\n  Iterable: Collection,\n\n  Seq: Seq,\n  Map: Map,\n  OrderedMap: OrderedMap,\n  List: List,\n  Stack: Stack,\n  Set: Set,\n  OrderedSet: OrderedSet,\n  PairSorting: PairSorting,\n\n  Record: Record,\n  Range: Range,\n  Repeat: Repeat,\n\n  is: is,\n  fromJS: fromJS,\n  hash: hash,\n\n  isImmutable: isImmutable,\n  isCollection: isCollection,\n  isKeyed: isKeyed,\n  isIndexed: isIndexed,\n  isAssociative: isAssociative,\n  isOrdered: isOrdered,\n  isValueObject: isValueObject,\n  isPlainObject: isPlainObject,\n  isSeq: isSeq,\n  isList: isList,\n  isMap: isMap,\n  isOrderedMap: isOrderedMap,\n  isStack: isStack,\n  isSet: isSet,\n  isOrderedSet: isOrderedSet,\n  isRecord: isRecord,\n\n  get: get,\n  getIn: getIn$1,\n  has: has,\n  hasIn: hasIn$1,\n  merge: merge,\n  mergeDeep: mergeDeep$1,\n  mergeWith: mergeWith,\n  mergeDeepWith: mergeDeepWith$1,\n  remove: remove,\n  removeIn: removeIn,\n  set: set,\n  setIn: setIn$1,\n  update: update$1,\n  updateIn: updateIn$1,\n};\n\n// Note: Iterable is deprecated\nvar Iterable = Collection;\n\nexport default Immutable;\nexport { Collection, Iterable, List, Map, OrderedMap, OrderedSet, PairSorting, Range, Record, Repeat, Seq, Set, Stack, fromJS, get, getIn$1 as getIn, has, hasIn$1 as hasIn, hash, is, isAssociative, isCollection, isImmutable, isIndexed, isKeyed, isList, isMap, isOrdered, isOrderedMap, isOrderedSet, isPlainObject, isRecord, isSeq, isSet, isStack, isValueObject, merge, mergeDeep$1 as mergeDeep, mergeDeepWith$1 as mergeDeepWith, mergeWith, remove, removeIn, set, setIn$1 as setIn, update$1 as update, updateIn$1 as updateIn, version };\n","import merge from 'lodash/merge';\r\nimport { ClipboardCopy } from 'src/ClipboardCopy';\r\nimport { grey } from 'theme';\r\n\r\nimport Box, { BoxProps } from '@mui/material/Box';\r\nimport Stack, { StackProps } from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\ninterface Props {\r\n  className?: string;\r\n  clipboardValue?: string;\r\n  sx?: StackProps['sx'];\r\n  sxChildren?: BoxProps['sx'];\r\n  title?: string;\r\n}\r\n\r\nexport default function EditorWrapper({\r\n  children,\r\n  className,\r\n  clipboardValue,\r\n  sx,\r\n  sxChildren,\r\n  title\r\n}: React.PropsWithChildren<Props>) {\r\n  const theme = useTheme();\r\n\r\n  return (\r\n    <Stack\r\n      spacing={title ? 1.5 : 0}\r\n      sx={merge({ width: '100%', flex: 1, overflowY: 'auto' }, sx)}\r\n    >\r\n      <Typography fontSize=\"14px\" fontWeight={700} color={grey[400]}>\r\n        {title}\r\n      </Typography>\r\n      <Box\r\n        className={className}\r\n        sx={merge(\r\n          {\r\n            position: 'relative',\r\n            fontFamily: (theme) => theme.typography.fontFamily,\r\n            fontSize: '16px',\r\n            lineHeight: '24px',\r\n            padding: 3,\r\n            paddingRight: 4,\r\n            border: `1.5px solid ${theme.palette.divider}`,\r\n            borderRadius: '8px',\r\n            overflowY: 'auto',\r\n            flexGrow: 1,\r\n            caretColor: theme.palette.text.primary,\r\n            backgroundColor: theme.palette.background.paper,\r\n            '&:hover': {\r\n              borderColor: theme.palette.mode === 'light' ? grey[400] : 'white'\r\n            }\r\n          },\r\n          sxChildren\r\n        )}\r\n      >\r\n        {clipboardValue ? (\r\n          <Box\r\n            sx={{\r\n              position: 'absolute',\r\n              right: 0,\r\n              top: 0,\r\n              color: 'text.secondary'\r\n            }}\r\n          >\r\n            <ClipboardCopy value={clipboardValue} />\r\n          </Box>\r\n        ) : null}\r\n        {children}\r\n      </Box>\r\n    </Stack>\r\n  );\r\n}\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport React, { useContext, useState } from 'react';\r\nimport { SelectInput } from 'src/inputs';\r\n\r\nimport RemoveCircleOutlineOutlined from '@mui/icons-material/RemoveCircleOutlineOutlined';\r\nimport Box from '@mui/material/Box';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport { SelectChangeEvent } from '@mui/material/Select';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport type {\r\n  GenerationMessageRole,\r\n  IChatGeneration,\r\n  IGenerationMessage\r\n} from 'client-types/';\r\n\r\nconst roles = ['Assistant', 'System', 'User'];\r\n\r\ninterface MessageWrapperProps {\r\n  canSelectRole?: boolean;\r\n  children: React.ReactElement;\r\n  index?: number;\r\n  message?: IGenerationMessage;\r\n  role?: string;\r\n  name?: string;\r\n}\r\n\r\nconst MessageWrapper = ({\r\n  canSelectRole,\r\n  children,\r\n  index,\r\n  message,\r\n  role,\r\n  name\r\n}: MessageWrapperProps): JSX.Element => {\r\n  const [showSelectRole, setShowSelectRole] = useState(false);\r\n  const { setPlayground } = useContext(PlaygroundContext);\r\n\r\n  const onRoleSelected = (event: SelectChangeEvent) => {\r\n    const role = event.target.value as GenerationMessageRole;\r\n\r\n    if (role) {\r\n      setPlayground((old) => ({\r\n        ...old,\r\n        generation: {\r\n          ...old!.generation!,\r\n          messages: (old!.generation! as IChatGeneration).messages?.map(\r\n            (message, mIndex) => ({\r\n              ...message,\r\n              ...(mIndex === index ? { role } : {}) // Update role if it's the selected message\r\n            })\r\n          )\r\n        }\r\n      }));\r\n    }\r\n\r\n    setShowSelectRole(false);\r\n  };\r\n\r\n  const onRemove = () => {\r\n    if (index !== undefined) {\r\n      setPlayground((old) => ({\r\n        ...old,\r\n        generation: {\r\n          ...old!.generation!,\r\n          messages: [\r\n            ...(old!.generation! as IChatGeneration).messages!.slice(0, index),\r\n            ...(old!.generation! as IChatGeneration).messages!.slice(index + 1)\r\n          ]\r\n        }\r\n      }));\r\n    }\r\n  };\r\n\r\n  const roleSelect = (\r\n    <Box sx={{ flex: 1, paddingLeft: 2 }}>\r\n      {!showSelectRole ? (\r\n        <Typography\r\n          onClick={() => canSelectRole && setShowSelectRole(true)}\r\n          color=\"text.primary\"\r\n          sx={{\r\n            p: 1,\r\n            borderRadius: 0.5,\r\n            marginTop: 1,\r\n            cursor: canSelectRole ? 'pointer' : 'default',\r\n            fontSize: '12px',\r\n            fontWeight: 700,\r\n            width: 'fit-content',\r\n            ...(canSelectRole && {\r\n              '&:hover': {\r\n                backgroundColor: (theme) => theme.palette.divider\r\n              }\r\n            })\r\n          }}\r\n        >\r\n          {role}\r\n        </Typography>\r\n      ) : (\r\n        <SelectInput\r\n          onClose={() => setShowSelectRole(false)}\r\n          defaultOpen\r\n          items={roles.map((role) => ({\r\n            label: role,\r\n            value: role.toLowerCase()\r\n          }))}\r\n          id=\"role-select\"\r\n          value={message?.role}\r\n          onChange={onRoleSelected}\r\n          sx={{ width: 'fit-content' }}\r\n          iconSx={{\r\n            px: 0,\r\n            marginRight: '2px !important'\r\n          }}\r\n        />\r\n      )}\r\n      {name ? (\r\n        <Typography\r\n          color=\"text.secondary\"\r\n          variant=\"caption\"\r\n          sx={{\r\n            ml: 1,\r\n            width: 'fit-content'\r\n          }}\r\n        >\r\n          {name}\r\n        </Typography>\r\n      ) : null}\r\n    </Box>\r\n  );\r\n\r\n  return (\r\n    <Box key={index}>\r\n      <Box\r\n        sx={{\r\n          border: (theme) => `1px solid ${theme.palette.divider}`,\r\n          borderRadius: 1\r\n        }}\r\n      />\r\n      <Stack\r\n        direction=\"row\"\r\n        width=\"100%\"\r\n        sx={{\r\n          gap: 2,\r\n          flex: 10,\r\n          paddingY: 1,\r\n          '&:hover': {\r\n            background: (theme) => theme.palette.background.paper\r\n          }\r\n        }}\r\n      >\r\n        {roleSelect}\r\n        <Box flex={8}>{children}</Box>\r\n        {index !== undefined ? (\r\n          <Box color=\"text.secondary\">\r\n            <IconButton color=\"inherit\" onClick={onRemove}>\r\n              <RemoveCircleOutlineOutlined sx={{ height: 18, width: 18 }} />\r\n            </IconButton>\r\n          </Box>\r\n        ) : null}\r\n      </Stack>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default MessageWrapper;\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport {\r\n  ContentState,\r\n  Editor,\r\n  EditorState,\r\n  Modifier,\r\n  SelectionState\r\n} from 'draft-js';\r\nimport { OrderedSet } from 'immutable';\r\nimport isEqual from 'lodash/isEqual';\r\nimport merge from 'lodash/merge';\r\nimport { useContext, useRef, useState } from 'react';\r\nimport EditorWrapper from 'src/playground/editor/EditorWrapper';\r\nimport {\r\n  buildEscapeReplaceRegexp,\r\n  buildTemplatePlaceholderRegexp,\r\n  escape,\r\n  validateVariablePlaceholder\r\n} from 'src/playground/helpers/format';\r\nimport { useIsFirstRender } from 'usehooks-ts';\r\n\r\nimport { useColors } from 'hooks/useColors';\r\n\r\nimport type { IGeneration } from 'client-types/';\r\n\r\nimport 'draft-js/dist/Draft.css';\r\n\r\nexport interface IVariable {\r\n  name: string;\r\n  styleIndex: number;\r\n  content?: string;\r\n}\r\n\r\ninterface Props {\r\n  template?: string;\r\n  formatted?: string;\r\n  format: string;\r\n  inputs: IGeneration['inputs'];\r\n  readOnly?: boolean;\r\n  onChange?: (state: EditorState) => void;\r\n  showTitle?: boolean;\r\n  sxEditorChildren?: any;\r\n}\r\n\r\nfunction useCustomStyleMap() {\r\n  const colors = useColors(true);\r\n\r\n  const customStyleMap: Record<string, Record<string, string>> = {};\r\n\r\n  for (let i = 0; i < colors.length; i++) {\r\n    customStyleMap[i.toString()] = {\r\n      background: colors[i],\r\n      borderRadius: '2px',\r\n      cursor: 'pointer'\r\n    };\r\n  }\r\n\r\n  return customStyleMap;\r\n}\r\n\r\n/* This function takes a draftjs block content and matches all escaping and interpolation\r\n * candidates using a regexp specific to the current template format. f-string example:\r\n * \"Hello this is a {{{{variable}}}}\" would match \"{{{{variable}}}}\".\r\n */\r\nfunction matchToEscapeOrReplace(text: string, format: string) {\r\n  const regexp = buildEscapeReplaceRegexp(format);\r\n  const matches: RegExpExecArray[] = [];\r\n  let match: RegExpExecArray | null;\r\n\r\n  while ((match = regexp.exec(text)) !== null) {\r\n    if (match.index > -1) {\r\n      matches.push(match);\r\n    }\r\n  }\r\n\r\n  return matches;\r\n}\r\n\r\n// This function takes a text and tries to match a variable placeholder to replace\r\nfunction matchVariable(text: string, variableName: string, format: string) {\r\n  // Get the regex based on the current template format\r\n  const regex = buildTemplatePlaceholderRegexp(variableName, format);\r\n  const match = regex.exec(text);\r\n  const matchedVariable = match?.[0];\r\n  if (matchedVariable) {\r\n    // We found a variable candidate for instance {{{{variable}}}}\".\r\n    // We now need to validate that we need to replace it.\r\n    const { ok } = validateVariablePlaceholder(\r\n      variableName,\r\n      matchedVariable,\r\n      format\r\n    );\r\n    return { match: matchedVariable, ok };\r\n  } else {\r\n    return { match: '', ok: false };\r\n  }\r\n}\r\n\r\nfunction formatTemplate(\r\n  state: EditorState,\r\n  variables: IVariable[],\r\n  format: string\r\n) {\r\n  let contentState = state.getCurrentContent();\r\n  let nextState = state;\r\n\r\n  // Iterate each block in the editor.\r\n  // At this point the editor content is still the template\r\n  contentState.getBlockMap().forEach((contentBlock) => {\r\n    if (!contentBlock) {\r\n      return;\r\n    }\r\n\r\n    const key = contentBlock.getKey();\r\n    const text = contentBlock.getText();\r\n\r\n    // Get the substrings of the block to escape/replace\r\n    const ssmToEscapeOrReplace = matchToEscapeOrReplace(text, format);\r\n\r\n    // We start with escaping\r\n\r\n    // Each escaping will change the block text length.\r\n    // We need to keep track of the length diff (offset) to keep the escaping accurate.\r\n    let escapeOffset = 0;\r\n\r\n    const ssmToEscapeOrReplaceWithVariable = ssmToEscapeOrReplace.map((ssm) => {\r\n      const ss = ssm[0];\r\n\r\n      let variableFound: { variable: IVariable; match: string } | undefined =\r\n        undefined;\r\n      // Iterate each variable and try to match it.\r\n      // If there is a match, flag it for replacement later on and break.\r\n      for (const variable of variables) {\r\n        const { match, ok } = matchVariable(ss, variable.name, format);\r\n        if (ok) {\r\n          variableFound = { variable, match };\r\n          break;\r\n        }\r\n      }\r\n\r\n      // start index of the selection to escape, accounting for offset\r\n      const startIndex = ssm.index + escapeOffset;\r\n      // end index of the selection to scape, accounting for offset\r\n      const endIndex = startIndex + ss.length;\r\n\r\n      // Define the selection of the template to escape\r\n      const selectionToEscape = new SelectionState({\r\n        anchorKey: key,\r\n        anchorOffset: startIndex,\r\n        focusKey: key,\r\n        focusOffset: endIndex\r\n      });\r\n\r\n      // Escape the substring\r\n      const content = escape(ss, format);\r\n\r\n      // Update the offset (new value length - old value length)\r\n      escapeOffset += content.length - ss.length;\r\n\r\n      // Perform the replace operation\r\n      contentState = Modifier.replaceText(\r\n        contentState,\r\n        selectionToEscape,\r\n        content\r\n      );\r\n      nextState = EditorState.push(state, contentState, 'apply-entity');\r\n\r\n      // Update the substring match since we just updated it\r\n      ssm[0] = content;\r\n      ssm.index = startIndex;\r\n\r\n      return { ssm, variableFound };\r\n    });\r\n\r\n    // At this point the template has been escaped\r\n    // We now perform replace operations\r\n\r\n    // Each replace will change the block text length.\r\n    // We need to keep track of the length diff (offset) to keep the replace accurate.\r\n    let replaceOffset = 0;\r\n\r\n    ssmToEscapeOrReplaceWithVariable.forEach(({ ssm, variableFound }) => {\r\n      if (!variableFound) {\r\n        // Nothing to replace\r\n        return;\r\n      }\r\n\r\n      const { variable } = variableFound;\r\n\r\n      const ss = ssm[0];\r\n\r\n      // It is important to preserve the selection to keep the text selectable (copy paste for instance)\r\n      const currentSelection = nextState.getSelection();\r\n\r\n      // We know the variable is here but we need to know the exact range to replace\r\n      // for instance {{{var1}}} was escaped to {{var1}} so we need to replace {var1}\r\n      const { localEndIndex, localStartIndex } = validateVariablePlaceholder(\r\n        variable.name,\r\n        ss,\r\n        format\r\n      );\r\n\r\n      // The start of the range is the\r\n      // start index of the whole variable + the local start index\r\n      // of the exact variable match + the offset\r\n      const startIndex = ssm.index + localStartIndex + replaceOffset;\r\n\r\n      // Same for the end index\r\n      const endIndex = ssm.index + localEndIndex + replaceOffset;\r\n\r\n      // Define the selection to replace\r\n      const selectionToHighlight = new SelectionState({\r\n        anchorKey: key,\r\n        anchorOffset: startIndex,\r\n        focusKey: key,\r\n        focusOffset: endIndex\r\n      });\r\n\r\n      const content = variable.content || '';\r\n\r\n      // Update the offset\r\n      replaceOffset += content.length - (localEndIndex - localStartIndex);\r\n\r\n      // Perform the replace operation\r\n      contentState = nextState.getCurrentContent();\r\n      contentState = contentState.createEntity('TOKEN', 'SEGMENTED', variable);\r\n      const entityKey = contentState.getLastCreatedEntityKey();\r\n      contentState = Modifier.replaceText(\r\n        contentState,\r\n        selectionToHighlight,\r\n        content,\r\n        OrderedSet.of(variable.styleIndex.toString()),\r\n        entityKey\r\n      );\r\n      nextState = EditorState.push(nextState, contentState, 'apply-entity');\r\n      nextState = EditorState.forceSelection(nextState, currentSelection);\r\n    });\r\n  });\r\n\r\n  return nextState;\r\n}\r\n\r\nfunction getEntityAtSelection(editorState: EditorState) {\r\n  const selectionState = editorState.getSelection();\r\n  const selectionKey = selectionState.getStartKey();\r\n  const contentstate = editorState.getCurrentContent();\r\n\r\n  // The block in which the selection starts\r\n  const block = contentstate.getBlockForKey(selectionKey);\r\n\r\n  if (!block) {\r\n    return;\r\n  }\r\n\r\n  // Entity key at the start selection\r\n  const entityKey = block.getEntityAt(selectionState.getStartOffset());\r\n  if (entityKey) {\r\n    // The actual entity instance\r\n    const entityInstance = contentstate.getEntity(entityKey);\r\n    const entityInfo = {\r\n      type: entityInstance.getType(),\r\n      mutability: entityInstance.getMutability(),\r\n      data: entityInstance.getData()\r\n    };\r\n    return entityInfo;\r\n  }\r\n}\r\n\r\nexport default function FormattedEditor({\r\n  template,\r\n  formatted,\r\n  inputs,\r\n  format,\r\n  readOnly,\r\n  onChange,\r\n  showTitle = false,\r\n  sxEditorChildren\r\n}: Props) {\r\n  const editorRef = useRef<Editor>(null);\r\n  const { setVariableName, setPromptMode, onNotification } =\r\n    useContext(PlaygroundContext);\r\n\r\n  const [state, setState] = useState<EditorState | undefined>();\r\n  const [prevInputs, setPrevInputs] = useState<Record<string, string>>();\r\n\r\n  const customStyleMap = useCustomStyleMap();\r\n  const isFirstRender = useIsFirstRender();\r\n\r\n  if (isFirstRender || !isEqual(inputs, prevInputs)) {\r\n    if (typeof template === 'string') {\r\n      inputs = inputs || {};\r\n\r\n      const variableNames = Object.keys(inputs);\r\n      const variables: IVariable[] = [];\r\n\r\n      for (let i = 0; i < variableNames.length; i++) {\r\n        const variableName = variableNames[i];\r\n\r\n        const variableContent = inputs[variableName];\r\n\r\n        variables.push({\r\n          name: variableName,\r\n          styleIndex: i,\r\n          content: variableContent\r\n        });\r\n      }\r\n\r\n      const sortedVariables = variables.sort(\r\n        (a, b) => b.name.length - a.name.length\r\n      );\r\n\r\n      const state = EditorState.createWithContent(\r\n        ContentState.createFromText(template)\r\n      );\r\n      const nextState = formatTemplate(state, sortedVariables, format);\r\n\r\n      setState(nextState);\r\n    } else if (typeof formatted === 'string') {\r\n      const nextState = EditorState.createWithContent(\r\n        ContentState.createFromText(formatted)\r\n      );\r\n      setState(nextState);\r\n    }\r\n    setPrevInputs(inputs);\r\n  }\r\n\r\n  const handleOnEditorChange = (nextState: EditorState) => {\r\n    const hasFocus = nextState.getSelection().getHasFocus();\r\n    const isCollapsed = nextState.getSelection().isCollapsed();\r\n    const entity = getEntityAtSelection(nextState);\r\n    if (entity && hasFocus && isCollapsed && editorRef.current) {\r\n      // Open the variable modal\r\n      setVariableName(entity.data.name);\r\n\r\n      // If we do not blur the selection stay the same\r\n      // And we keep opening the variable\r\n      editorRef.current.blur();\r\n    }\r\n\r\n    if (!readOnly) {\r\n      // update editor\r\n      onChange && onChange(nextState);\r\n    } else if (state) {\r\n      const currentContent = state.getCurrentContent();\r\n      const nextContent = nextState.getCurrentContent();\r\n\r\n      if (currentContent !== nextContent) {\r\n        onNotification(\r\n          'error',\r\n          'Formatted prompt is read only. Edit the template/variables instead.'\r\n        );\r\n        setPromptMode('Template');\r\n      }\r\n\r\n      // Read only mode, force content but preserve selection\r\n      nextState = EditorState.push(\r\n        nextState,\r\n        currentContent,\r\n        'insert-characters'\r\n      );\r\n    }\r\n    setState(nextState);\r\n  };\r\n\r\n  if (!state) {\r\n    return null;\r\n  }\r\n\r\n  const title = readOnly ? 'Formatted prompt [Read Only]' : 'Formatted prompt';\r\n\r\n  return (\r\n    <EditorWrapper\r\n      className=\"formatted-editor\"\r\n      title={showTitle ? title : undefined}\r\n      clipboardValue={state?.getCurrentContent().getPlainText()}\r\n      sxChildren={merge(\r\n        sxEditorChildren || {},\r\n        readOnly\r\n          ? {\r\n              caretColor: 'transparent',\r\n              backgroundColor: 'transparent',\r\n              borderColor: 'transparent !important'\r\n            }\r\n          : {}\r\n      )}\r\n    >\r\n      <Editor\r\n        ref={editorRef}\r\n        customStyleMap={customStyleMap}\r\n        editorState={state}\r\n        onChange={handleOnEditorChange}\r\n      />\r\n    </EditorWrapper>\r\n  );\r\n}\r\n","// Helper function to match the placeholders for a given variable in the template\r\nexport function buildTemplatePlaceholderRegexp(\r\n  variable: string,\r\n  format: string\r\n) {\r\n  switch (format) {\r\n    case 'f-string': {\r\n      return new RegExp(`\\\\{+(${variable}+)\\\\}+`, 'g');\r\n    }\r\n    default:\r\n      throw new Error(`Unsupported template format ${format}`);\r\n  }\r\n}\r\n\r\n// Helper function to match the placeholders for a all variables in the template\r\nexport function buildTemplatePlaceholdersRegexp(\r\n  inputs: object,\r\n  format: string\r\n) {\r\n  const variables = Object.keys(inputs).sort((a, b) => b.length - a.length);\r\n  if (!variables.length) {\r\n    return undefined;\r\n  }\r\n  switch (format) {\r\n    case 'f-string': {\r\n      // Create a regex pattern from the variables array\r\n      const regexPattern = variables.map((v) => `${v}`).join('|');\r\n      return buildTemplatePlaceholderRegexp(regexPattern, format);\r\n    }\r\n    default:\r\n      throw new Error(`Unsupported template format ${format}`);\r\n  }\r\n}\r\n\r\n// Helper function to escape the template\r\nexport function escape(str: string, format: string) {\r\n  switch (format) {\r\n    case 'f-string': {\r\n      str = str.replaceAll('{{', '{');\r\n      str = str.replaceAll('}}', '}');\r\n      return str;\r\n    }\r\n    default:\r\n      throw new Error(`Unsupported template format ${format}`);\r\n  }\r\n}\r\n\r\n// Helper function to match all substrings to escape and or replace\r\nexport function buildEscapeReplaceRegexp(format: string) {\r\n  switch (format) {\r\n    case 'f-string': {\r\n      // Match wrapped by {} or opening or closing braces\r\n      return /\\{+([^{}]+)\\}+|{{|}}/g;\r\n    }\r\n    default:\r\n      throw new Error(`Unsupported template format ${format}`);\r\n  }\r\n}\r\n\r\n// Helper function to build the template placeholder of a variable\r\nexport function buildVariablePlaceholder(variable: string, format: string) {\r\n  switch (format) {\r\n    case 'f-string': {\r\n      return `{${variable}}`;\r\n    }\r\n    default:\r\n      throw new Error(`Unsupported template format ${format}`);\r\n  }\r\n}\r\n\r\nexport function validateVariablePlaceholder(\r\n  variableName: string,\r\n  match: string,\r\n  format: string\r\n) {\r\n  switch (format) {\r\n    case 'f-string': {\r\n      // leading curly braces\r\n      const prefixBracesCount = match.split(variableName)[0].length;\r\n      // tailing curly braces\r\n      const suffixBracesCount = match.split(variableName)[1].length;\r\n      const isOdd = prefixBracesCount % 2;\r\n      const ok = isOdd && prefixBracesCount === suffixBracesCount;\r\n      const placeholder = buildVariablePlaceholder(variableName, format);\r\n      const localStartIndex = match.indexOf(placeholder);\r\n      const localEndIndex = localStartIndex + placeholder.length;\r\n      return {\r\n        ok,\r\n        localStartIndex,\r\n        localEndIndex\r\n      };\r\n    }\r\n    default:\r\n      throw new Error(`Unsupported template format ${format}`);\r\n  }\r\n}\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { EditorState } from 'draft-js';\r\nimport { Fragment, forwardRef, useContext } from 'react';\r\nimport { grey } from 'theme';\r\n\r\nimport AddCircleOutlined from '@mui/icons-material/AddCircleOutlined';\r\nimport Box from '@mui/material/Box';\r\nimport Button from '@mui/material/Button';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport type { IChatGeneration } from 'client-types/';\r\n\r\nimport Completion from './editor/completion';\r\nimport PromptMessage from './editor/promptMessage';\r\n\r\ninterface Props {\r\n  generation: IChatGeneration;\r\n  hasTemplate: boolean;\r\n  restoredTime: number;\r\n}\r\n\r\nexport const ChatPromptPlayground = forwardRef(\r\n  ({ hasTemplate, generation, restoredTime }: Props, ref) => {\r\n    const { promptMode, setPlayground } = useContext(PlaygroundContext);\r\n    const messages = generation.messages;\r\n\r\n    const onChange = (index: number, nextState: EditorState) => {\r\n      const text = nextState.getCurrentContent().getPlainText();\r\n\r\n      setPlayground((old) => ({\r\n        ...old,\r\n        generation: {\r\n          ...old!.generation!,\r\n          messages: (old!.generation! as IChatGeneration).messages?.map(\r\n            (message, mIndex) => {\r\n              if (mIndex === index) {\r\n                return {\r\n                  ...message,\r\n                  content: text\r\n                };\r\n              }\r\n              return message;\r\n            }\r\n          )\r\n        }\r\n      }));\r\n    };\r\n\r\n    const title =\r\n      promptMode === 'Formatted'\r\n        ? hasTemplate\r\n          ? 'Formatted messages [Read Only]'\r\n          : 'Formatted messages'\r\n        : 'Prompt messages';\r\n\r\n    return (\r\n      <Stack sx={{ width: '100%' }}>\r\n        <Typography fontSize=\"14px\" fontWeight={700} color={grey[400]}>\r\n          {title}\r\n        </Typography>\r\n        <Box\r\n          key={restoredTime} // This will re-mount the component with restored messages\r\n          ref={ref}\r\n          sx={{\r\n            flex: 1,\r\n            height: 'auto',\r\n            overflow: 'auto',\r\n            scrollbarGutter: 'stable',\r\n            marginTop: 1,\r\n            gap: 1\r\n          }}\r\n        >\r\n          {messages?.length ? (\r\n            <Stack>\r\n              {messages.map((message, index) => (\r\n                <Fragment key={`prompt-message-${index}`}>\r\n                  <PromptMessage\r\n                    message={message}\r\n                    generation={generation}\r\n                    mode={promptMode}\r\n                    index={index}\r\n                    onChange={onChange}\r\n                  />\r\n                </Fragment>\r\n              ))}\r\n            </Stack>\r\n          ) : null}\r\n          <Box color=\"text.secondary\" pl={2} py={2}>\r\n            <Button\r\n              onClick={() => {\r\n                setPlayground((old) => ({\r\n                  ...old,\r\n                  generation: {\r\n                    ...old!.generation!,\r\n                    messages: [\r\n                      ...(old!.generation! as IChatGeneration).messages!,\r\n                      {\r\n                        role: 'assistant',\r\n                        content: ''\r\n                      }\r\n                    ]\r\n                  }\r\n                }));\r\n              }}\r\n              color=\"inherit\"\r\n              sx={{ fontWeight: 700, textTransform: 'capitalize' }}\r\n              startIcon={<AddCircleOutlined />}\r\n            >\r\n              Add Message\r\n            </Button>\r\n          </Box>\r\n          <Completion\r\n            completion={generation.messageCompletion?.content}\r\n            chatMode\r\n          />\r\n        </Box>\r\n      </Stack>\r\n    );\r\n  }\r\n);\r\n\r\nexport default ChatPromptPlayground;\r\n","import { EditorState } from 'draft-js';\r\n\r\nimport Alert from '@mui/material/Alert';\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\nimport type { IChatGeneration, IGenerationMessage } from 'client-types/';\r\nimport { PromptMode } from 'src/types/playground';\r\n\r\nimport MessageWrapper from './MessageWrapper';\r\nimport FormattedEditor from './formatted';\r\n\r\ninterface Props {\r\n  message: IGenerationMessage;\r\n  generation: IChatGeneration;\r\n  mode: PromptMode;\r\n  index: number;\r\n  onChange: (index: number, nextState: EditorState) => void;\r\n}\r\n\r\nexport default function PromptMessage({\r\n  message,\r\n  generation,\r\n  mode,\r\n  index,\r\n  onChange\r\n}: Props) {\r\n  const theme = useTheme();\r\n\r\n  const templateProps = {\r\n    inputs: generation.variables || {},\r\n    format: 'f-string',\r\n    sxEditorChildren: {\r\n      padding: theme.spacing(2),\r\n      backgroundColor: '',\r\n      '&:hover': {\r\n        background: theme.palette.background.paper\r\n      }\r\n    }\r\n  };\r\n\r\n  const renderFormatted = () => {\r\n    if (typeof message.content === 'string') {\r\n      return (\r\n        <FormattedEditor\r\n          {...templateProps}\r\n          onChange={(state) => onChange(index, state)}\r\n          formatted={message.content}\r\n          readOnly={false}\r\n          showTitle={false}\r\n        />\r\n      );\r\n    }\r\n\r\n    return (\r\n      <Alert severity=\"error\">\r\n        Neither template or formatted prompt provided.\r\n      </Alert>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <MessageWrapper\r\n      canSelectRole\r\n      index={index}\r\n      message={message}\r\n      role={message.role?.toUpperCase()}\r\n      name={message.name}\r\n    >\r\n      <>{mode === 'Formatted' ? renderFormatted() : null}</>\r\n    </MessageWrapper>\r\n  );\r\n}\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { useFormik } from 'formik';\r\nimport { useContext } from 'react';\r\nimport { AccentButton } from 'src/buttons';\r\nimport { TextInput } from 'src/inputs';\r\nimport { grey } from 'theme';\r\nimport * as yup from 'yup';\r\n\r\nimport Box from '@mui/material/Box';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\nconst FunctionModal = (): JSX.Element | null => {\r\n  const { setPlayground, playground, functionIndex, setFunctionIndex } =\r\n    useContext(PlaygroundContext);\r\n\r\n  const theme = useTheme();\r\n  const hasIndex = functionIndex !== undefined;\r\n  const functions = playground?.generation?.functions || [];\r\n  const fn = hasIndex ? functions[functionIndex] : undefined;\r\n\r\n  const updateFunction = (name: string, description: string) => {\r\n    if (functionIndex !== undefined && fn) {\r\n      const nextFn = { ...fn, name, description };\r\n      setPlayground((old) => {\r\n        if (!old?.generation) return old;\r\n\r\n        return {\r\n          ...old,\r\n          generation: {\r\n            ...old.generation,\r\n            functions: [\r\n              ...functions.slice(0, functionIndex),\r\n              nextFn,\r\n              ...functions.slice(functionIndex + 1)\r\n            ]\r\n          }\r\n        };\r\n      });\r\n      setFunctionIndex(undefined);\r\n    }\r\n  };\r\n\r\n  const formik = useFormik({\r\n    initialValues: {\r\n      name: fn?.name,\r\n      description: fn?.description\r\n    },\r\n    validationSchema: yup.object({\r\n      name: yup.string().required(),\r\n      description: yup.string().required()\r\n    }),\r\n    enableReinitialize: true,\r\n    onSubmit: async (values) => {\r\n      updateFunction(values.name!, values.description!);\r\n    }\r\n  });\r\n\r\n  return (\r\n    <Dialog\r\n      id=\"function-modal\"\r\n      open={!!fn}\r\n      onClose={() => setFunctionIndex(undefined)}\r\n      fullWidth\r\n      maxWidth=\"md\"\r\n      sx={{\r\n        border: (theme) =>\r\n          theme.palette.mode === 'dark' ? `1px solid ${grey[800]}` : null,\r\n        borderRadius: 1\r\n      }}\r\n    >\r\n      <Box bgcolor=\"background.paper\">\r\n        <DialogTitle>\r\n          <Typography fontSize=\"16px\" fontWeight={700} color=\"text.secondary\">\r\n            {`Edit function ${fn?.name}`}\r\n          </Typography>\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Stack gap={2}>\r\n            <TextInput\r\n              id=\"fn-name\"\r\n              label=\"Function name\"\r\n              onChange={(e) => formik.setFieldValue('name', e.target.value)}\r\n              value={formik.values['name']}\r\n              hasError={!!formik.errors.name}\r\n            />\r\n            <TextInput\r\n              id=\"fn-desc\"\r\n              label=\"Function description\"\r\n              multiline\r\n              onChange={(e) =>\r\n                formik.setFieldValue('description', e.target.value)\r\n              }\r\n              value={formik.values['description']}\r\n              hasError={!!formik.errors.description}\r\n            />\r\n          </Stack>\r\n        </DialogContent>\r\n        <DialogActions sx={{ padding: theme.spacing(0, 3, 2) }}>\r\n          <AccentButton\r\n            id=\"edit-function\"\r\n            variant=\"outlined\"\r\n            onClick={() => formik.submitForm()}\r\n          >\r\n            Save\r\n          </AccentButton>\r\n        </DialogActions>\r\n      </Box>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default FunctionModal;\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { ContentState, Editor, EditorState } from 'draft-js';\r\nimport { useContext, useEffect, useState } from 'react';\r\nimport { AccentButton } from 'src/buttons';\r\nimport { grey } from 'theme';\r\n\r\nimport Alert from '@mui/material/Alert';\r\nimport Box from '@mui/material/Box';\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogActions from '@mui/material/DialogActions';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport DialogTitle from '@mui/material/DialogTitle';\r\nimport Typography from '@mui/material/Typography';\r\nimport { useTheme } from '@mui/material/styles';\r\n\r\nimport EditorWrapper from './EditorWrapper';\r\n\r\nconst VariableModal = (): JSX.Element | null => {\r\n  const [state, setState] = useState<EditorState | undefined>();\r\n  const { setPlayground, playground, variableName, setVariableName } =\r\n    useContext(PlaygroundContext);\r\n\r\n  const theme = useTheme();\r\n\r\n  useEffect(() => {\r\n    if (variableName && playground?.generation?.inputs) {\r\n      setState(\r\n        EditorState.createWithContent(\r\n          ContentState.createFromText(\r\n            playground.generation.inputs[variableName]\r\n          )\r\n        )\r\n      );\r\n    }\r\n  }, [variableName]);\r\n\r\n  const updateVariable = () => {\r\n    if (variableName) {\r\n      setPlayground((old) => {\r\n        if (!old?.generation) return old;\r\n\r\n        return {\r\n          ...old,\r\n          generation: {\r\n            ...old.generation,\r\n            inputs: {\r\n              ...old?.generation?.inputs,\r\n              [variableName]: state?.getCurrentContent().getPlainText() || ''\r\n            }\r\n          }\r\n        };\r\n      });\r\n      setVariableName(undefined);\r\n    }\r\n  };\r\n\r\n  const resetVariableName = () => {\r\n    setVariableName(undefined);\r\n  };\r\n\r\n  if (!variableName) return null;\r\n\r\n  return (\r\n    <Dialog\r\n      id=\"variable-modal\"\r\n      open={!!variableName}\r\n      onClose={resetVariableName}\r\n      fullWidth\r\n      maxWidth=\"md\"\r\n      sx={{\r\n        border: (theme) =>\r\n          theme.palette.mode === 'dark' ? `1px solid ${grey[800]}` : null,\r\n        borderRadius: 1\r\n      }}\r\n    >\r\n      <Box bgcolor=\"background.paper\">\r\n        <DialogTitle>\r\n          <Typography fontSize=\"16px\" fontWeight={700} color=\"text.secondary\">\r\n            {`Edit ${variableName}`}\r\n          </Typography>\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Alert sx={{ my: 1 }} severity=\"info\">\r\n            Editing a variable will update its value in the formatted view. If\r\n            you want to update the template instead, go to the template view.\r\n          </Alert>\r\n          {state ? (\r\n            <EditorWrapper\r\n              sx={{ minHeight: '250px' }}\r\n              sxChildren={{ padding: 1 }}\r\n            >\r\n              <Editor\r\n                customStyleFn={() => ({\r\n                  color: theme.palette.text.primary,\r\n                  padding: '2px'\r\n                })}\r\n                editorState={state}\r\n                onChange={(nextState) => {\r\n                  nextState && setState(nextState);\r\n                }}\r\n              />\r\n            </EditorWrapper>\r\n          ) : null}\r\n        </DialogContent>\r\n        <DialogActions sx={{ padding: theme.spacing(0, 3, 2) }}>\r\n          <AccentButton\r\n            id=\"edit-variable\"\r\n            onClick={updateVariable}\r\n            variant=\"outlined\"\r\n          >\r\n            Save\r\n          </AccentButton>\r\n        </DialogActions>\r\n      </Box>\r\n    </Dialog>\r\n  );\r\n};\r\n\r\nexport default VariableModal;\r\n","import { AccentButton } from 'src/buttons';\r\nimport { grey } from 'theme';\r\n\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport TuneIcon from '@mui/icons-material/Tune';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport Stack from '@mui/material/Stack';\r\n\r\nimport FunctionInput from './functionInput';\r\nimport PromptModeToggle from './modeToggle';\r\nimport VariableInput from './variableInput';\r\n\r\ninterface Props {\r\n  hasTemplate?: boolean;\r\n  showToggleDrawerButton?: boolean;\r\n  toggleDrawer: () => void;\r\n  handleClose: () => void;\r\n}\r\n\r\nexport default function PlaygroundHeader({\r\n  hasTemplate,\r\n  showToggleDrawerButton,\r\n  toggleDrawer,\r\n  handleClose\r\n}: Props) {\r\n  return (\r\n    <Stack direction=\"row\" alignItems=\"center\">\r\n      <Stack direction=\"row\" alignItems=\"center\" gap={2}>\r\n        <PromptModeToggle hasTemplate={hasTemplate} />\r\n        <VariableInput />\r\n        <FunctionInput />\r\n      </Stack>\r\n      <Stack sx={{ ml: 'auto' }} direction=\"row\" alignItems=\"center\" gap={1}>\r\n        <AccentButton\r\n          size=\"large\"\r\n          target=\"_blank\"\r\n          href=\"https://docs.chainlit.io/advanced-features/prompt-playground/overview\"\r\n        >\r\n          Help\r\n        </AccentButton>\r\n\r\n        {showToggleDrawerButton ? (\r\n          <IconButton\r\n            aria-label=\"open drawer\"\r\n            edge=\"end\"\r\n            onClick={toggleDrawer}\r\n            sx={{ mr: '4px' }}\r\n          >\r\n            <TuneIcon />\r\n          </IconButton>\r\n        ) : null}\r\n        <IconButton edge=\"end\" id=\"close-playground\" onClick={handleClose}>\r\n          <CloseIcon sx={{ height: '32px', width: '32px', color: grey[500] }} />\r\n        </IconButton>\r\n      </Stack>\r\n    </Stack>\r\n  );\r\n}\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { useContext } from 'react';\r\nimport { SelectInput } from 'src/inputs/selects/SelectInput';\r\n\r\nconst FunctionInput = (): JSX.Element | null => {\r\n  const { functionIndex, setFunctionIndex, playground } =\r\n    useContext(PlaygroundContext);\r\n\r\n  const functions = playground?.generation?.functions || [];\r\n\r\n  const options = functions.map((fn, index) => ({\r\n    label: fn.name,\r\n    value: index.toString()\r\n  }));\r\n\r\n  return functions?.length > 0 ? (\r\n    <SelectInput\r\n      items={options}\r\n      id=\"function-select\"\r\n      value={functionIndex !== undefined ? functionIndex.toString() : ''}\r\n      label=\"Edit a function\"\r\n      onChange={(e) => setFunctionIndex(parseInt(e.target.value, 10))}\r\n      sx={{ maxWidth: '270px' }}\r\n    />\r\n  ) : null;\r\n};\r\n\r\nexport default FunctionInput;\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { useContext } from 'react';\r\nimport { Toggle } from 'src/buttons';\r\n\r\nimport Tooltip from '@mui/material/Tooltip';\r\n\r\nimport { PromptMode } from 'src/types/playground';\r\n\r\ninterface Props {\r\n  hasTemplate?: boolean;\r\n}\r\nexport default function PromptModeToggle({ hasTemplate }: Props) {\r\n  const { setPromptMode, promptMode } = useContext(PlaygroundContext);\r\n  const disabled = !hasTemplate;\r\n\r\n  const toggle = (\r\n    <Toggle\r\n      disabled={disabled}\r\n      label={'View'}\r\n      id=\"toggle-prompt-mode\"\r\n      value={promptMode}\r\n      items={['Template', 'Formatted']}\r\n      onChange={(v) => setPromptMode(v as PromptMode)}\r\n    />\r\n  );\r\n\r\n  if (disabled) {\r\n    return (\r\n      <Tooltip title=\"Prompt template not found. Only displaying formatted prompt instead.\">\r\n        <span>{toggle}</span>\r\n      </Tooltip>\r\n    );\r\n  } else {\r\n    return toggle;\r\n  }\r\n}\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport map from 'lodash/map';\r\nimport { useContext } from 'react';\r\nimport { SelectInput } from 'src/inputs/selects/SelectInput';\r\n\r\nconst VariableInput = (): JSX.Element | null => {\r\n  const { variableName, setVariableName, playground } =\r\n    useContext(PlaygroundContext);\r\n\r\n  const variables = map(playground?.generation?.inputs, (input, index) => ({\r\n    label: index,\r\n    value: index\r\n  }));\r\n\r\n  return variables?.length > 0 ? (\r\n    <SelectInput\r\n      items={variables}\r\n      id=\"variable-select\"\r\n      value={variableName || ''}\r\n      label=\"Edit a variable\"\r\n      onChange={(e) => setVariableName(e.target.value)}\r\n      sx={{ maxWidth: '270px' }}\r\n    />\r\n  ) : null;\r\n};\r\n\r\nexport default VariableInput;\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport { useFormik } from 'formik';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\nimport merge from 'lodash/merge';\r\nimport { useContext, useEffect } from 'react';\r\nimport { FormInput, SelectInput, TFormInput } from 'src/inputs';\r\nimport { getProviders } from 'src/playground/helpers/provider';\r\nimport * as yup from 'yup';\r\n\r\nimport ChevronRightIcon from '@mui/icons-material/ChevronRight';\r\nimport Alert from '@mui/material/Alert';\r\nimport Box from '@mui/material/Box';\r\nimport Drawer from '@mui/material/Drawer';\r\nimport IconButton from '@mui/material/IconButton';\r\nimport { SelectChangeEvent } from '@mui/material/Select';\r\nimport Stack from '@mui/material/Stack';\r\nimport Typography from '@mui/material/Typography';\r\n\r\nimport type { ILLMSettings } from 'client-types/';\r\nimport { ILLMProvider } from 'src/types/playground';\r\n\r\ntype Schema = {\r\n  [key: string]: yup.Schema;\r\n};\r\n\r\ninterface IFormProps {\r\n  settings: ILLMSettings;\r\n  schema: Schema;\r\n  provider: ILLMProvider;\r\n  providers: ILLMProvider[];\r\n  providerWarning: JSX.Element | null;\r\n  providerTooltip?: string;\r\n}\r\n\r\nconst SettingsForm = ({\r\n  settings,\r\n  schema,\r\n  provider,\r\n  providers,\r\n  providerTooltip,\r\n  providerWarning\r\n}: IFormProps) => {\r\n  const { setPlayground } = useContext(PlaygroundContext);\r\n\r\n  const formik = useFormik({\r\n    initialValues: settings,\r\n    validationSchema: schema,\r\n    enableReinitialize: true,\r\n    onSubmit: async () => undefined\r\n  });\r\n\r\n  useEffect(() => {\r\n    const debounceTimeout = setTimeout(() => {\r\n      setPlayground((old) => ({\r\n        ...old,\r\n        generation: {\r\n          ...old!.generation!,\r\n          settings: formik.values\r\n        }\r\n      }));\r\n    }, 500);\r\n\r\n    return () => {\r\n      clearTimeout(debounceTimeout);\r\n    };\r\n  }, [formik.values]);\r\n\r\n  const onSelectedProviderChange = (event: SelectChangeEvent) => {\r\n    setPlayground((old) =>\r\n      merge(cloneDeep(old), {\r\n        generation: {\r\n          provider: event.target.value\r\n        }\r\n      })\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Box width={250} sx={{ height: 'inherit' }}>\r\n      <Typography fontSize=\"16px\" fontWeight={600} color=\"text.primary\">\r\n        Settings\r\n      </Typography>\r\n      <Stack\r\n        spacing={2}\r\n        sx={{\r\n          overflowY: 'auto',\r\n          overflowX: 'hidden',\r\n          height: '100%'\r\n        }}\r\n      >\r\n        <SelectInput\r\n          items={providers?.map((provider: ILLMProvider) => ({\r\n            label: provider.name,\r\n            value: provider.id\r\n          }))}\r\n          id=\"llm-providers\"\r\n          value={provider.id}\r\n          label=\"LLM Provider\"\r\n          tooltip={providerTooltip}\r\n          onChange={onSelectedProviderChange}\r\n        />\r\n        {providerWarning}\r\n        {provider.inputs.map((input: TFormInput, index: number) => (\r\n          <Box\r\n            // This trick is to have padding at the end of the scroll\r\n            sx={{ paddingBottom: index === provider.inputs.length - 1 ? 2 : 0 }}\r\n            key={input.id}\r\n          >\r\n            <FormInput\r\n              element={{\r\n                ...input,\r\n                id: input.id,\r\n                value: formik.values[input.id] as any,\r\n                onChange: formik.handleChange,\r\n                setField: formik.setFieldValue\r\n              }}\r\n            />\r\n          </Box>\r\n        ))}\r\n      </Stack>\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst ModelSettings = () => {\r\n  const { playground } = useContext(PlaygroundContext);\r\n\r\n  if (!playground || !playground?.providers) {\r\n    return null;\r\n  }\r\n\r\n  const { provider, providerFound, providers } = getProviders(playground);\r\n\r\n  if (!provider) {\r\n    return null;\r\n  }\r\n\r\n  const buildProviderTooltip = () => {\r\n    if (provider.is_chat && playground.generation?.type !== 'CHAT') {\r\n      return `${provider.name} is chat-based. This prompt will be wrapped in a message before being sent to ${provider.name}.`;\r\n    } else if (!provider.is_chat && playground.generation?.type === 'CHAT') {\r\n      return `${provider.name} is completion-based. The messages will converted to a single prompt before being sent to ${provider.name}.`;\r\n    } else {\r\n      return undefined;\r\n    }\r\n  };\r\n\r\n  const providerWarning = !providerFound ? (\r\n    <Alert severity=\"warning\">\r\n      {playground.generation?.provider\r\n        ? `${playground?.generation?.provider} provider is not found, using\r\n      ${provider.name} instead.`\r\n        : `Provider not specified, using ${provider.name} instead.`}\r\n    </Alert>\r\n  ) : null;\r\n\r\n  const settings: ILLMSettings = {};\r\n  const currentSettings = playground?.generation?.settings || {};\r\n  const origSettings = playground?.originalGeneration?.settings || {};\r\n\r\n  const isSettingCompatible = (\r\n    value: string | number | boolean | string[],\r\n    input: TFormInput\r\n  ) => {\r\n    if (input.type === 'select') {\r\n      return !!input?.items?.find((i) => i.value === value);\r\n    }\r\n    return true;\r\n  };\r\n\r\n  const schema = yup.object(\r\n    provider.inputs.reduce((object: Schema, input: TFormInput) => {\r\n      const settingValue =\r\n        currentSettings[input.id] !== undefined\r\n          ? currentSettings[input.id]\r\n          : origSettings[input.id];\r\n\r\n      if (\r\n        settingValue !== undefined &&\r\n        isSettingCompatible(settingValue, input)\r\n      ) {\r\n        settings[input.id] = settingValue;\r\n      } else if (input.initial !== undefined) {\r\n        settings[input.id] = input.initial;\r\n      }\r\n\r\n      switch (input.type) {\r\n        case 'select':\r\n          object[input.id] = yup.string();\r\n          break;\r\n        case 'slider': {\r\n          let schema = yup.number();\r\n          if (input.min) {\r\n            schema = schema.min(input.min);\r\n          }\r\n          if (input.max) {\r\n            schema = schema.max(input.max);\r\n          }\r\n          object[input.id] = schema;\r\n          break;\r\n        }\r\n        case 'tags':\r\n          object[input.id] = yup.array().of(yup.string());\r\n          break;\r\n      }\r\n\r\n      return object;\r\n    }, {})\r\n  );\r\n\r\n  return (\r\n    <SettingsForm\r\n      provider={provider}\r\n      providers={providers}\r\n      providerWarning={providerWarning}\r\n      providerTooltip={buildProviderTooltip()}\r\n      schema={schema as unknown as Schema}\r\n      settings={settings}\r\n    />\r\n  );\r\n};\r\n\r\ninterface Props {\r\n  isSmallScreen: boolean;\r\n  isDrawerOpen: boolean;\r\n  toggleDrawer: () => void;\r\n}\r\n\r\nexport default function ResponsiveModelSettings({\r\n  isSmallScreen,\r\n  isDrawerOpen,\r\n  toggleDrawer\r\n}: Props) {\r\n  return !isSmallScreen ? (\r\n    <Box ml=\"32px !important\" height=\"100%\">\r\n      <ModelSettings />\r\n    </Box>\r\n  ) : (\r\n    <Drawer\r\n      sx={{\r\n        '& .MuiDrawer-paper': {}\r\n      }}\r\n      variant=\"persistent\"\r\n      anchor=\"right\"\r\n      open={isDrawerOpen}\r\n    >\r\n      <Box\r\n        sx={{\r\n          display: 'flex',\r\n          justifyContent: 'flex-end',\r\n          pt: 2,\r\n          pr: 1\r\n        }}\r\n      >\r\n        <IconButton onClick={toggleDrawer}>\r\n          <ChevronRightIcon />\r\n        </IconButton>\r\n      </Box>\r\n      <Box px={3}>\r\n        <ModelSettings />\r\n      </Box>\r\n    </Drawer>\r\n  );\r\n}\r\n","import { ILLMProvider, IPlayground } from 'src/types/playground';\r\n\r\nconst getProviders = (playground: IPlayground) => {\r\n  const providers = playground?.providers || [];\r\n\r\n  if (!providers?.length) {\r\n    throw new Error('No LLM provider available');\r\n  }\r\n\r\n  let provider = providers.find(\r\n    (provider) => provider.id === playground.generation?.provider\r\n  );\r\n\r\n  const providerFound = !!provider;\r\n\r\n  provider = provider || providers[0];\r\n\r\n  return {\r\n    provider,\r\n    providerFound,\r\n    providers\r\n  };\r\n};\r\n\r\nconst getDefaultSettings = (providerId: string, providers?: ILLMProvider[]) => {\r\n  if (!providers || providers.length === 0) return {};\r\n\r\n  const defaultSettings: { [key: string]: any } = {};\r\n  const provider = providers?.find((provider) => provider.id === providerId);\r\n\r\n  provider?.inputs?.forEach(\r\n    (input) => (defaultSettings[input.id] = input.initial)\r\n  );\r\n\r\n  return defaultSettings;\r\n};\r\n\r\nexport { getDefaultSettings, getProviders };\r\n","import { PlaygroundContext } from 'contexts/PlaygroundContext';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\nimport { useContext, useState } from 'react';\r\nimport { AccentButton, RegularButton } from 'src/buttons';\r\nimport { getProviders } from 'src/playground/helpers/provider';\r\n\r\nexport default function SubmitButton({ onSubmit }: { onSubmit: () => void }) {\r\n  const [completionController, setCompletionController] = useState<\r\n    AbortController | undefined\r\n  >();\r\n  const { playground, setPlayground, createCompletion } =\r\n    useContext(PlaygroundContext);\r\n\r\n  if (!playground || !playground.providers || !createCompletion) {\r\n    return null;\r\n  }\r\n\r\n  const submit = async () => {\r\n    try {\r\n      const { provider } = getProviders(playground);\r\n      const generation = cloneDeep(playground.generation)!;\r\n      generation.provider = provider.id;\r\n      const controller = new AbortController();\r\n\r\n      setCompletionController(controller);\r\n      setPlayground((old) => {\r\n        if (!old?.generation) return old;\r\n\r\n        if (old.generation.type === 'CHAT') {\r\n          return {\r\n            ...old,\r\n            generation: {\r\n              ...old.generation!,\r\n              messageCompletion: {\r\n                ...(old.generation?.messageCompletion || { role: 'assistant' }),\r\n                content: ''\r\n              }\r\n            }\r\n          };\r\n        } else {\r\n          return {\r\n            ...old,\r\n            generation: {\r\n              ...old.generation!,\r\n              completion: ''\r\n            }\r\n          };\r\n        }\r\n      });\r\n\r\n      await createCompletion(\r\n        generation,\r\n        controller,\r\n        (done: boolean, token: string) => {\r\n          onSubmit && onSubmit();\r\n\r\n          if (done) {\r\n            setCompletionController(undefined);\r\n            return;\r\n          }\r\n          setPlayground((old) => {\r\n            if (!old?.generation) return old;\r\n            if (old.generation.type === 'CHAT') {\r\n              return {\r\n                ...old,\r\n                generation: {\r\n                  ...old.generation!,\r\n                  messageCompletion: {\r\n                    ...(old.generation?.messageCompletion || {\r\n                      role: 'assistant'\r\n                    }),\r\n                    content:\r\n                      (old.generation?.messageCompletion?.content || '') + token\r\n                  }\r\n                }\r\n              };\r\n            } else {\r\n              return {\r\n                ...old,\r\n                generation: {\r\n                  ...old.generation!,\r\n                  completion: (old.generation?.completion || '') + token\r\n                }\r\n              };\r\n            }\r\n          });\r\n        }\r\n      );\r\n    } catch (err) {\r\n      setCompletionController(undefined);\r\n    }\r\n  };\r\n\r\n  if (completionController) {\r\n    return (\r\n      <RegularButton\r\n        onClick={() => {\r\n          completionController.abort();\r\n          setCompletionController(undefined);\r\n        }}\r\n      >\r\n        Cancel\r\n      </RegularButton>\r\n    );\r\n  } else {\r\n    return (\r\n      <AccentButton id=\"submit-prompt\" variant=\"outlined\" onClick={submit}>\r\n        Submit\r\n      </AccentButton>\r\n    );\r\n  }\r\n}\r\n"]}